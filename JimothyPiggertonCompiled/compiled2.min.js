var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
function linearMove(a,b,c){if(Math.abs(a-b)<=c)return b;if(a>b)return a-c;if(a<b)return a+c}function angleBetween(a,b,c){a=a%(2*Math.PI)+2*Math.PI;b=b%(2*Math.PI)+2*Math.PI;var d=a<b;a=Math.abs(a-b);a>Math.PI&&(a=2*Math.PI-a,d=!d);d&&c&&(a=-a);return a}function fakeShaderTest(a,b){a.drawImage(a.canvas,b.player.x-b.camera.x-a.width/2,b.player.y-b.camera.y+a.height/2,10,10,100,100,100,100)}
function connectControls(a,b){var c={},d;for(d in a){c[d]={};for(var e in a[d])c[d][e]=a[d][e].bind(b)}return c}function psuedoRandom(a,b,c,d){return(16807*(8746295*a+2193857*b+1933857*c+3855716*d+(a+1)*(b+1)*(c+1)*(d+1)*1231230)%2147483647-1)/2147483647}function setUpRandomGrid(a,b){for(var c=[],d=0;d<b;d++){c[d]=[];for(var e=0;e<a;e++)c[d][e]=Math.random()}return c}psuedoRandom.grid=setUpRandomGrid(100,100);
function rectangleCollision(a,b){return a.x<=b.x+b.w&&a.x+a.w>=b.x&&a.y<=b.y+b.h&&a.h+a.y>=b.y?!0:!1}function pointInRect(a,b,c){return a>=c.x&&a<=c.x+c.w&&b>=c.y&&b<=c.y+c.h}function rectangleCollisionAtTopOfEnemy(a,b){return 0==a.y+a.h?!0:!1}function distanceBetweenEntities(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}function circleMove(a,b){return[circleMoveX(a,b),circleMoveY(a,b)]}function circleMoveX(a,b){return Math.cos(a)*b}function circleMoveY(a,b){return Math.sin(a)*b}
function toDegrees(a){return 180/Math.PI*a}function toRadians(a){return Math.PI/180*a}function pointAdd(a,b){return[a[0]+b[0],a[1]+b[1]]}function constrain(a,b,c){a=a>c?c:a;return a<b?b:a}var Animation2=function(a,b,c){this.time=a;this.animate=b;this.callback=c};Animation2.prototype.update=function(a,b){--this.time;0>=this.time?this.callback(a,b):this.animate(a,b)};
var SOUNDMAP={},LEVEL_CREATION_FUNCTIONS=[],PLAYER_ABILITIES=[function(a){},function(a){a.wallJumps=!0},function(a){a.maxJumps=2;a.jumpCount=1}],WORLDTYPE=0;function addLevel(a){a.worldType=WORLDTYPE;LEVEL_CREATION_FUNCTIONS.push(a)}function createLevels(){for(var a={},b=0;52>b;b+=1)a["abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[b]]=b+10;var c=[];for(b=0;b<LEVEL_CREATION_FUNCTIONS.length;b+=1){var d=LEVEL_CREATION_FUNCTIONS[b],e=d(a);e.worldType=d.worldType;c.push(e)}return c}
var BLOCKS=[];function drawEntity(a,b,c,d,e,f,g,h){a.fillStyle="rgba(50,0,50,.5)";a.fillRect(b,c,d,e);this.drawer.x=b+d/2;this.drawer.y=c+e;this.drawer.draw(a)}function addBlock(a){a.id=BLOCKS.length;BLOCKS.push(a)}function createBlocks(){for(var a=[],b=0;b<BLOCKS.length;b+=1){var c=BLOCKS[b]();c.id=b;a[b]=c}return a}var Background=function(a){this.type=a;this.backgroundColor="#87ceeb";this.background1=this.createBackground(60,"#0b6623",!0);this.background2=this.createBackground(100,"#0b6623",!1)};
Background.prototype.draw=function(a,b,c){this.drawLayers(a,b,c)};Background.prototype.drawLayers=function(a,b,c){a.save();this.backgroundColor&&(a.fillStyle=this.backgroundColor,a.fillRect(0,0,a.width,a.height));a.translate(0,c.h*c.s-a.height/2);a.translate(-b.x/8,-b.y);a.drawImage(this.background1,-150,-200);a.translate(-b.x/4,0);a.drawImage(this.background2,-150,-100);a.restore()};
Background.prototype.createBackground=function(a,b,c){switch(this.type){case 0:return createHillBackground(a,b,c);case 1:return createForrestBackground(a,b,c);case 2:return this.backgroundColor=MAIN.makeGrd(),createSpikeBackground(a,"#222",c);default:return createHillBackground(a,b,c)}};var InfiniteBackground=function(a){Background.apply(this,arguments)};$jscomp.inherits(InfiniteBackground,Background);
InfiniteBackground.prototype.drawLayers=function(a,b){var c=Math.floor(b.x/3E3/2-.5)+1,d=Math.floor(b.x/3E3/2),e=Math.floor(b.x/6E3/2-.5)+1,f=Math.floor(b.x/6E3/2);a.save();this.backgroundColor&&(a.fillStyle=this.backgroundColor,a.fillRect(0,0,a.width,a.height));a.translate(-b.x/2,-b.y);a.drawImage(this.background1,6E3*e,-200);a.save();a.translate(6E3*f+4500,0);a.scale(-1,1);a.drawImage(this.background1,-1500,-200);a.restore();a.translate(-b.x/2,0);a.drawImage(this.background2,6E3*c,-100);a.translate(6E3*
d+4500,0);a.scale(-1,1);a.drawImage(this.background2,-1500,-100);a.restore()};
InfiniteBackground.prototype.drawInBounds=function(a,b,c,d){c=[.5,1];d=3E3*c[0];var e=Math.floor(b.x/d/2)+1,f=Math.floor(b.x/d/2),g=Math.floor(b.x/(6E3*c[0])/2);a.save();this.backgroundColor&&(a.fillStyle=this.backgroundColor,a.fillRect(0,0,a.width,a.height));a.scale(c[0],c[1]);a.translate(-b.x/2,b.y);a.save();a.translate(d+g*d*2+d,0);a.scale(-1,1);a.restore();a.translate(-b.x/2,0);a.drawImage(this.background1,2*d*e,-100);a.translate(d+f*d*2+d,0);a.scale(-1,1);a.drawImage(this.background2,0,-100);
a.restore()};var ScrollingBackgroundObject=function(a,b,c,d,e,f,g,h){this.background=a;this.activated=h;this.scaleFactor=[b,c];this.maxSpeed=d;this.moveSpeed=this.activated?this.maxSpeed:0;this.yOffset=f;this.flipped=g;this.left=e*this.scaleFactor[0];this.width=this.background.width*this.scaleFactor[0];this.right=this.left+this.width;this.colorChangeDuration=25;this.colorTimer=this.activated?0:this.colorChangeDuration};
ScrollingBackgroundObject.prototype.update=function(a){this.left-=this.moveSpeed*a;this.right=this.left+this.width;0>this.right&&(this.left+=2*this.width);this.moveSpeed=this.activated?this.maxSpeed:0;this.updateGrayscale(a)};ScrollingBackgroundObject.prototype.updateGrayscale=function(a){this.activated?(this.colorTimer-=a,0>this.colorTimer&&(this.colorTimer=0)):(this.colorTimer+=a,this.colorTimer>this.colorChangeDuration&&(this.colorTimer=this.colorChangeDuration))};
ScrollingBackgroundObject.prototype.draw=function(a){a.save();this.flipped?(a.translate(this.left+this.width,this.yOffset),a.scale(-1,1)):a.translate(this.left,this.yOffset);a.scale(this.scaleFactor[0],this.scaleFactor[1]);a.drawImage(this.background,0,0);a.restore()};var SunEffect=function(){this.srcImage=createSunEffect();this.image=document.createElement("canvas");this.image.width=this.srcImage.width;this.image.height=this.srcImage.height;this.canvas=this.image.getContext("2d");this.canvas.save()};
SunEffect.prototype.reset=function(){var a=this.image.width,b=this.image.height,c=this.canvas;c.restore();c.save();c.globalCompositeOperation="source-over";c.clearRect(0,0,a,b);c.drawImage(this.srcImage,0,0);c.globalCompositeOperation="destination-out"};SunEffect.prototype.draw=function(a){a.drawImage(this.image,a.width/2-this.image.width/2,a.height/2-this.image.height/2)};
function createSunEffect(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=3E3;a.height=800;b.fillStyle="rgba(255,255,0,.5)";b.beginPath();b.arc(a.width/2,a.height/2,a.height/2,0,2*Math.PI);b.fill();return a}
function createHillBackground(a,b,c){a=document.createElement("canvas");var d=a.getContext("2d");a.width=3E3;a.height=800;d.fillStyle=b;d.fillStyle=b;b=200*Math.random()+100;for(var e=0;e<a.width;e+=b){var f=e,g=560+b;d.beginPath();d.arc(f,g,b,0,2*Math.PI);d.fill();b=200*Math.random()+100}for(e=0;20>e;e++)b=200*Math.random()+100,f=Math.random()*a.width,g=560+b/2,d.beginPath(),d.arc(f,g,b,0,2*Math.PI),d.fill();c&&(d.globalCompositeOperation="source-atop",d.fillStyle="rgba(1,1,1,.1)",d.fillRect(0,0,
a.width,a.height));return a}
function createForrestBackground(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");d.width=3E3;d.height=800;e.fillStyle=b;b=["#382","#4a3"];var f=0;e.fillStyle="#050";e.fillRect(0,560,d.width,560);a=60;for(var g=0;g<d.width;g+=a)if(!(.5<Math.random())){var h=300;h-=100*Math.random();var k=560-h,l=a/2+10*Math.random();e.fillStyle="#643";e.fillRect(g+a/2-l/2,k,l,h);e.fillStyle="#532";e.fillRect(g+a/2-l/2,k,l/2,h);h=a/2;for(var m=230;0<m;m-=h)e.beginPath(),f=(f+1)%b.length,e.fillStyle=
b[f],e.moveTo(g+a/2-l,k+m),e.lineTo(g+a/2+l,k+m),e.lineTo(g+a/2,k+m-2*h),e.fill()}c&&(e.globalCompositeOperation="source-atop",e.fillStyle="rgba(1,1,1,.1)",e.fillRect(0,0,d.width,d.height));return d}
function createInterriorBackground(a,b,c){a=document.createElement("canvas");b=a.getContext("2d");a.width=3E3;a.height=800;b.fillStyle="#333";b.fillRect(0,0,a.width,a.height);b.save();b.fillStyle="#fff";for(var d=a.width/50,e=d;e<a.width;e+=2*d)for(var f=1;10>f;f+=1)b.fillRect(e,f*d*2,d,d);b.restore();c&&(b.globalCompositeOperation="source-atop",b.fillStyle="rgba(1,1,1,.1)",b.fillRect(0,0,a.width,a.height));return a}
function createSpikeBackground(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=3E3;c.height=1E3;d.fillStyle=b;d.strokeStyle="#000";d.lineWidth=10;for(var e=0;e<c.width;e+=a){var f=a/3;d.fillRect(e+a/2-f/2,500,f,400);d.beginPath();d.moveTo(e+a/2-f,500);d.lineTo(e+a/2+f,500);d.lineTo(e+a/2,500-2*f);d.closePath();d.fill();d.save();d.globalCompositeOperation="source-atop";d.fillStyle="rgba(0,0,0,.2)";d.fillRect(e+a/2-f/2*2,500-2*f,f,400+2*f);d.restore()}return c}
function createCityRuinBackground(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=3E3;c.height=1E3;d.fillStyle=b;for(var e=0;e<c.width;e+=a)d.fillRect(e,5*Math.floor(40*Math.random())+400,a,400);for(e=0;350>e;e++)d.clearRect(Math.random()*c.width,Math.random()*c.height,50*Math.random(),50*Math.random());return c}function makeWorld(a,b){for(var c=[],d=0;d<b;d++){for(var e=[],f=0;f<a;f++)0==f||f==a-1||d==b-1?e.push(1):e.push(0);c.push(e)}return c}
function randomizeWorld(a,b,c){for(var d=1,e=1,f=1,g=0,h=0;1E4>h;h++)a[e][d]=0,d+=f,e+=g,1>d&&(d=1),1>e&&(e=1),d>b-2&&(d=b-2),e>c-2&&(e=c-2),.8<Math.random()&&(f=2*Math.floor(2*Math.random())-1,.5<Math.random()?g=0:(g=f,f=0))}var World=function(a){this.worldtype=a;this.background=new Background(a);this.s=40};World.prototype.forceRedraw=function(){this.image=null};
World.prototype.draw=function(a,b){var c=this.s,d=this.world;if(this.image){a.drawImage(this.image,0,0);for(var e=0;e<this.w;e++)for(var f=0;f<this.h;f++){var g=d[f][e];g=CELLMAP[g];g.draw&&g.redraws&&(!g.hide||b)&&g.draw(a,c*e,c*f,c,c,this,e,f)}}else{this.image=document.createElement("canvas");this.image.width=this.w*this.s;this.image.height=this.h*this.s;var h=this.image.getContext("2d");for(e=0;e<this.w;e++)for(f=0;f<this.h;f++)if(g=d[f][e],g=CELLMAP[g],g.draw){var k=h;g.redraws&&(k=a);g.hide&&
!b||g.draw(k,c*e,c*f,c,c,this,e,f)}a.drawImage(this.image,0,0)}};World.prototype.oob=function(a,b){return 0>a||0>b||a>=this.w||b>=this.h};World.prototype.wallExists=function(a,b){return this.oob(a,b)||this.world[b][a]};World.prototype.pointCollides=function(a,b){return this.wallExists(Math.floor(a/this.s),Math.floor(b/this.s))};World.prototype.pointToMatrix=function(a,b){return{x:Math.floor(a/this.s),y:Math.floor(b/this.s)}};
World.prototype.matrixToPoint=function(a,b){return{x:a*this.s,y:b*this.s,w:this.s,h:this.s}};
World.prototype.rectCollides=function(a,b,c,d,e,f,g){var h=!1;b=[[a,b],[a+c,b],[a,b+d],[a+c,b+d],[a+c/2,b+d],[a+c/2,b]];a={};for(var k in b){var l=b[k][0],m=b[k][1],n=this.pointToMatrix(l,m);c=this.matrixToPoint(n.x,n.y);c.i=k;d=this.getCellType(n.x,n.y);if(!0===d)return c;var p=CELLMAP[d];if(p&&!p.ignoreCollisions){var q=!0;l={x:l,y:m,p:n,c:c};p.isColliding&&(q=p.isColliding(e,l,f,g,c));if(q){q.x&&(c=q);if(p.safe)return c;0!=d&&(a[d]=l)}}}for(k in a)l=a[k],(b=this.entityCollision(e,k,l,f,g))&&(h=
b);return h};World.prototype.entityCollision=function(a,b,c,d,e){b=CELLMAP[b];if(!b)return!1;var f=!0,g=c.c;b.isColliding&&(f=b.isColliding(a,c,d,e,g));f&&b.entityCollision&&b.entityCollision(a,c,d,e,g);if(f&&b.solid)return f.y?f:g};World.prototype.drawBackground=function(a,b){this.background.draw(a,b,this)};World.prototype.getCellType=function(a,b){return b>=this.h?b>this.h+1?2:0:this.oob(a,b)?!0:this.world[b][a]};
World.prototype.getCell=function(a,b){return b>=this.h?CELLMAP[2]:this.oob(a,b)?{}:CELLMAP[this.world[b][a]]};var WorldDefault=function(a,b,c){World.call(this);this.w=a;this.h=b;this.world=makeWorld(a,b)};$jscomp.inherits(WorldDefault,World);var WorldFromLevel=function(a,b){var c=0;a.worldType&&(c=a.worldType);SOUNDMAP.music.setSong(void 0!=a.song?a.song:2==a.worldType?1:0);World.call(this,c);this.world=c=a.grid;this.h=c.length;this.w=c[0].length};$jscomp.inherits(WorldFromLevel,World);
WorldFromLevel.prototype.loadWorld=function(a){for(var b=this.s,c=this.world,d=0;d<this.w;d++)for(var e=0;e<this.h;e++){var f=CELLMAP[c[e][d]];if(f.onload)f.onload(a,b*d,e*b,b,b,this,d,e)}};var Cloud=function(a,b,c,d,e,f,g,h){this.x=a;this.y=b;this.w=c;this.h=d;this.vx=e;this.vy=f;this.maxlife=this.life=g||10;this.color=h||"rgba(200,200,200,1)";this.behind=!0};
Cloud.prototype.update=function(){this.life--;if(0>=this.life)this.shouldDelete=!0;else{this.x+=this.vx;this.y+=this.vy;var a=Math.floor(100+155*this.life/this.maxlife);this.color="rgb("+a+","+a+","+a+")"}};
Cloud.prototype.draw=function(a){a.save();a.fillStyle=this.color;var b=this.w+(this.maxlife-this.life);a.translate(this.x,this.y);var c=b/5;5>this.life?(a.fillRect(-b/2+c,-b,b-2*c,b/4),a.fillRect(-b/2+c,-b/4,b-2*c,b/4),a.fillRect(-b/2,-b+c,b/4,b-2*c),a.fillRect(b/4,-b+c,b/4,b-2*c)):(a.fillRect(-b/2+c,-b,b-2*c,b),a.fillRect(-b/2,-b+c,b,b-2*c));a.restore()};function sceneTransition(a,b){return function(){this.driver.setScene(new b)}.bind(a)}
function sceneTransition(a,b,c){return function(){this.driver.setScene(new b(c))}.bind(a)}function loadTransitionScene(a,b,c,d,e){return function(){this.driver.setScene(new c(a,b,d,e))}.bind(a)}function drawTransitionOverlay(a,b){b.fillStyle=a;b.fillRect(0,0,b.width,b.height)}
function drawGrid(a){a.lineWidth=1;a.strokeStyle="black";for(var b=0;10>b;b++)a.beginPath(),a.moveTo(b/10*a.width,0),a.lineTo(b/10*a.width,a.height),a.stroke();for(b=0;10>b;b++)a.beginPath(),a.moveTo(0,b/10*a.height),a.lineTo(a.width,b/10*a.height),a.stroke()}
var Scene=function(a){this.keyMap=[];this.gui=[];this.selectedButton=void 0;this.buttons=[];this.inTransition=this.debug=!1;this.overlayColor="rgba(0,0,0,0)";this.transitionTimer=0;this.transitionDuration=25;this.postTransitionCallback=void 0;this.transitionDirection=1;this.allowUIInput=!0;void 0!=a&&a&&this.startTransition(25,-1,void 0);this.mouse={x:-1,y:-1}};Scene.prototype.update=function(a){this.handleHeldKeys(a);this.updateTransition(a);this.updateAllGUI(a)};
Scene.prototype.updateTransitionColor=function(){this.overlayColor="rgba(0,0,0,"+1*this.transitionTimer/this.transitionDuration+")"};
Scene.prototype.updateTransition=function(a){this.inTransition&&(this.transitionTimer>this.transitionDuration||0>this.transitionTimer?(this.transitionTimer=1==this.direction?0:this.transitionDuration,this.inTransition=!1,this.overlayColor="transparent",void 0!=this.postTransitionCallback&&this.postTransitionCallback()):(this.transitionTimer+=this.transitionDirection*a,this.updateTransitionColor()))};Scene.prototype.draw=function(a){};
Scene.prototype.unload=function(){for(var a in this.keyMap)this.keyMap[a].keyHeld=!1};Scene.prototype.keydown=function(a){if(a=this.keyMap[a])a.keyHeld=!0,a.down&&a.down()};Scene.prototype.keyup=function(a){if(a=this.keyMap[a])a.keyHeld=!1,a.up&&a.up()};Scene.prototype.handleHeldKeys=function(a){var b=this.keys,c=this.keyMap,d;for(d in c){var e=c[d];b[d]&&e.held&&e.held(a);0==b[d]&&e.unheld&&e.unheld(a);e.noneheld&&!e.keyHeld&&e.noneheld(a)}};
Scene.prototype.drawAllGUI=function(a){for(var b=0;b<this.gui.length;b++)this.gui[b].visible&&this.gui[b].draw(a)};Scene.prototype.updateAllGUI=function(a){for(var b=0;b<this.gui.length;b++)this.gui[b].update(a,this.mouse)};Scene.prototype.startTransition=function(a,b,c){this.inTransition=!0;this.transitionDuration=a;this.transitionTimer=1==b?0:a;this.transitionDirection=b;this.postTransitionCallback=c;this.updateTransitionColor()};
Scene.prototype.pressButton=function(){this.allowUIInput&&(this.selectedButton.held=!0,this.allowUIInput=!1,SOUNDMAP.uiselect.play())};Scene.prototype.unpressButton=function(){this.selectedButton.held&&(this.selectedButton.held=!1,this.selectedButton.onRelease());this.inTransition||(this.allowUIInput=!0)};
Scene.prototype.safeButtonCall=function(){if(2>arguments.length)console.log("safeButtonCall() with less than 2 arguments");else{for(var a=arguments[1],b=[],c=2;c<arguments.length;c++)b.push(arguments[c]);return function(){this.allowUIInput&&a.apply(this,b)}.bind(this)}};
Scene.prototype.navigateUI=function(a){void 0!=this.selectedButton&&void 0!=this.selectedButton.buttonLinks[a]&&this.allowUIInput&&this.selectedButton.buttonLinks[a].selectable&&(this.selectedButton.selected=!1,this.selectedButton.buttonLinks[a].selected=!0,this.selectedButton=this.selectedButton.buttonLinks[a],SOUNDMAP.uimove.play())};Scene.prototype.toggleDebug=function(){this.debug=!this.debug};
Scene.prototype.mousedown=function(a,b){this.updateMousePosition(a);this.allowUIInput&&GUIMouseDown(a,this.buttons)};Scene.prototype.mouseup=function(a,b){this.updateMousePosition(a);this.allowUIInput&&GUIMouseUp(a,this.buttons)};Scene.prototype.mousemove=function(a,b){this.updateMousePosition(a);this.allowUIInput&&GUIMouseMove(this,a,this.buttons)};
Scene.prototype.updateMousePosition=function(a){a=getPercentPoint(a);isNaN(a[0])||isNaN(a[1])||(this.mouse={x:a[0],y:a[1]},this.mouse.x=constrain(this.mouse.x,0,1),this.mouse.y=constrain(this.mouse.y,0,1))};var GUIElement=function(a,b,c,d,e){this.originalDimension=[a,b,c,d];this.x=a;this.y=b;this.w=c;this.h=d;this.selectable=this.interactable=!0;this.groupID=e;this.visible=!0};GUIElement.prototype.move=function(a,b){this.x+=a;this.y+=b};
GUIElement.prototype.contains=function(a,b){return a>=this.x&&a<=this.x+this.w&&b>=this.y&&b<=this.y+this.h};GUIElement.prototype.setVisibility=function(a){this.visible=a};GUIElement.prototype.setOptions=function(a,b,c){this.interactable=a;this.visible=c;this.selectable=b};GUIElement.prototype.getPixelDimensions=function(a){return[this.x*a.width,this.y*a.height,this.w*a.width,this.h*a.height]};
GUIElement.prototype.reset=function(){this.x=this.originalDimension[0];this.y=this.originalDimension[1];this.w=this.originalDimension[2];this.h=this.originalDimension[3]};GUIElement.prototype.update=function(a){};GUIElement.prototype.draw=function(a){};function colorLerp(a,b,c){for(var d=a.slice(),e=0;4>e;e++)d[e]=Math.round(d[e]+(b[e]-a[e])*c);return d}function makeColorStr(a){return"rgba("+Math.floor(a[0])+","+Math.floor(a[1])+","+Math.floor(a[2])+","+a[3]+")"}
function rectDimFromCenter(a,b,c,d){var e=[];e.push(a-c/2);e.push(b-d/2);e.push(c);e.push(d);return e}function getPercentPoint(a){if(a.percentPoint)return a.percentPoint;var b=[];b.push(a.offsetX/a.target.offsetWidth);b.push(a.offsetY/a.target.offsetHeight);b[0]=constrain(b[0],0,1);b[1]=constrain(b[1],0,1);return b}function moveAllGUI(a,b,c){for(var d=0;d<c.length;d++)c[d].move(a,b)}function getButtons(a){for(var b=[],c=0;c<a.length;c++)a[c]instanceof Button&&b.push(a[c]);return b}
function pointContainsGUI(a,b){for(var c=0;c<b.length;c++)if(b[c].contains(a[0],a[1])&&b[c].interactable)return!0;return!1}function getGUIInGroup(a,b){for(var c=[],d=0;d<b.length;d++)b[d].groupID==a&&c.push(b[d]);return c}function GUIMouseDown(a,b){for(var c=getPercentPoint(a),d=0;d<b.length;d++)if(b[d].contains(c[0],c[1])&&b[d].interactable&&(b[d].held=!0,b[d].onClick))b[d].onClick()}
function GUIMouseUp(a,b){for(var c=getPercentPoint(a),d=0;d<b.length;d++){if(b[d].interactable&&b[d].held&&!b[d].requireMouseInRegionOnRelease){b[d].held=!1;if(b[d].onRelease)b[d].onRelease();break}b[d].contains(c[0],c[1])&&b[d].interactable&&b[d].held?(b[d].held=!1,b[d].onRelease&&(b[d].onRelease(),SOUNDMAP.uiselect.play())):b[d].held=!1}}
function GUIMouseMove(a,b,c){if(void 0!=c){for(var d=0;d<c.length;d++)if(c[d].held)return;b=getPercentPoint(b);for(d=0;d<c.length;d++)if(c[d].contains(b[0],b[1])&&c[d].selectable){void 0!=a.selectedButton&&(a.selectedButton.selected=!1);c[d].selected=!0;a.selectedButton!=c[d]&&SOUNDMAP.uimove.play();a.selectedButton=c[d];break}}}var movementKeys=[32,37,38,39,40],touchButtons=[];
function setUpTouchBtns(){touchButtons=[{x:0,y:.7,w:.15,h:.3,key:65},{x:.16,y:.7,w:.15,h:.3,key:68},{x:.75,y:.5,w:.2,h:.24,key:32},{x:.75,y:.76,w:.2,h:.24,key:83}]}setUpTouchBtns();function pressed(a){return a&&(1==a||a.pressed)}
function handleGamePad(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],c=0;c<b.length;c++){var d=b[c];if(d&&!(0>=d.buttons.length)){if(d.axes){var e=d.axes[0],f=d.axes[1];.25>Math.abs(e)&&(e=0);.25>Math.abs(f)&&(f=0);0<e?(this.heldRight=!0,a.keydown({keyCode:68})):this.heldRight&&(this.heldRight=!1,a.keyup({keyCode:68}));0>e?(this.heldLeft=!0,a.keydown({keyCode:65})):this.heldLeft&&(this.heldLeft=!1,a.keyup({keyCode:65}));.8<f?
(a.keydown({keyCode:83}),this.heldDown=!0):this.heldDown&&(this.heldDown=!1,a.keyup({keyCode:83}));-.8>f?(a.keydown({keyCode:87}),this.heldUp=!0):this.heldUp&&(this.heldUp=!1,a.keyup({keyCode:87}))}d.buttons&&(pressed(d.buttons[0])?(a.keydown({keyCode:32}),this.heldA=!0):this.heldA&&(a.keyup({keyCode:32}),this.heldA=!1),pressed(d.buttons[1])?(this.heldB=!0,a.keydown({keyCode:27})):this.heldB&&(this.heldB=!1,a.keyup({keyCode:27})))}}}
var touchButtonMap={},touchOn=!1,MainDriver=function(a){this.canvas=a;this.frameCount=0;this.keys=[];this.scene=new MenuScene(!0);this.scene.driver=this;this.mouse={x:0,y:0};this.soundsInitialized=!1;this.timeoutes=[];this.gamepadOn=!0};MainDriver.prototype.setTimeout=function(a,b){this.timeoutes.push({callback:a,frames:b})};MainDriver.prototype.userGesture=function(){this.soundsInitialized||(initializeSound(),this.soundsInitialized=!0);AUDIOCONTEXT.resume()};
MainDriver.prototype.update=function(a){this.frameCount+=a;this.gamepadOn&&handleGamePad(this);this.scene.keys=this.keys;this.scene.update(a,this.frameCount);for(a=0;a<this.timeoutes.length;a+=1){var b=this.timeoutes[a];--b.frames;0>=b.frames&&(b.callback(),this.timeoutes.splice(a--,1))}};
MainDriver.prototype.draw=function(a){a.clearRect(0,0,a.width,a.height);this.scene.draw(a);if(touchOn){var b=a.width,c=a.height;a.save();for(var d=0;d<touchButtons.length;d+=1){var e=touchButtons[d],f=e.x*b,g=e.y*c,h=e.w*b,k=e.h*c;a.fillStyle="rgba(0,0,0,.5)";e.held&&(a.fillStyle="rgba(255,0,0,.6)");a.fillRect(f,g,h,k)}a.restore()}};
MainDriver.prototype.jankyTouch=function(a){var b=a.changedTouches[0].pageX,c=a.changedTouches[0].pageY;this.scene.startGame&&this.scene.startGame();this.scene.time?this.scene.time=0:(700<b?this.keydown({keyCode:68}):this.keyup({keyCode:68}),300>b?this.keydown({keyCode:65}):this.keyup({keyCode:65}),200>c&&this.scene.keydown(32));a.preventDefault()};MainDriver.prototype.enterTouchButton=function(a,b){a.held=b;this.keydown({keyCode:a.key});touchButtonMap[b]=a};
MainDriver.prototype.leaveTouchButton=function(a,b){a.held=0;this.keyup({keyCode:a.key});touchButtonMap[b]=0};MainDriver.prototype.getTouchPosition=function(a,b){var c=b.target.getBoundingClientRect(),d=a.pageX-c.left;c=a.pageY-c.top;var e=this.canvas.canvas.offsetHeight;d/=this.canvas.canvas.offsetWidth;c/=e;this.mouse.x=d*this.canvas.width;this.mouse.y=c*this.canvas.height;return{x:d,y:c}};
MainDriver.prototype.touchstart=function(a){this.userGesture();touchOn=!0;var b=a.changedTouches;a.preventDefault();for(var c=0;c<b.length;c++){var d=a.changedTouches[c],e=this.getTouchPosition(d,a),f=e.x;e=e.y;a.percentPoint=[f,e];this.scene.mousedown(a,this.mouse);for(var g=0;g<touchButtons.length;g++){var h=touchButtons[g];pointInRect(f,e,h)&&this.enterTouchButton(h,d.identifier)}}};
MainDriver.prototype.touchmove=function(a){for(var b=0;b<a.changedTouches.length;b+=1){var c=a.changedTouches[b],d=this.getTouchPosition(c,a),e=d.x;d=d.y;a.percentPoint=[e,d];this.scene.mousemove(a,this.mouse);var f=touchButtonMap[c.identifier];f&&(pointInRect(e,d,f)||this.leaveTouchButton(f,c.identifier));for(f=0;f<touchButtons.length;f++){var g=touchButtons[f];pointInRect(e,d,g)&&this.enterTouchButton(g,c.identifier)}}};
MainDriver.prototype.touchend=function(a){for(var b=0;b<a.changedTouches.length;b+=1){var c=a.changedTouches[b],d=this.getTouchPosition(c,a);a.percentPoint=[d.x,d.y];this.scene.mouseup(a,this.mouse);(d=touchButtonMap[c.identifier])&&this.leaveTouchButton(d,c.identifier)}};MainDriver.prototype.keydown=function(a){this.userGesture();var b=this.keys,c=a.keyCode;movementKeys.includes(c)&&a.preventDefault&&a.preventDefault();b[c]||(this.scene.keydown(c),b[c]=!0)};
MainDriver.prototype.keyup=function(a){var b=this.keys;a=a.keyCode;b[a]&&(this.scene.keyup(a),b[a]=!1)};MainDriver.prototype.setMousePos=function(a){var b=a.target.getBoundingClientRect();this.mouse.x=a.clientX-b.left;this.mouse.y=a.clientY-b.top;this.mouse.x*=canvas.width/a.target.offsetWidth;this.mouse.y*=canvas.height/a.target.offsetHeight};MainDriver.prototype.mousedown=function(a){this.userGesture();this.setMousePos(a);this.mouse.held=!0;this.scene.mousedown(a,this.mouse)};
MainDriver.prototype.mouseup=function(a){this.setMousePos(a);this.mouse.held=!1;this.scene.mouseup(a,this.mouse)};MainDriver.prototype.mousemove=function(a){this.setMousePos(a);this.scene.mousemove(a,this.mouse)};MainDriver.prototype.setScene=function(a){this.scene&&this.scene.unload&&this.scene.unload();a.driver=this;this.scene=a};
MainDriver.prototype.makeGrd=function(){var a=canvas.width/2,b=2*canvas.height;a=canvas.createRadialGradient(a,b,0,a,b,2*canvas.height);a.addColorStop(0,"rgba(255,100,100,1)");a.addColorStop(1,"rgba(20,20,20,1)");return a};var CE=document.getElementById("gc"),canvas=CE.getContext("2d");canvas.fillStyle="black";canvas.fillRect(0,0,CE.width,CE.height);canvas.fillStyle="white";canvas.font="10px Arial";canvas.textAlign="center";canvas.fillText("LOADING",CE.width/2,CE.height/2);var CELLMAP,MAIN;
window.onload=function(){function a(){c.draw(canvas);canvas.fillStyle="white";canvas.textAlign="left";window.requestAnimationFrame(a)}function b(a){window.innerWidth/window.innerHeight>canvas.width/canvas.height?(CE.style.height="100%",CE.style.width=""):(CE.style.width="100%",CE.style.height="")}CELLMAP=createBlocks();canvas.width=CE.width;canvas.height=CE.height;canvas.font="30px " + FONT;var c=new MainDriver(canvas);MAIN=c;var d=Date.now(),e=0,f=d;a();setInterval(function(){var a=Date.now();
d=a;e++;a>f+1E3&&(e=0,f=a);c.update(.8)},1E3/60);window.addEventListener("keydown",c.keydown.bind(c));window.addEventListener("keyup",c.keyup.bind(c));window.addEventListener("mousemove",c.mousemove.bind(c));window.addEventListener("mouseup",c.mouseup.bind(c));window.addEventListener("mousedown",c.mousedown.bind(c));CE.addEventListener("touchstart",c.touchstart.bind(c));CE.addEventListener("touchmove",c.touchmove.bind(c));CE.addEventListener("touchend",c.touchend.bind(c));CE.addEventListener("touchcancel",
c.touchend.bind(c));window.addEventListener("resize",b);b()};var AUDIOCONTEXT,DESTINATION,BUFFERBUFFER=[],VOLUME=1;function setVolume(a){0>a&&(a=0);1<a&&(a=1);VOLUME=a;DESTINATION.gain.setValueAtTime(a,0)}
function initializeSound(){AUDIOCONTEXT="webkitAudioContext"in window?new webkitAudioContext:new AudioContext;AUDIOCONTEXT.resume();var a=AUDIOCONTEXT.createGain();a.connect(AUDIOCONTEXT.destination);DESTINATION=a;setVolume(.5);for(var b in BUFFERBUFFER)BUFFERBUFFER[b].beginLoad();BUFFERBUFFER=[]}var SoundEffect=function(a,b,c,d,e,f){this.type=f||"triangle";this.sampleRate=a;this.inBetweens=e||0;this.frqData=b;this.volData=c;this.length=this.sampleRate*d};
SoundEffect.prototype.play=function(a){if(DESTINATION){var b=1;a&&!a.player&&(distanceBetweenEntities(a,a.game.player),b=.1);var c=AUDIOCONTEXT;a=DESTINATION;var d=c.createOscillator(),e=c.createGain();c=c.currentTime;d.start(c);d.stop(c+this.length);d.type=this.type;d.frequency.setValueAtTime(this.frqData[0],c);e.gain.setValueAtTime(this.volData[0]*b,c);d.connect(e);e.connect(a);this.applyData(d,e,c,b);d.stopSound=function(){try{this.disconnect(e)}catch(f){console.log(f)}};return d}};
SoundEffect.prototype.applyData=function(a,b,c,d){for(var e,f=0;f<this.frqData.length;f++){var g=this.frqData[f];if(g){a.frequency.setValueAtTime(g,c+f*this.sampleRate);if(e)for(var h=0;h<this.inBetweens;h++)g&&a.frequency.setValueAtTime(e+(g-e)*h/this.inBetweens,c+(f-1+h/this.inBetweens)*this.sampleRate);e=g}}e=!1;for(f=0;f<this.volData.length;f++)if(a=this.volData[f]){b.gain.setValueAtTime(a*d,c+f*this.sampleRate);if(e)for(h=0;h<this.inBetweens;h++)a&&b.gain.setValueAtTime((e+(a-e)*h/this.inBetweens)*
d,c+(f-1+h/this.inBetweens)*this.sampleRate);e=a}};function loadBuffer(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=function(){AUDIOCONTEXT.decodeAudioData(c.response,function(c){c?b(c):alert("error decoding file data: "+a)},function(a){console.error("decodeAudioData error",a)})};c.onerror=function(){console.log("BufferLoader: XHR error");console.log("Cannot load sounds from File system")};c.send()}
var SoundSource=function(a,b,c){this.url=a=SOUNDASSETS+a;this.loaded=!1;this.playbackRate=b||1;this.volume=c||1;this.loops=!1;BUFFERBUFFER.push(this);this.lastSound=null};SoundSource.prototype.beginLoad=function(){loadBuffer(this.url,this.onloadBuffer.bind(this))};SoundSource.prototype.onloadBuffer=function(a){this.buffer=a;this.loaded=!0};SoundSource.prototype.stopSound=function(){this.lastSound&&(this.lastSound.stopSound(),this.lastSound=null)};
SoundSource.prototype.setVolume=function(a){this.lastVolume=a;a*=this.volume;0>a&&(a=0);1<a&&(a=1);this.lastSound.myGain.gain.setValueAtTime(a,AUDIOCONTEXT.currentTime)};
SoundSource.prototype.play=function(){var a=AUDIOCONTEXT,b=DESTINATION;if(b){var c=a.currentTime,d=a.createBufferSource();d.buffer=this.buffer;d.playbackRate.setValueAtTime(1*this.playbackRate,c);d.start(c);this.loops&&(d.loop=!0);var e=a.createGain();e.gain.setValueAtTime(this.volume,c);e.connect(b);d.connect(e);d.stopSound=function(){try{this.disconnect(e)}catch(f){console.log(f)}};d.myGain=e;this.lastSound=d;d.getTime=function(){};d.pause=function(){};d.resume=function(){};return d}};
var SoundTag=function(a,b,c){this.url=a=SOUNDASSETS+a;this.playbackRate=b||1;this.volume=c||1;this.createAudio()};SoundTag.prototype.createAudio=function(){var a=document.createElement("audio");a.src=this.url;this.audioElement=a;a.playbackRate=this.playbackRate;this.setVolume(1)};SoundTag.prototype.play=function(){if(DESTINATION)return this.audioElement.play(),this.audioElement.currentTime=0,this.loops&&(this.audioElement.loop=!0),this};SoundTag.prototype.stopSound=function(){this.audioElement.pause()};
SoundTag.prototype.pause=function(){this.audioElement.pause()};SoundTag.prototype.resume=function(a){this.audioElement.play();void 0!=a&&(this.audioElement.currentTime=a)};SoundTag.prototype.getTime=function(){return this.audioElement.currentTime};SoundTag.prototype.setVolume=function(a){this.lastVolume=a;a=a*VOLUME*this.volume;0>a&&(a=0);1<a&&(a=1);this.audioElement.volume=a};var OnFile="file:"==window.location.protocol;OnFile&&(SoundSource=SoundTag);var MixAudio=function(a){this.audios=a};
MixAudio.prototype.play=function(){this.audios.forEach(function(a){return a.play()})};var PickAudio=function(a){this.audios=a};PickAudio.prototype.play=function(){return this.audios[Math.floor(Math.random()*this.audios.length)].play()};var MusicSource=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];SoundSource.apply(this,$jscomp.arrayFromIterable(b));this.loops=!0;this.lastVolume=1};$jscomp.inherits(MusicSource,SoundSource);
MusicSource.prototype.play=function(){return this.lastSound?this.lastSound:SoundSource.prototype.play.call(this)};MusicSource.prototype.lerpVolume=function(a){this.setVolume(this.lastVolume+(a-this.lastVolume)/10)};var MusicHandler=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this.songs=b;this.setSong(0)};MusicHandler.prototype.setSong=function(a){a=this.songs[a];this.song!=a&&(a.play(),this.song&&this.song.stopSound(),this.song=a)};
MusicHandler.prototype.play=function(){if(void 0!=this.song)return this.song.stopSound(),this.song.play()};MusicHandler.prototype.lerpVolume=function(a){this.song.lerpVolume(a)};MusicHandler.prototype.setVolume=function(a){this.song.setVolume(a)};MusicHandler.prototype.getTime=function(){return this.song.getTime()};MusicHandler.prototype.pause=function(){this.song.pause()};MusicHandler.prototype.resume=function(a){this.song.resume(a)};
addLevel(function(a){return{name:"Adventure Begins!",worldType:0,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,0,0,0,0,0,19,19,19,19,19,19,19,19,19,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,0,0,19,19,19,19,19,19,19,19,19,19,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,0,0,19,19,19,19,19,19,19,19,19,
19,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,18,19,19,0,0,19,19,18,18,19,18,18,19,19,19,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,18,18,19,19,0,0,0,19,19,18,18,18,18,18,18,19,0],[0,0,0,0,0,0,0,0,0,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,18,18,18,19,19,19,0,0,0,0,9,23,23,18,18,18,19,19,0],[0,0,0,0,0,0,0,0,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,18,18,19,19,0,0,0,0,0,19,19,18,18,18,19,19,19,0],[0,0,0,0,0,0,0,19,19,19,19,19,
19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,18,18,19,0,0,0,0,0,0,19,19,18,18,18,19,19,0,0],[0,0,0,0,0,0,0,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,0,0,0,1,1,0,0,0,19,18,18,18,19,0,0,0],[0,0,0,0,0,0,0,19,19,19,19,18,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,0,0,0,1,1,0,0,0,0,18,18,1,0,0,0,0],[0,0,0,0,0,0,0,0,19,19,18,18,19,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,1,1,18,0,0,2,1,1,0,0,0,0,18,18,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,18,0,0,2,1,1,0,0,0,0,18,
1,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,2,2,1,1,0,0,0,2,1,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,18,0,0,1,1,0,0,0,0,0,0,0,15,0,0,0,0,2,1,1,1,1,1,1,1,1,0,2,2,2,1,1,1,1,0,5,0],[0,0,0,0,0,0,0,0,0,0,18,18,1,1,1,1,0,0,0,0,0,0,1,1,1,0,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,4,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],init:function(a){a.entities.push(new WorldText(300,730,500,"[W] or [Space] to JUMP","25px " + FONT,[255,255,255,1],[255,255,255,1],1,!0,"left"));a.entities.push(new WorldText(300,780,500,"[A] and [D] to MOVE",
"25px " + FONT,[255,255,255,1],[255,255,255,1],1,!0,"left"));a.entities.push(new WorldText(800,580,500,"Rescue Piggerton! ->","40px " + FONT,[255,255,255,1],[255,255,255,1],1,!0,"center"))}}});addBlock(function(){return{id:BLOCKS.length,name:"Air",ignoreCollisions:!0}});var FallingParticle=function(a,b,c,d,e,f,g,h,k){this.x=a;this.y=b;this.w=c;this.h=d;this.vx=e;this.vy=f;this.maxlife=this.life=g||10;this.color=h||"rgba(200,200,200,.4)";this.da=Math.PI/20;this.angle=0};
FallingParticle.prototype.update=function(a){a=1+(a/.8-1)/2;this.life--;0>=this.life?this.shouldDelete=!0:(this.x+=this.vx*a,this.y+=this.vy*a,this.angle+=this.da,this.vy+=.5*a)};FallingParticle.prototype.draw=function(a){a.save();a.fillStyle=this.color;var b=this.w;a.translate(this.x,this.y);a.rotate(this.angle);a.fillRect(-b/2,-b/2,b,b);a.restore()};
var GameScene=function(a,b,c){Scene.call(this,c);this.dontSpawnPig=b;this.player=new Player;this.entities=[];this.behinds=[];this.addEntity(this.player);this.p1controls=b=connectControls(Player.controls,this.player);this.keyMap={68:b.right,87:b.up,65:b.left,83:b.down,37:b.left,38:b.up,39:b.right,40:b.down,32:b.up,27:{down:this.pause.bind(this)},69:b.dash,78:{down:function(){this.keys[67]&&DEBUG&&this.loadNewLevel(this.levelIndex+1)}.bind(this)},66:{down:function(){this.keys[67]&&DEBUG&&this.loadNewLevel(this.levelIndex-
1)}.bind(this)}};this.camera={x:0,y:0,dx:0,dy:0,speed:10};this.inTransition=!1;this.transitionDirection=-1;this.overlayColor="rgba(0,0,0,0)";this.transitionDuration=this.transitionTimer=25;this.levels=a?[a]:createLevels();this.levelIndex=0;this.levelCompleted=!1;this.loadNewLevel(0);this.shouldFillAroundWorld=!0;this.levelDeaths=this.totalDeaths=this.screenShakeLevel=0;this.constrainCamera();this.frameStop=0};$jscomp.inherits(GameScene,Scene);
GameScene.prototype.addEntity=function(a){a.game=this;this.entities.push(a)};GameScene.prototype.playLevelIntro=function(){this.startTransition(25,-1,void 0)};
GameScene.prototype.playLevelOutro=function(){var a=this,b=this.levelIndex+1>=this.levels.length;this.pig?this.driver.setScene(new LevelCompleteScene(this,function(){a.levelIndex+1>=a.levels.length?a.win():(a.loadNewLevel(a.levelIndex+1),a.driver.setScene(new LevelIntroScene(a,!0)))},b)):this.startTransition(25,1,function(){this.levelIndex+1>=this.levels.length?this.win():(this.loadNewLevel(this.levelIndex+1),this.driver.setScene(new LevelIntroScene(this,!0)))})};GameScene.prototype.pause=function(){this.driver.setScene(new PauseScene(this))};
GameScene.prototype.moveCamera=function(a,b){var c=this.camera,d=b-c.y,e=a-c.x;c.speed>=Math.sqrt(d*d+e*e)&&(c.x=a,c.y=b);d=Math.atan2(b-c.y,a-c.x);circleMove(d,c.speed);c.x+=circleMoveX(d,c.speed);c.y+=circleMoveY(d,c.speed);this.constrainCamera()};
GameScene.prototype.followPlayer=function(){var a=this.camera,b=this.player,c=(b.x-a.x+a.dx)/10;3<Math.abs(c)&&(a.x+=c);a.y+=(b.y-a.y-30)/30;b.grounded&&(a.y+=(b.y-a.y-30)/20);0<b.vy&&a.y<b.y-30&&(a.y+=(b.y-a.y-30)/10);a.dy=b.crouching&&b.grounded?a.dy+1:0;30<a.dy&&(a.dy=30);10<a.dy&&(a.y+=(2*a.dy-10)/3);this.constrainCamera()};
GameScene.prototype.constrainCamera=function(a,b,c,d){var e=this.camera,f=this.canvas;if(f){var g=this.world;void 0==a||void 0==b||void 0==c||void 0==d?(e.x=constrain(e.x,f.width/2,g.w*g.s-f.width/2),e.y=constrain(e.y,f.height/2,g.h*g.s-f.height/2)):(e.x=constrain(e.x,a+f.width/2,a+c-f.width/2),e.y=constrain(e.y,b+f.width/2,b+d-f.width/2),this.constrainCamera())}};
GameScene.prototype.detectLevelComplete=function(){this.player.x/this.world.s>=this.world.w-2&&this.player.grounded&&this.loadNewLevel(this.levelIndex+1)};GameScene.prototype.levelComplete=function(){this.player.dead||this.levelCompleted||(this.levelCompleted=!0,this.playLevelOutro())};GameScene.prototype.win=function(){this.driver.setScene(new PostWinScene(this))};
GameScene.prototype.loadNewLevel=function(a){this.frameStop=0;0>a&&(a=0);this.kingByrd=this.butcher=null;var b=!1;void 0==a?b=!0:(this.levelIndex=a,this.levelDeaths=0,this.music||(this.music=SOUNDMAP.music.play()));this.levelIndex>=this.levels.length?this.win():(a=this.levels[this.levelIndex],b||(this.world=new WorldFromLevel(a,this.levelIndex)),this.player.reset(),this.entities=[],this.world.loadWorld(this),this.entities.push(this.player),this.initializeLevel(a),a.modifyPlayer&&a.modifyPlayer(this.player),
this.level=a,this.camera.x=this.player.x,this.camera.y=this.player.y,this.constrainCamera(),this.playLevelIntro(),this.levelCompleted=!1)};GameScene.prototype.initializeLevel=function(a){a.init&&a.init(this)};GameScene.prototype.respawn=function(){this.totalDeaths++;this.levelDeaths++;this.loadNewLevel()};
GameScene.prototype.musicFadeOnPig=function(){var a=this.pig,b=this.player;this.music||(this.music=SOUNDMAP.music.play());a&&b&&(a=distanceBetweenEntities(a,b),500>a?(SOUNDMAP.music.lerpVolume(a/500),100>a?(this.musicFaded=!0,this.musicTime=this.music.getTime(),this.music.pause()):(this.musicFaded&&this.music.resume(this.musicTime),this.musicFaded=!1)):(this.music&&(this.musicFaded&&this.music.resume(this.musicTime),this.musicFaded=!1),this.musicTime=this.music.getTime(),SOUNDMAP.music.setVolume(1)))};
GameScene.prototype.update=function(a,b){this.musicFadeOnPig();this.player.resetControls();var c=this.entities;Scene.prototype.update.call(this,a);if(0<this.frameStop){var d=this.frameStop-=.1;d/=5;1<d&&(d=1);a*=1-.8*d}for(d=0;d<c.length;d+=1){var e=c[d];e.update(a,b);e.shouldDelete&&c.splice(d--,1)}c=this.entities;this.behinds.forEach(function(a){c.unshift(a)});this.behinds=[];this.followPlayer();this.updateScreenShakeLevel()};
GameScene.prototype.updateScreenShakeLevel=function(){this.screenShakeLevel=linearMove(this.screenShakeLevel,0,.05)};
GameScene.prototype.draw=function(a){this.canvas||(this.canvas=a,this.constrainCamera());var b=this.camera;a.clearRect(0,0,a.width,a.height);this.doScreenShake(a);a.save();this.world.drawBackground(a,this.camera);this.shouldFillAroundWorld&&this.fillAroundWorld(a);a.translate(a.width/2,a.height/2);a.rotate(b.r);a.translate(-Math.floor(b.x),-Math.floor(b.y));this.world.draw(a);for(b=0;b<this.entities.length;b+=1)this.entities[b].draw(a);a.restore();this.level.name&&(a.fillStyle="#fff",a.fillText(this.level.name,
200,a.height-30));drawTransitionOverlay(this.overlayColor,a)};GameScene.prototype.fillAroundWorld=function(a){if(this.world.image){var b=a.height/2-Math.floor(this.camera.y);a.fillStyle="black";a.fillRect(0,this.world.image.height+b,this.world.image.width,1E3);a.fillRect(0,-1E3+b,this.world.image.width,1E3)}};
GameScene.prototype.doScreenShake=function(a){if(0==this.screenShakeLevel)return this.camera.r=0;a=Math.sin(this.driver.frameCount*Math.PI/3)*this.screenShakeLevel*10;var b=Math.cos(this.driver.frameCount*Math.PI/4)*this.screenShakeLevel*Math.PI/80;this.camera.x+=Math.cos(this.driver.frameCount*Math.PI/3)*this.screenShakeLevel*10;this.camera.y+=a;this.camera.r=b};GameScene.prototype.collidesWithPlayer=function(a){a=a.getHitBox();var b=this.player.getHitBox();return rectangleCollision(a,b)};
var Button=function(a,b,c,d,e,f){GUIElement.call(this,a,b,c,d,e);this.onRelease=f;this.onHold=this.onPress=void 0;this.selected=this.held=!1;this.requireMouseInRegionOnRelease=!0;this.buttonLinks=Array(4).fill(void 0);this.value=void 0};$jscomp.inherits(Button,GUIElement);Button.prototype.setNeighbors=function(a){this.buttonLinks=a};
Button.prototype.getNeighbor=function(a){switch(a){case "up":return this.buttonLinks[0];case "right":return this.buttonLinks[1];case "down":return this.buttonLinks[2];case "left":return this.buttonLinks[3];default:console.log("getNeighbor()->Expected: [up,right,down,left]"),console.log("               Received: "+a)}};Button.prototype.update=function(a){};Button.prototype.draw=function(a){};SOUNDMAP.jump=new SoundEffect(.03,[550,660,770,1100],[.3,.5,.6,.4,0],4,2);
SOUNDMAP.jump=new SoundEffect(.02,[220,440,660,880],[.3,.5,.6,.4,0],4,1,"sine");SOUNDMAP.jump2=new SoundEffect(.02,[450,500,660,1100],[.2,.5,.4,.7,0],3,10);SOUNDMAP.land=new SoundEffect(.01,[220,440,220,440,220,220],[.5,.8,.5,.5,.4,.2],3);SOUNDMAP.land=new SoundEffect(.01,[220,440,220,220],[.5,.8,.5,0],4);SOUNDMAP.dash=new SoundEffect(.04,[440,2400,2E3,1800],[.1,.5,.6,.7,.1],5,3);SOUNDMAP.dash=new SoundEffect(.02,[660,770,880,990,990],[.1,.5,.6,.7,0],5,2,"sine");
SOUNDMAP.woof=new SoundEffect(.04,[880,1200,660,440],[.7,.5,.6,.3,.1],5,10);SOUNDMAP.pickup=new SoundEffect(.1,[440,880,880],[.5,.5,0],3,1);SOUNDMAP.playerDeath=new SoundEffect(.03,[1200,880,0,440,110,440,110,0,220,110,100,102,105,110,120,121],[.5,.5,0,.5,.5,.5,.5,0,.5],5,10,"square");SOUNDMAP.playerDeath=new SoundEffect(.04,[220,440,0,440,110,440,110,0,220,110,100,102,105,110,120,121],[.25,0,0,.25,.25,.5,.5,0,.5],5,1,"sawtooth");
addLevel(function(a){return{name:"Birds",worldType:0,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0],[0,0,19,19,19,0,0,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,19,19,0,19,0,0,0,0,0,0,0,0,19,19,19,19,19,0,0,0,0,0,0,0,0,17,0,0,1,1,1,1,1],[19,19,19,19,19,19,19,19,19,19,19,19,0,19,19,19,19,19,19,19,19,0,0,0,19,19,19,19,19,19,19,27,23,0,0,0,0,0,0,0,17,0,0,1,1,1,1,1],[19,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,19,19,19,19,19,19,19,27,18,19,0,0,
0,0,0,14,17,15,0,1,1,1,1,1],[19,19,18,19,18,19,19,19,18,19,19,0,0,19,19,19,19,19,18,19,19,19,0,19,19,19,19,19,19,15,18,27,19,19,0,0,0,0,0,0,9,9,1,1,1,1,1,1],[0,19,18,18,19,19,19,18,19,19,0,0,0,19,18,19,18,18,19,19,19,19,0,19,19,19,19,19,27,23,23,23,19,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[0,19,19,19,18,19,19,19,19,19,0,0,0,19,18,18,18,19,19,18,19,19,0,19,19,18,18,19,27,19,19,19,19,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,18,18,18,19,19,0,0,0,19,19,19,19,18,19,18,17,19,19,0,0,19,19,18,18,27,18,18,19,0,0,
0,0,0,0,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,18,19,19,19,0,0,0,0,19,19,19,18,18,18,17,14,0,0,0,0,0,19,19,27,18,18,19,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,19,18,23,23,23,9,9,9,0,0,0,19,19,18,18,19,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,19,18,18,0,0,0,0,0,0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[4,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,
18,18,18,0,0,0,0,0,0,0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,18,18,18,0,0,0,0,0,0,18,18,18,18,18,18,0,0,0,0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,18,0,0,0,0,15,18,1,1,1,1,1,18,18,0,0,0,0,0,0,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){var a=function(a,c,d,e,f,g,h,k){var b="#732",m="#843",n=Math.floor(h*h/2+h);1==n%k&&(b="#6a2a1a",m="#7a3a2a");0==n%k&&(b="#621",m="#732");a.fillStyle=b;a.fillRect(c,d,e,f);a.strokeStyle="#000";a.lineWidth=1;b=Math.max(e,f);a.fillStyle=m;m=b/3;for(n=0;3>n;n++){var p=psuedoRandom(c,d,n,1),q=psuedoRandom(c,d,n,2);a.fillRect(10*Math.floor(p*(e-m)/10)+c,10*Math.floor(q*(f-m)/10)+d,m,m)}g&&(g.getCell(h,k-1).groundBlock||(a.fillStyle="#090",a.fillRect(c,d,e,b/8),a.strokeRect(c,d,e,0)),
g.getCell(h,k+1).groundBlock||a.strokeRect(c,d+f,e,0),g.getCell(h+1,k).groundBlock||a.strokeRect(c+e,d,0,f),g.getCell(h-1,k).groundBlock||a.strokeRect(c,d,0,f))};return{id:BLOCKS.length,name:"Ground",solid:!0,groundBlock:!0,safe:!0,draw:function(a,c,d,e,f,g,h,k){this.drawTypes[g&&g.worldtype||0](a,c,d,e,f,g,h,k)},drawTypes:{0:a,1:a,2:function(a,c,d,e,f,g,h,k){a.fillStyle="#000";a.fillRect(c,d,e,f);a.strokeStyle="#fff";var b=Math.max(e,f);a.fillStyle="#777";g&&(g.getCell(h,k-1).groundBlock||(a.fillStyle=
"#aaa",a.fillRect(c,d,e,b/8),a.strokeRect(c,d,e,0)),g.getCell(h,k+1).groundBlock||a.strokeRect(c,d+f,e,0),g.getCell(h+1,k).groundBlock||a.strokeRect(c+e,d,0,f),g.getCell(h-1,k).groundBlock||a.strokeRect(c,d,0,f))},3:function(a,c,d,e,f,g,h,k){g=MAIN.scene.player;h=Math.floor(255*Math.random());k=1;if(g){h=g.x-(c+e/2);k=g.y-(d+f/2);var b=Math.sqrt(h*h+k*k);h=Math.floor(b-MAIN.frameCount+10*g.width)%255;k=1-b/100;0>k&&(k=0);k+=1/(b/10+1)}a.fillStyle="hsla("+h+",100%,50%,"+k+")";a.fillRect(c,d,e,f)}}}});
var Mover=function(a,b){this.x=a||10;this.y=b||10;this.w=25;this.h=35;this.width=this.w;this.height=this.h;this.vy=this.vx=0;this.grav=.8;this.my=this.mx=0;this.speed=10;this.grounded=!1;this.jumpPower=15;this.flipped=!1;this.color="#000";this.cloudParticlesOn=!0;this.wallcolliding=!1;this.maxJumps=1;this.angle=this.dashCount=this.jumpCount=0;this.terminalVelocity=15;this.wallSlides=this.mover=!0;this.wallJumps=!1;this.groundAccel=2;this.airAccel=1.5;this.currentGroundAccel=this.groundAccel;this.ceilingColliding=
this.invisible=this.spinning=this.diesToSpikes=!1;this.movementStun=this._angle=0;this.jumpSoundType=SOUNDMAP.jump2};Mover.prototype.die=function(){this.shouldDelete=!0};
Mover.prototype.update=function(a,b){1<this.mx&&(this.mx=1);-1>this.mx&&(this.mx=-1);1<this.my&&(this.my=1);-1>this.my&&(this.my=-1);0<this.movementStun&&this.movementStun--;if(this.mx&&!this.spinning&&(this.flipped=0>this.mx,!this.wallcolliding&&this.cloudParticlesOn&&this.grounded&&!this.crouching&&(0==b%20||0>=this.vx*this.mx||1>Math.abs(this.vx))))for(var c=0;3>c;c++)this.game.addEntity(new Cloud(this.x-this.mx*c*5,this.y+Math.random(),5+2*c,10,-this.mx,0,10+2*c));if(this.crouching&&this.grounded)this.vx-=
this.vx/10,this.mx=0;else{c=this.currentGroundAccel;this.grounded||(c=this.airAccel);var d=this.mx;this.movementStun&&(d=0);0==d&&this.grounded&&(c=10);this.vx=linearMove(this.vx,d*this.speed,c*a)}this.vy+=this.grav*a;c=this.terminalVelocity;this.crouching?c*=1.4:this.jumpCount<this.maxJumps&&(c*=.8);this.vy>c&&(this.vy=c);this.safeMove(this.vx*a,this.vy*a+this.grav*a*a/2);this.ghostOn||(c=this.game.world.h*this.game.world.s+200,this.y>c&&this.groundCollide(c));0<this.wallCollideTimer&&--this.wallCollideTimer;
0<this.vy&&(this.grounded=!1);this.wallcolliding?(this.wallJumps&&this.wallSlides&&0<this.vy&&(this.vy*=.7),this.wallJumps&&(this.wallCollideTimer=10)):0<this.wallCollideTimer&&0!=this.mx&&0<this.mx==this.walldirection&&(this.wallCollideTimer=0);this.vy>3*this.grav&&0==this.jumpCount&&(this.jumpCount=1);this.angle=1!=this.jumpCount||this.wallcolliding?this.spinning&&!this.ceilingColliding?this.wallcolliding?this.angle-angleBetween(this.angle,0)/5*-(1-2*this.flipped):this.angle+Math.PI/10*(1-2*this.flipped):
1<Math.abs(this.vx)&&!this.wallcolliding&&!this.crouching&&this.grounded?-Math.PI/40*this.vx/this.speed+Math.cos(b*Math.PI/7)*Math.PI/20:0:-Math.cos(this.vy/this.terminalVelocity*Math.PI)*(1-2*this.flipped)*Math.abs(this.vx/this.speed)/2;this.crouching?(this.width+=(1.2*this.w-this.width)/2,this.height+=(.6*this.h-this.height)/2):this.spinning?(this.width+=(1*this.w-this.width)/5,this.height+=(1*this.h-this.height)/5):(this.width+=(this.w-this.width)/8,this.height+=(this.h-this.height)/8);this.ceilingColliding&&
.5>=this.h-this.height&&(this.ceilingColliding=!1)};
Mover.prototype.safeMove=function(a,b){if(this.ghostOn)this.x+=a,this.y+=b;else{var c=this.game.world,d=this.w,e=this.h,f=c.rectCollides(this.x-d/2+a+0,this.y-e+1,d,e-2,this,0+a,0);f?(1===f.i%2?(f=f.x,this.x=f-d/2-1):(f=f.x+f.w,this.x=f+d/2+1),this.walldirection=0<this.vx+0,this.wallJumps&&this.wallSlides&&!this.grounded?this.vx>this.speed/2?this.vx=this.speed/2:this.vx<-this.speed/2&&(this.vx=-this.speed/2):this.vx=0,this.wallcolliding=!0):(this.x+=a,this.wallcolliding=!1);(d=c.rectCollides(this.x-
d/2,this.y-e+b,d,e,this,0,b))?0<this.vy?(this.groundCollide(Math.floor(d.y)),this.ceilingColliding=!1):(this.y=d.y+e+c.s,this.width+=-this.vy+3,this.height-=5,this.vy*=.7,this.ceilingColliding=!0):this.y+=b}};
Mover.prototype.land=function(){this.width+=30;this.height-=20;this.currentGroundAccel=this.groundAccel/2;SOUNDMAP.land.play(this);var a=this;setTimeout(function(){a.currentGroundAccel=a.groundAccel},10);this.crouching||(this.vx=0);if(this.cloudParticlesOn)for(var b=0;6>b;b++)this.game.addEntity(new Cloud(this.x+this.w/2+4,this.y+3,3+Math.random(),10,3*Math.random()-3*Math.random(),0)),this.game.addEntity(new Cloud(this.x-this.w/2-4,this.y+3,3+Math.random(),10,3*Math.random()-3*Math.random(),0))};
Mover.prototype.groundCollide=function(a,b){this.y=a;this.vy=0;this.grounded||b||this.land();this.grounded=!0;this.dashCount=this.jumpCount=0;this.spinning=!1};
Mover.prototype.draw=function(a){if(!this.invisible){var b=this.height,c=this.width;a.save();a.translate(this.x,this.y);this.ceilingColliding&&a.translate(0,-this.h+this.height);1<Math.abs(this.vx)&&!this.wallcolliding&&!this.crouching&&this.grounded&&a.translate(0,3*-(Math.sin(this.x/this.speed*10*Math.PI/70)+1));this.spinning&&a.translate(0,-b/2);a.rotate(this.angle+this._angle);this.spinning&&a.translate(0,b/2);this.flipped&&a.scale(-1,1);this.wallcolliding&&this.wallSlides&&this.wallJumps&&a.translate(-(this.w-
this.width)/2,0);this.drawShape(a,c,b);a.restore()}};Mover.prototype.drawShape=function(a,b,c){a.fillStyle=this.color;a.fillRect(-b/2,-c,b,c)};
Mover.prototype.jump=function(a,b){this.jumpRelease=!1;if(!this.jumpSquating){if(0<this.wallCollideTimer&&this.wallJumps&&!this.grounded)return this.wallJump();if(!(this.jumpCount>=this.maxJumps)){var c=30,d=a||this.jumpPower;0<this.jumpCount&&(c=0,d+=2);this.width=55;this.height=15;this.vy=0;this.jumpSquating=!0;this.currentGroundAccel=this.vx=0;setTimeout(function(){this.jumpSquating=!1;this.vx=this.mx*this.speed;this.currentGroundAccel=this.groundAccel;if(!(this.jumpCount>=this.maxJumps)&&(this.jumpCount++,
this.grounded=!1,1<this.jumpCount?this.spinning=!0:(this.height+=10,this.width-=10),this.vy=-d,b||this.playJumpSound(),this.jumpRelease&&(this.vy*=.65),this.cloudParticlesOn))for(var a=0;3>a;a++)this.game.addEntity(new Cloud(this.x-5*a,this.y,5+2*a,10,-2,0,5+2*a)),this.game.addEntity(new Cloud(this.x+5*a,this.y,5+2*a,10,2,0,5+2*a)),this.game.addEntity(new Cloud(this.x-6+3*a,this.y,5,10,-1+a,0,5+2*a))}.bind(this),c)}}};
Mover.prototype.playJumpSound=function(){var a=this.jumpSoundType;1<this.jumpCount&&(a=SOUNDMAP.doubleJump);this.jumpSound=a.play(this)};
Mover.prototype.wallJump=function(){this.jumpCount=1;this.dashCount=0;this.vy=-this.jumpPower;SOUNDMAP.wallJump.play();this.grounded=!1;this.height+=10;this.width-=10;this.spinning=!1;if(this.cloudParticlesOn)for(var a=0;3>a;a++)this.game.addEntity(new Cloud(this.x-5*a,this.y,5+2*a,10,-2,0,5+2*a)),this.game.addEntity(new Cloud(this.x+5*a,this.y,5+2*a,10,2,0,5+2*a)),this.game.addEntity(new Cloud(this.x-6+3*a,this.y,5,10,-1+a,0,5+2*a));this.vx=12*(1-2*this.walldirection)*.7;this.wallCollideTimer=this.wallcolliding=
0};Mover.prototype.shortJump=function(){this.jumpRelease=!0;!this.grounded&&1==this.jumpCount&&this.vy<-this.jumpPower/2&&(this.vy*=.65,this.jumpSound.stopSound())};Mover.prototype.crouch=function(){this.crouching||(this.width=50,this.height=10,SOUNDMAP.crouch.play());this.crouching=!0;!this.grounded&&0<this.vy&&(this.vy+=10)};Mover.prototype.uncrouch=function(){this.crouching&&(this.height=40,this.width=23,SOUNDMAP.uncrouch.play());this.crouching=!1};
Mover.prototype.getHitBox=function(){var a=this.width,b=this.height;return{x:this.x-.5*a,y:this.y-b,w:a,h:b}};Mover.prototype.dash=function(a){DASHON&&(void 0==a&&(a=this.mx),a||(a=1-2*this.flipped),0==this.dashCount&&(this.dashCount++,SOUNDMAP.dash.play(this),this.vx=.5*this.vx+30*a,this.vy=-10,this.grounded=!1))};
var PigFunScene=function(){GameScene.call(this,{grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,19,19,19,19,19,19,19,0,19,19,0,0,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,23,23,23,19,19,19,18,18,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,21,19,19,19,19,18,18,18,18,18,19,19,19,19,
0,0,0,0,0,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,18,19,19,19,19,19,19,19,19,19,19,18,18,18,19,19,19,19,19,0,0,0,0,0,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,18,19,18,19,19,0,0,19,19,19,19,19,19,19,18,18,18,23,23,19,19,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,18,18,18,23,23,23,9,9,19,18,19,19,19,19,0,18,18,18,18,19,19,0,0,0,0,19,19,19,19,19,19,19,18,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,22,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18,18,19,19,19,19,18,19,19,19,19,19,18,18,18,19,0,19,0,0,0,0,19,19,19,19,19,19,19,18,18,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,23,23,23,23,18,18,19,19,19,19,19,18,18,19,18,19,19,18,18,18,1,0,0,0,0,0,0,19,0,19,19,18,19,19,18,18,19,19,19,0,0,19,19,19,19,19,0,0,0,0,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18,19,21,0,19,19,18,18,18,18,19,19,18,18,18,1,0,0,0,0,0,0,19,0,19,18,18,19,18,18,18,19,19,19,0,0,19,19,19,19,19,19,0,0,19,19,19,19,19,19,19,19,0,0,0,0,19,
19,19,19,19,19,19,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,19,19,21,19,19,19,19,19,19,19,19,0,19,19,18,18,18,19,19,0,19,19,19,18,18,18,19,19,18,18,18,1,1,1,0,0,0,0,0,0,0,0,18,18,18,18,18,19,19,0,19,19,19,19,19,19,19,19,0,19,19,19,19,19,19,19,19,19,0,0,0,0,19,19,19,19,19,19,19,19,19,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,18,19,19,19,19,19,19,0,0,19,18,18,18,0,19,0,0,19,19,19,18,18,19,0,18,18,18,1,1,1,1,1,1,1,1,1,1,23,23,23,23,23,19,19,19,0,19,19,19,19,19,19,19,19,19,19,19,19,19,18,19,19,19,19,0,0,
0,19,19,19,19,19,19,19,19,19,19,19,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,19,19,19,18,18,18,18,19,19,0,19,0,0,0,18,18,18,0,0,0,0,0,0,19,18,18,19,0,1,1,1,1,1,1,1,1,1,1,1,1,1,19,18,18,18,18,19,0,19,19,19,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,19,19,0,19,19,19,19,19,19,19,19,19,19,19,19,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,18,23,23,23,9,0,19,0,0,1,1,18,18,0,0,0,0,0,9,23,23,18,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,19,19,18,18,19,19,0,19,19,19,18,19,18,19,18,19,19,19,19,18,19,19,18,19,19,19,19,19,0,19,19,
18,19,19,19,18,19,19,19,19,19,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,19,0,19,18,18,18,19,21,0,0,0,0,1,1,1,18,0,0,0,0,0,0,0,18,18,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,19,18,18,19,19,0,0,19,21,18,18,18,18,18,19,19,19,19,19,18,19,18,18,18,19,0,0,0,0,19,19,18,19,19,19,18,19,19,19,0,1,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,19,0,19,18,18,19,19,0,0,0,0,0,1,1,1,18,0,0,0,0,0,0,0,18,18,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,18,18,19,0,0,0,19,19,19,18,18,18,18,18,19,19,19,19,18,18,18,23,23,23,23,23,9,0,0,19,18,18,19,18,18,18,18,19,0,
1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,19,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,18,18,18,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,18,18,0,1,0,0,0,0,19,19,23,23,23,18,19,19,0,19,18,18,18,18,19,19,19,0,0,0,0,19,19,18,18,18,18,18,19,19,0,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,18,18,0,1,9,9,9,9,9,23,23,23,18,18,19,19,0,0,18,18,18,18,19,19,0,0,0,0,0,9,23,23,23,18,18,18,19,0,0,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,0,0,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,18,18,1,1,0,0,0,0,0,0,19,18,18,18,0,19,0,0,0,18,18,19,19,0,24,0,0,0,0,0,21,19,18,18,18,0,21,0,0,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,18,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,18,1,1,0,0,0,0,0,0,0,18,18,18,0,21,0,0,0,18,18,19,0,0,24,0,0,0,0,0,0,0,18,18,0,0,0,0,0,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,18,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
0,18,18,18,0,0,0,0,0,18,18,0,0,0,24,0,0,0,0,0,0,0,18,23,23,9,0,0,0,1,1,1],[0,4,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,20,0,18,18,18,18,0,0,0,18,18,18,0,0,0,24,0,0,0,0,0,25,0,18,18,18,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,25,0,18,18,18,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,25,0,18,18,18,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]},!0);this.gui=[]};$jscomp.inherits(PigFunScene,GameScene);PigFunScene.prototype.win=function(){this.driver.setScene(new IntroScene)};
var TextButton=function(a,b,c,d,e,f,g,h,k,l,m,n){Button.call(this,a,b,c,d,e,f);this.text=g;this.font=h;this.textColor=k||"rgba(0,0,0,0)";this.rectBackFillColor=l||"rgba(0,0,0,0)";this.rectOutlineColor=m||"rgba(0,0,0,0)";this.strokeWidth=n||1};$jscomp.inherits(TextButton,Button);TextButton.prototype.update=function(a){};TextButton.prototype.draw=function(a){var b=this.getPixelDimensions(a);this.drawRectangle(a,b);this.selected&&!this.held&&this.drawOutline(a,b);this.drawText(a,b)};
TextButton.prototype.drawOutline=function(a,b){a.lineWidth=this.strokeWidth;a.strokeStyle=this.rectOutlineColor;a.strokeRect(b[0],b[1],b[2],b[3])};TextButton.prototype.drawRectangle=function(a,b){a.fillStyle=this.rectBackFillColor;a.fillRect(b[0],b[1],b[2],b[3])};TextButton.prototype.drawText=function(a,b){a.font=this.font;a.fillStyle=this.textColor;a.textAlign="center";a.textBaseline="middle";a.fillText(this.text,b[0]+b[2]/2,b[1]+b[3]/2,this.w*a.width*.8)};
SOUNDMAP.crouch=new SoundSource("jumpSound1-1.m4a",3);SOUNDMAP.land=new SoundSource("jumpSound1-2.m4a",.75);SOUNDMAP.jump=new SoundSource("crouch1-1.m4a",3,4);SOUNDMAP.jump2=new SoundSource("jumpSound1-1.m4a",3,1);SOUNDMAP.wallJump=new SoundSource("crouch1-1.m4a",2);SOUNDMAP.doubleJump=new SoundSource("Double_Jump.wav",1,.5);SOUNDMAP.powerup=new SoundSource("Swipe.wav",1);SOUNDMAP.uncrouch=new SoundSource("crouch1-1.m4a",4);SOUNDMAP.playerDeath=new SoundSource("Death.wav",null,2);
SOUNDMAP.levelComplete=new SoundSource("Level_Complete.wav",1,.5);SOUNDMAP.pigrip=new SoundSource("Swipe.wav",3);SOUNDMAP.bounce=new SoundSource("Bounce2.wav",1);SOUNDMAP["throw"]=new SoundSource("Throw.wav");SOUNDMAP.uimove=new SoundSource("UI_Move2.wav",null,.2);SOUNDMAP.uiselect=new SoundSource("UI_Select3.wav",null,.2);SOUNDMAP.footstep=new PickAudio([new SoundSource("Steps1.wav"),new SoundSource("Steps2.wav"),new SoundSource("Steps3.wav"),new SoundSource("Steps4.wav"),new SoundSource("Steps5.wav")]);
SOUNDMAP.hapMusic=new MusicSource("Hap_Yay.mp3",1,1);SOUNDMAP.challengeMusic=new MusicSource("Challenge2.mp3");SOUNDMAP.music=new MusicHandler(SOUNDMAP.hapMusic,SOUNDMAP.challengeMusic);
addLevel(function(a){return{name:"The Height",worldType:0,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,27,27,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,23,23,27,23,23,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,23,18,18,27,18,18,23,27,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,23,18,9,9,23,9,9,18,23,0,0],[4,
0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,23,18,18,18,23,18,18,18,23,0,5],[1,1,1,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,9,23,27,27,27,27,27,27,27,27,27,23,9],[1,1,1,1,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,27,23,23,27,27,27,23,23,27,0,0],[1,1,1,1,1,0,0,15,17,14,0,0,0,0,0,0,0,0,0,0,0,0,17,14,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,27,23,23,23,27,23,23,23,27,0,0],[1,1,1,2,1,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,27,0,15,0,0,0,15,0,27,0,0],[1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,27,23,23,23,23,23,23,23,27,0,0],[1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,17,14,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,27,0,15,0,0,15,15,0,27,0,0],[1,1,1,1,1,2,0,0,2,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,2,0,0,0,0,0,0,0,27,23,23,23,23,23,23,23,27,0,0],[1,1,1,1,1,23,9,9,27,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,27,0,15,15,15,0,15,
0,27,0,0],[1,1,1,1,1,0,0,0,27,0,0,0,0,2,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,27,27,27,27,27,27,27,27,27,0,0],[1,1,1,0,0,0,0,0,27,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,2,27,27,23,23,27,23,23,27,27,0,0],[1,1,1,0,0,0,0,0,27,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,2,0,0,0,2,0,0,27,0,0,0,0,0,0,27,27,27,18,18,27,18,18,27,27,0,0],[1,1,1,0,0,0,0,0,27,0,0,2,0,27,0,0,2,0,0,0,0,0,27,0,27,0,0,0,27,0,0,27,0,0,0,0,0,0,27,27,27,18,18,27,18,18,27,27,0,0],[1,1,1,1,1,0,0,0,27,0,0,27,0,
27,0,0,27,0,0,0,0,0,27,0,27,0,0,0,27,0,0,27,0,0,2,0,0,0,27,27,27,18,18,27,18,18,27,27,0,0],[1,1,1,1,1,1,0,0,27,0,0,27,0,27,0,0,27,0,0,2,0,0,27,0,27,0,0,0,27,0,0,27,0,0,27,0,0,0,27,27,27,18,18,27,18,18,27,1,0,0],[1,1,1,1,1,1,0,0,27,0,0,27,0,27,0,0,27,0,0,27,0,0,27,0,27,0,0,0,27,0,0,27,0,0,27,0,0,0,27,27,27,18,18,27,18,18,27,1,0,0],[1,1,1,1,1,1,1,0,27,0,0,27,0,27,0,0,27,0,0,27,0,0,27,0,27,0,0,0,27,0,0,27,0,0,27,0,0,0,27,27,27,18,18,27,18,1,1,1,0,0],[1,1,1,1,1,1,1,0,27,0,0,27,0,27,0,0,27,0,0,27,0,0,
27,0,27,0,0,0,27,0,0,27,0,0,27,0,0,0,27,27,27,18,18,27,18,1,1,1,0,0],[1,1,1,1,1,1,1,1,27,0,0,27,0,27,0,0,27,0,0,27,0,0,27,0,27,0,0,0,27,0,0,27,0,0,27,0,0,0,27,27,27,18,18,27,18,1,1,1,0,0],[1,1,1,1,1,1,1,1,1,0,0,27,0,27,0,0,27,0,0,27,0,0,27,0,27,0,0,0,27,0,0,27,0,0,27,0,0,0,27,27,27,18,18,27,18,1,1,1,0,0]]}});
addBlock(function(){return{id:BLOCKS.length,name:"Spike",solid:!0,angle:0,redraws:!1,draw:function(a,b,c,d,e,f,g,h){(f.getCell(g,h-1).trunk||f.getCell(g,h+1).trunk||f.getCell(g+1,h).trunk||f.getCell(g-1,h).trunk)&&CELLMAP[18].draw(a,b,c,d,e,f,g,h);this.drawSpike(a,b,c,d,e,f,g,h)},drawSpike:function(a,b,c,d,e,f,g,h){a.fillStyle="white";a.strokeStyle="#000";a.save();a.translate(b+d/2,c+e/2);a.rotate(this.angle);d*=.9;e*=.9;for(g=0;3>g;g++)a.rotate(Math.PI/8),a.fillRect(-d/2,-e/2,d,e),a.strokeRect(-d/
2,-e/2,d,e);d*=.8;e*=.8;a.rotate(-3*Math.PI/8);a.fillStyle="grey";a.fillRect(-d/2,-e/2,d,e);a.restore()},entityCollision:function(a,b){a.player&&a.die();return!0}}});var Player=function(){Mover.call(this);this.y=this.x=100;this.mx=0;this.eyeMovement={x:0,y:0,blink:0,blinkTime:10,tx:0,ty:0};this.dead=!1;this.player=!0;this.color1="#666";this.color2="#222";this.jumpSoundType=SOUNDMAP.jump;this.holdingJump=this.bouncedOffEntity=!1;this.bounceTimer=0};$jscomp.inherits(Player,Mover);
Player.prototype.die=function(){this.dead||(SOUNDMAP.playerDeath.play(this),this.dead=!0,this.eyeMovement.x=-5,this.eyeMovement.y=0,this.game.screenShakeLevel+=1,this.game.frameStop=10,this.eyeMovement.blink=0,this.animation=new Animation2(4,function(a,b){this.angle=this.mx=0;this.width=this.w;this.height=this.h}.bind(this),function(){for(var a=0;20>a;a++){var b=this.x+(Math.random()*this.w-this.w/2)/2,c=this.y-Math.random()*this.h/2,d=5*Math.random()-2+this.vx/5,e=5*Math.random()-2-10,f="#666";12<=
a&&(f="#222");16<=a&&(f="#33d");18<=a&&(f="#fff");this.game.addEntity(new FallingParticle(b,c,10,10,d,e,100,f))}this.vy=-20;this.invisible=!0;this.animation=new Animation2(60,function(a,b){}.bind(this),function(){this.game.respawn()}.bind(this))}.bind(this)))};Player.prototype.resetControls=function(){this.mx=0};
Player.prototype.update=function(a,b){0<this.bounceTimer&&--this.bounceTimer;this.animation?this.animation.update(a,b):(this.updateEye(a,b),Mover.prototype.update.call(this,a,b),this.grounded&&!this.wallcolliding&&this.vx&&this.mx&&0==Math.floor(b)%10&&SOUNDMAP.footstep.play())};Player.prototype.reset=function(){this.x=60;this.y=100;this.vy=this.vx=0;this.maxJumps=1;this.wallJumps=!1;this.animation=null;this.dead=this.invisible=!1};
Player.prototype.updateEye=function(a,b){b=Math.floor(b);0==b%60&&.5<Math.random()&&(this.eyeMovement.blink=this.eyeMovement.blinkTime);0<this.eyeMovement.blink&&this.eyeMovement.blink--;0==this.mx?.99<Math.random()&&(this.eyeMovement.tx=6*Math.random()-3,this.eyeMovement.ty=5*Math.random()-4):(this.eyeMovement.tx=0,this.eyeMovement.ty=0);this.eyeMovement.x+=(this.eyeMovement.tx-this.eyeMovement.x)/10;this.eyeMovement.y+=(this.eyeMovement.ty-this.eyeMovement.y)/10};
Player.prototype.drawTail=function(a,b,c){a.fillStyle="brown";c=30;var d=10*Math.cos(Date.now()/500),e=0;0<this.wallCollideTimer&&(e=10,a.fillStyle="#c60",a.lineWidth=7,c+=5);var f=Math.cos(Date.now()/300)*Math.PI/30+Math.PI/20+this.vy/30;a.save();a.rotate(f);a.beginPath();a.moveTo(-b/2,-1);a.quadraticCurveTo(-b/2-c/2,-1,-b/2-c/2+d/2,-c/2-d/2);a.quadraticCurveTo(-b/2,-c,-b/2-c,-c-d-e);a.quadraticCurveTo(-b/2-c,-1,-b/2-10,-1);a.fill();a.fillStyle="#a42";a.beginPath();a.moveTo(-b/2,-1);a.quadraticCurveTo(-b/
2-c,-c/2,-b/2-c,-c-d);a.quadraticCurveTo(-b/2-c,-1,-b/2-10,-1);a.fill();a.restore()};Player.prototype.drawWings=function(a,b,c,d){if(!(2>this.maxJumps)){var e=40,f=7;0==this.jumpCount&&(e=20,f=5);if(this.jumpCount<this.maxJumps)var g=Math.PI/10+this.vy/10;else g=-Math.PI/4+this.vy/10,e=25;a.fillStyle=this.color2;a.beginPath();c=-c-10*g;this.pathWingAtAngle(a,-b/2-.8*e,c,e,f,.8*e,f/2,g);this.pathWingAtAngle(a,.3*b,c,e,f,.2*e,f/2,-g);d?a.stroke():a.fill()}};
Player.prototype.pathWingAtAngle=function(a,b,c,d,e,f,g,h){a.save();a.translate(b+f,c+g);a.rotate(h);a.rect(-f,-g-10,d,e);a.rect(.8*-f,-g,.8*d,e);a.rect(.5*-f,-g+5,.5*d,e);a.restore()};
Player.prototype.drawShape=function(a,b,c){this.wallJumps&&this.drawTail(a,b,c);a.save();a.strokeStyle="#000";a.lineWidth=7;this.drawWings(a,b,c,1);this.drawWings(a,b,c);a.strokeStyle="#000";a.strokeRect(-b/2-1,-c-1,b+2,c+2);a.fillStyle="#666";a.fillRect(-b/2,-c,b,c);a.fillStyle="#222";var d=.4*b+this.eyeMovement.x/2;this.dead&&(d-=5);a.fillRect(-b/2,-c,d,c);d=c/8;a.fillStyle="#33d";a.fillRect(-b/2,-d,b,d);a.fillStyle="#44e";a.fillRect(0,-d,b/2,d);a.fillStyle="#fff";var e=1-.6*Math.abs(this.vy)/this.terminalVelocity;
b=-c+10+this.eyeMovement.y;d=6+this.eyeMovement.x;var f=10-this.eyeMovement.x/3,g=0;0<this.eyeMovement.blink&&(g=(1+Math.cos((this.eyeMovement.blinkTime-this.eyeMovement.blink+1)*Math.PI/20))/2);b+=4*g;e=8*e*(1-g);this.crouching&&(d+=2);a.fillRect(d-f,b,8,e);a.fillRect(d,b,6,e);b=this.w;a.translate(0,-c);c=Math.abs(this.angle);c>Math.PI/4&&(c=Math.PI/4);a.rotate(-c);a.rotate(0);a.fillStyle="#f4d";a.beginPath();a.rect(-b/2-1,-4,b+9,4);a.rect(-b/2-1,-12,b-3,12);a.stroke();a.fill();a.fillStyle="#c2d";
a.beginPath();a.rect(-b/2-1,-4,(b+9)/4,4);a.rect(-b/2-1,-12,(b-3)/2,12);a.fill();a.restore()};Player.prototype.bounceOffEntity=function(a,b){this.groundCollide(this.y,!0);this.bounceTimer=10;this.jump(b||0==b?b:20,!0);SOUNDMAP.bounce.play();this.bouncedOffEntity=!0};Player.prototype.groundCollide=function(a,b){Mover.prototype.groundCollide.call(this,a,b);this.bouncedOffEntity=!1};Player.prototype.getHitByEntity=function(a){a.killPlayer&&this.die()};
Player.controls={right:{down:function(){this.crouching&&this.dash(1)},held:function(){this.mx+=1}},left:{down:function(){this.crouching&&this.dash(-1)},held:function(){--this.mx}},up:{down:function(){this.holdingJump=!0;this.dead||this.jump()},up:function(){this.holdingJump=!1;this.dead||this.bouncedOffEntity||(this.shortJump(),this.eyeMovement.ty=0)},held:function(){this.holdingJump=!0;this.eyeMovement.ty=-6;this.height+=.5;this.width-=.5}},down:{down:function(){this.crouch()},noneheld:function(){this.uncrouch()}},
dash:{down:function(){this.dash(1-2*this.flipped)}}};
var MenuScene=function(a){Scene.call(this,a);var b=this;this.menuState=0;this.allowUIInput=!0;this.addMainMenuGUI();this.keyMap={32:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},13:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},69:{down:function(){DEBUG&&b.driver.setScene(new LevelEditorSelectScene(!1))}},87:{down:this.navigateUI.bind(this,0)},65:{down:this.navigateUI.bind(this,1)},83:{down:this.navigateUI.bind(this,2)},68:{down:this.navigateUI.bind(this,
3)},38:{down:this.navigateUI.bind(this,0)},39:{down:this.navigateUI.bind(this,1)},40:{down:this.navigateUI.bind(this,2)},37:{down:this.navigateUI.bind(this,3)}};this.background=new InfiniteBackground;this.camera={x:0,y:0,dx:0,dy:0};this.allowUIInput=!0};$jscomp.inherits(MenuScene,Scene);MenuScene.prototype.update=function(a){this.camera.x+=3;Scene.prototype.update.call(this,a)};
MenuScene.prototype.draw=function(a){this.background.drawLayers(a,this.camera);this.drawAllGUI(a);this.debug&&drawGrid(a);drawTransitionOverlay(this.overlayColor,a)};MenuScene.prototype.drawAllGUI=function(a){for(var b=0;b<this.gui.length;b++)this.gui[b].visible&&this.gui[b].draw(a)};
MenuScene.prototype.addMainMenuGUI=function(){var a=rectDimFromCenter(.5,.28,.58,.12),b=new Label(a[0],a[1],a[2],a[3],0,"Jimothy Piggerton","60px " + FONT,"white","center");this.gui.push(b);a=rectDimFromCenter(.5,.48,.18,.1);b=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.startGame.bind(this),"Start Game","30px " + FONT,"white","transparent","white",5,.08);this.gui.push(b);a=rectDimFromCenter(.5,.6,.18,.1);var c=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToLevelSelect.bind(this),"Level Select",
"30px " + FONT,"white","transparent","white",5,.08);this.gui.push(c);a=rectDimFromCenter(.5,.72,.18,.1);var d=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToOptions.bind(this),"Options","30px " + FONT,"white","transparent","white",5,.08);this.gui.push(d);a=rectDimFromCenter(.5,.84,.18,.1);a=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToCredits.bind(this),"Credits","30px " + FONT,"white","transparent","white",5,.08);this.gui.push(a);b.setNeighbors([void 0,void 0,c,void 0]);c.setNeighbors([b,
void 0,d,void 0]);d.setNeighbors([c,void 0,a,void 0]);a.setNeighbors([d,void 0,void 0,void 0]);this.selectedButton=b;this.selectedButton.selected=!0;this.buttons=getButtons(this.gui)};MenuScene.prototype.startGame=function(){this.allowUIInput=!1;this.startTransition(25,1,sceneTransition(this,IntroScene,!0))};MenuScene.prototype.goToLevelSelect=function(){this.allowUIInput=!1;this.driver.setScene(new LevelSelectScene(!1))};MenuScene.prototype.goToOptions=function(){this.allowUIInput=!1;this.driver.setScene(new OptionScene(!1))};
MenuScene.prototype.goToCredits=function(){this.allowUIInput=!1;this.driver.setScene(new CreditsScene(!1))};var GrowthTextButton=function(a,b,c,d,e,f,g,h,k,l,m,n,p){TextButton.call(this,a,b,c,d,e,f,g,h,k,l,m,n);this.growthMax=p;this.maxWidth=this.w+this.growthMax;this.growthSpeed=.2;this.extraWidth=0};$jscomp.inherits(GrowthTextButton,TextButton);
GrowthTextButton.prototype.update=function(a){this.selected?(this.extraWidth+=this.growthSpeed*a*(this.growthMax-this.extraWidth),this.extraWidth>this.growthMax&&(this.extraWidth=this.growthMax)):(this.extraWidth-=this.growthSpeed*a*this.extraWidth,0>this.extraWidth&&(this.extraWidth=0))};
GrowthTextButton.prototype.draw=function(a){var b=this.getPixelDimensions(a);b[2]+=this.extraWidth*a.width;b[0]-=this.extraWidth*a.width/2;this.drawRectangle(a,b);this.selected&&!this.held&&this.drawOutline(a,b);b=this.getPixelDimensions(a);this.drawText(a,b)};
addLevel(function(a){return{name:"Entrance to the Temple",worldType:0,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,27,27,27,27,2,0,0,0,27,27,27,27,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,27,27,27,2,0,0,0,0,27,27,27,27,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,2,0,0,0,0,0,0,2,27,2,0,0,0,0,0,27,27,27,27,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,27,27,2,0,0,0,0,0,0,2,0,0,0,0,0,0,27,
23,23,27,0],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,27,27,27,27,2,0,0,0,0,0,0,0,0,0,0,0,0,23,0,0,23,0],[9,23,27,27,27,27,27,27,27,23,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,23,23,23,27,23,23,23,2,0,0,0,0,0,0,0,0,0,0,0,23,0,5,23,0],[0,0,27,27,23,27,23,27,27,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,27,27,27,27,23],[0,0,27,9,9,27,9,9,27,0,0,0,0,0,0,0,0,0,2,27,2,0,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,27,27,27,27,0],[0,0,27,9,9,27,9,9,27,0,0,0,0,0,
0,0,0,2,27,27,27,2,0,0,0,0,0,9,23,27,23,9,0,0,0,0,0,17,14,0,0,0,0,0,0,27,27,27,27,0],[0,0,27,9,9,27,9,9,27,0,0,0,0,0,0,0,2,27,27,27,27,27,2,0,0,0,0,0,0,27,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,27,23,23,27,0],[0,0,27,23,23,27,23,23,27,14,0,0,0,0,0,0,27,27,27,27,27,27,27,0,0,0,0,0,0,27,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,27,0,0,27,0],[0,27,27,27,27,27,27,27,27,27,27,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,17,0,0,0,2,0,0,0,0,0,0,0,0],[0,27,18,27,27,27,27,27,18,27,23,27,0,0,0,0,0,0,0,23,0,17,0,0,0,
0,0,0,0,27,0,0,0,0,0,0,0,17,0,0,2,27,2,0,0,0,0,0,0,0],[0,27,18,18,27,27,27,18,18,27,18,23,27,0,0,0,0,0,0,23,0,17,0,0,0,0,0,0,14,27,14,0,0,0,0,0,0,17,0,2,27,27,27,2,0,0,0,0,0,0],[0,27,18,18,18,27,18,18,18,27,18,18,27,0,0,0,0,9,23,27,23,9,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,17,2,27,27,27,27,27,2,0,0,0,0,0],[0,27,18,18,18,18,18,18,18,27,18,18,27,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,17,27,27,27,27,27,27,27,0,0,0,0,0],[0,27,23,23,23,23,23,23,23,27,18,18,23,27,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,
0,0,0,0,0,0,0,0,27,23,23,23,23,23,27,0,0,0,0,0],[0,27,27,23,23,23,23,23,27,27,27,18,18,27,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,23,23,23,23,23,27,0,0,0,0,0],[0,0,27,27,23,23,23,27,27,27,0,27,18,27,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,15,0,15,0,27,0,0,0,0,0],[0,0,0,27,27,23,27,27,27,0,0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,23,23,23,23,23,27,0,0,0,0,0],[0,0,0,27,27,27,27,27,27,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,0,
15,15,0,27,0,0,0,0,0],[0,0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,23,23,23,23,23,27,0,0,0,0,0],[0,0,0,27,18,23,18,27,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,0,15,15,15,0,27,0,0,0,0,0],[0,0,0,27,18,18,18,27,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,27,23,23,23,23,23,27,0,0,0,0,0]]}});
addBlock(function(){return{id:BLOCKS.length,name:"Ground Spike",solid:!0,redraws:!1,groundBlock:!0,draw:function(a,b,c,d,e,f,g,h){var k=.1*d;CELLMAP[2].drawSpike(a,b+k,c+k,d-2*k,e-2*k,f,g,h);k=.4*e;CELLMAP[1].draw(a,b,c+k,d,e-k,f,g,h)},entityCollision:function(a,b,c,d){a.player&&0<d&&a.die();return!0}}});
var Pig=function(a,b){Mover.call(this,a,b);this.color="pink";this.w=30;this.h=25;this.width=this.w;this.height=this.h;this.speed=0;this.cloudParticlesOn=!1;this.mx=-1;this.groundAccel=0;this.tx=a;this.ty=b;this.turnCounter=this.turnTime=50;this.bounceFrq=Math.PI/5;this.animationState=0;this.isPig=!0};$jscomp.inherits(Pig,Mover);
Pig.prototype.update=function(a,b){this.wallcolliding&&(this.mx=-this.mx,this.wallcolliding=!1,this.vx=0);this.width+=Math.sin(b*this.bounceFrq)*this.bounceFrq;this.height-=Math.sin(b*this.bounceFrq)*this.bounceFrq;Mover.prototype.update.call(this,a,b);1==rectangleCollision(this.getHitBox(),this.game.player.getHitBox())&&this.playerCollision();0==this.animationState&&(this.flipped=this.game.player.x<this.x)};Pig.prototype.playerCollision=function(){this.game.levelComplete()};
Pig.prototype.drawShape=function(a,b,c){a.strokeStyle="#fff";a.fillStyle="#fff";a.lineWidth=5;a.strokeRect(-b/2-1,-c-1,b+2,c+2);this.drawTail(a,-b/2,.8*-c,7,15);a.strokeRect(b/2-c/4,11*-c/16,c/2,c/2);a.beginPath();this.drawEar(a,6,-c-5,5,5);a.stroke();a.beginPath();this.drawEar(a,-6,-c-5,5,5);a.stroke();a.fillStyle=this.color;a.fillRect(-b/2,-c,b,c);a.fillStyle="#e8a";a.fillRect(-b/2,-c,b/3,c);this.drawTail(a,-b/2,.8*-c,3,15);a.fillStyle=this.color;a.beginPath();this.drawEar(a,6,-c-5,5,5);this.drawEar(a,
-6,-c-5,5,5);a.fill();this.drawSnout(a,b/2-c/4,11*-c/16,c/2,c/2);a.fillStyle="#000";var d=4+this.width/10,e=Math.PI/5;c=-c+2;1==this.animationState&&(d=2,e=0,c+=2);2==this.animationState&&(e=0);this.drawEye(a,0,c,5,d,-e);this.drawEye(a,b/2-3,c,5,d,e)};Pig.prototype.drawEar=function(a,b,c,d,e){a.rect(b,c,d,e)};Pig.prototype.drawSnout=function(a,b,c,d,e){a.fillStyle="#faa";a.fillRect(b,c,d,e);a.fillStyle="#966";var f=d/3;a.fillRect(b,c+e/2-f,f,f);a.fillRect(b+d-f,c+e/2-f,f,f)};
Pig.prototype.drawTail=function(a,b,c,d,e){a.save();a.strokeStyle=a.fillStyle;a.lineWidth=d;a.translate(b,c);a.rotate(Math.cos(this.x/this.speed/2)/2);a.beginPath();a.arc(-d/2,-e/4,e/4,Math.PI/2,3*Math.PI/2);a.arc(-d/2,-e/2+e/8,e/8,Math.PI/2,-Math.PI/2,!0);a.stroke();a.restore()};
Pig.prototype.drawEye=function(a,b,c,d,e,f){2==this.animationState?(a.beginPath(),a.moveTo(b,c+e/2),a.lineTo(b+d/2,c),a.lineTo(b+d,c+e/2),a.lineTo(b+d,c+e),a.lineTo(b+d/2,c+e/2),a.lineTo(b,c+e),a.fill()):(a.save(),a.translate(b+d/2,c+e/2),a.fillRect(-d/2,-e/2,d,e),0==this.animationState&&(a.rotate(f),a.fillRect(-d,-e,2*d,e/2)),a.restore())};
var IntroScene=function(){GameScene.call(this,{grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,19,
19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,0,19,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,19,19,19,18,19,19,18,19,18,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[4,0,0,0,0,0,0,0,19,0,19,18,18,19,18,18,18,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,19,18,18,18,18,19,19,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,19,0,18,18,18,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,0,0,4,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1]]},!0);this.gui=[];this.keyMap={27:{down:sceneTransition(this,GameScene)}};this.gamePadOn=!1;this.player.flipped=!0;this.pig=new Pig(this.player.x+100,this.player.y);this.pig.speed=0;this.butcher=new Butcher(this.player.x+600,this.player.y);this.addEntity(this.butcher);this.butcher.speed=0;this.addEntity(this.pig);this.player.updateEye=function(){};this.pig.mx=0;this.pig.bounceFrq=Math.PI/30;this.totalTime=400;this.time=this.totalTime+1E3;this.player.resetControls=function(){};
this.player.speed=4;this.player._angle=Math.PI/10;this.player.eyeMovement.blink=1;this.pig.animationState=1;this.startTransition(100,-1,function(){this.time=this.totalTime;this.butcher.speed=3.9});this.makeLetterBox();this.timeToWait=0;this.emitZ=!0;this.emissionDelay=35};$jscomp.inherits(IntroScene,GameScene);
IntroScene.prototype.makeLetterBox=function(){this.upperLetterBox=new ColoredBox(0,0,1,.2,0,"black","transparent",1);this.lowerLetterBox=new ColoredBox(0,.8,1,.2,0,"black","transparent",1);this.gui.push(this.upperLetterBox);this.gui.push(this.lowerLetterBox)};
IntroScene.prototype.moveCamera=function(){var a=this.camera,b=this.player,c=this.canvas,d=(b.x-a.x+a.dx)/10;3<Math.abs(d)&&(a.x+=d);a.y+=(b.y-a.y-30)/30;b.grounded&&(a.y+=(b.y-a.y-30)/20);0<b.vy&&a.y<b.y-30&&(a.y+=(b.y-a.y-30)/10);a.dy=b.crouching&&b.grounded?a.dy+1:0;60<a.dy&&(a.dy=60);10<a.dy&&(a.y+=(a.dy-10)/3);c&&(b=this.world,a.x<c.width/2&&(a.x=c.width/2),a.x>b.w*b.s-c.width/2&&(a.x=b.w*b.s-c.width/2),a.y>b.h*b.s-c.height/2+c.height*this.lowerLetterBox.h&&(a.y=b.h*b.s-c.height/2+c.height*this.lowerLetterBox.h),
a.y<c.height/2-c.height*this.upperLetterBox.h&&(a.y=c.height/2-c.height*this.upperLetterBox.h))};IntroScene.prototype.followPlayer=function(){this.moveCamera()};IntroScene.prototype.constrainCamera=function(a,b,c,d){};
IntroScene.prototype.update=function(a,b){GameScene.prototype.update.call(this,a,b);this.timeToWait--;this.time--;0>=this.time&&this.driver.setScene(new LevelIntroScene(new GameScene,!0));this.time>this.totalTime-200&&0==this.time%this.emissionDelay&&this.addEntity(new SleepText(this.player.x+this.player.w,this.player.y-this.player.h,20,2,-2,"Z","30",FONT,[255,255,255,1],[255,255,255,0],25,25,!0));this.time>this.totalTime-150&&9==this.time%this.emissionDelay&&this.addEntity(new SleepText(this.pig.x+
this.pig.w,this.pig.y-this.pig.h,20,2,-2,"Z","30",FONT,[255,255,255,1],[255,255,255,0],25,25,!0));this.time==this.totalTime-160&&this.addEntity(new SleepText(this.pig.x+this.pig.w/2,this.pig.y-this.pig.h-70,80,0,0,"!?","65",FONT,[255,255,255,1],[255,255,255,0],20,30,!0));this.time==this.totalTime-200&&(this.player.flipped=!1,this.player.jump(7),this.player._angle=0,this.player.eyeMovement.blink=0);this.time<this.totalTime-230&&(this.player.mx=1,this.moveCamera=function(){})};
IntroScene.prototype.draw=function(a){GameScene.prototype.draw.call(this,a);this.drawAllGUI(a)};var Label=function(a,b,c,d,e,f,g,h,k){GUIElement.call(this,a,b,c,d,e);GUIElement.prototype.setOptions.call(this,!1,!1,!0);this.text=f;this.font=g;this.textColor=h;this.textAlign=k;this.visible=!0};$jscomp.inherits(Label,GUIElement);Label.prototype.update=function(a){};Label.prototype.draw=function(a){var b=this.getPixelDimensions(a);this.drawText(a,b)};
Label.prototype.drawText=function(a,b){a.font=this.font;a.fillStyle=this.textColor;a.textAlign=this.textAlign;a.textBaseline="middle";switch(this.textAlign){case "left":a.fillText(this.text,b[0],b[1]+b[3]/2,this.w*a.width*.9);break;case "right":a.fillText(this.text,b[0]+b[2],b[1]+b[3]/2,this.w*a.width*.9);break;case "center":a.fillText(this.text,b[0]+b[2]/2,b[1]+b[3]/2,this.w*a.width*.9)}};Label.prototype.setOptions=function(a,b,c){GUIElement.prototype.setOptions.call(this,!1,!1,c)};
addLevel(function(a){return{name:"Temple Of the Feather",worldType:0,grid:[[0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[0,
0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1],[0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,1],[0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],[0,0,27,23,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,1,27,27,27,27],[0,0,27,27,27,27,27,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,14,17,0,0,0,17,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,27,27],[0,0,27,9,9,9,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,27,27],[0,0,27,0,0,0,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,14,0,0,0,0,0,0,0,27,27,23,23,
23],[0,0,27,23,23,23,27,23,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,8,0,17,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,27,9,0,0,0],[0,0,27,23,23,23,27,0,0,0,0,0,0,0,0,0,14,0,0,0,0,14,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,23,0,0,0,0],[0,0,27,9,9,9,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,23,0,0,5,0],[0,0,27,0,15,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,27,27,27,
17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,9,23,27,23,23,23,23],[0,0,27,23,23,23,27,0,0,0,0,0,0,0,0,0,0,0,0,27,23,23,23,23,27,0,23,27,0,27,0,0,27,23,23,23,23,27,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,14,27,27,23,27,27],[0,0,23,23,23,23,23,0,0,0,0,0,0,0,0,0,0,0,0,0,27,23,23,23,27,0,9,27,18,27,0,0,27,23,23,23,27,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,23,27,27],[4,0,23,23,23,23,23,0,0,0,0,0,0,0,0,0,0,0,0,14,27,23,23,23,27,27,0,27,18,27,0,27,27,23,23,23,27,0,0,
0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,27,9,27,27],[23,23,27,23,23,23,27,23,9,0,0,0,0,0,0,0,0,0,0,0,0,27,27,23,23,27,27,27,18,27,27,27,23,23,23,27,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,27,9,27,27],[0,0,27,23,23,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,23,23,23,23,18,23,23,23,23,27,27,0,0,0,0,0,0,0,0,0,17,17,0,0,14,0,0,0,0,0,0,0,0,17,0,0,0,27,27,9,27,27],[0,0,0,27,23,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,18,18,18,18,18,18,18,27,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,
0,0,0,0,0,0,17,0,0,0,27,27,0,27,27],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,18,18,18,18,18,27,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,27,0,27,27],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,27,18,18,18,27,0,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,27,1,27,27],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,27,27,9,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,8,0,0,0,0,14,17,0,0,0,27,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,27,27,27,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,1,1,1,1],[0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,23,27,0,27,23,27,0,0,0,0,0,0,0,14,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,27,9,0,9,27,9,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,27,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,17,17,
0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,1,1,1,1],[0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,17,17,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,27,1,1,1,1],[0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,27,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,17,0,0,2,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,27,0,0,17,0,0,1,1,1,1,1,1],[0,0,2,0,0,0,0,0,0,27,0,0,0,0,0,0,2,0,0,
0,0,0,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,2,0,0,0,0,27,0,0,0,0,0,1,1,1,1,1,1],[0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,27,0,0,0,0,27,0,0,0,0,2,1,1,1,1,1,1],[0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,27,0,0,0,0,2,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,2,0,0,0,0,27,0,0,0,0,0,27,0,0,0,0,27,0,0,0,2,1,1,1,1,1,1,1],[0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,27,0,0,0,0,27,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,27,0,0,0,0,27,0,0,0,0,0,27,0,0,
0,0,27,0,2,2,1,1,1,1,1,1,1,1],[0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,27,0,0,0,0,27,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,27,0,0,0,0,27,0,0,0,0,0,27,0,0,0,0,27,0,1,1,1,1,1,1,1,1,1,1],[0,0,27,0,0,0,0,0,0,27,0,0,0,0,0,0,27,0,0,0,0,27,0,0,0,0,27,0,0,0,27,0,0,27,0,0,0,0,27,0,0,0,0,27,0,0,0,0,0,27,0,0,0,0,27,0,1,1,1,1,1,1,1,1,1,1]],init:function(a){a.addEntity(new WorldText(1240,300,600,"WINGS allow Jimothy to DOUBLE-JUMP","25px " + FONT,[255,255,255,1],[255,255,255,1],1,!0,"center"))}}});
addBlock(function(){return{id:BLOCKS.length,name:"Start",hide:!0,ignoreCollisions:!0,redraws:!0,drawer:new Player,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.player.x=b+d/2;a.player.y=c+e}}});var Enemy=function(a,b){Mover.call(this,a,b);this.width=this.height=this.h=this.w=40;this.color="red";this.speed=3;this.groundAccel=5;this.mx=1;this.killPlayer=!0;this.isColliding=!1};$jscomp.inherits(Enemy,Mover);Enemy.prototype.playerCollision=function(a){return 0<a.vy&&a.y-a.vy<this.y?!0:!1};
Enemy.prototype.getHitByEntity=function(a){a.bounceOffEntity(this);this.h/=2};Enemy.prototype.onHitPlayer=function(a){};
Enemy.prototype.update=function(a,b){1==this.wallcolliding&&(this.mx*=-1);Mover.prototype.update.call(this,a,b);var c=this.getHitBox(),d=this.game.player.getHitBox();1==rectangleCollision(c,d)?!this.isColliding&&0>=this.game.player.bounceTimer&&(1==this.playerCollision(this.game.player)?(this.getHitByEntity(this.game.player),this.isColliding=!0):(this.onHitPlayer(this.game.player),this.game.player.getHitByEntity(this))):this.isColliding=!1};
Enemy.prototype.draw=function(a){Mover.prototype.draw.call(this,a)};
var PauseScene=function(a){Scene.call(this);this.prevScene=a;this.keyMap={32:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},13:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},27:{down:this.safeButtonCall(this,this.unpause)},87:{down:this.navigateUI.bind(this,0)},65:{down:this.navigateUI.bind(this,1)},83:{down:this.navigateUI.bind(this,2)},68:{down:this.navigateUI.bind(this,3)},38:{down:this.navigateUI.bind(this,0)},39:{down:this.navigateUI.bind(this,1)},40:{down:this.navigateUI.bind(this,
2)},37:{down:this.navigateUI.bind(this,3)},78:{down:function(){this.keys[67]&&DEBUG&&this.goToLevelEditor(a.levelIndex+1)}.bind(this)}};this.allowUIInput=!0;this.selectedButton=void 0;this.addPauseMenuGUI()};$jscomp.inherits(PauseScene,Scene);PauseScene.prototype.update=function(a){Scene.prototype.update.call(this,a);SOUNDMAP.music.lerpVolume(.2,.05)};PauseScene.prototype.unpause=function(){this.driver.setScene(this.prevScene)};
PauseScene.prototype.goToMainMenu=function(){this.allowUIInput=!1;this.startTransition(25,1,sceneTransition(this,MenuScene,!0))};PauseScene.prototype.goToLevelSelect=function(){this.allowUIInput=!1;this.startTransition(25,1,sceneTransition(this,LevelSelectScene,!0))};PauseScene.prototype.restartLevel=function(){this.allowUIInput=!1;this.prevScene.loadNewLevel();this.prevScene instanceof PigFunScene&&this.prevScene.spawnPig();this.unpause()};
PauseScene.prototype.goToLevelEditor=function(a){24==a&&(a=-1);a=new LevelEditorScene(a);this.driver.setScene(a)};PauseScene.prototype.draw=function(a){this.prevScene.draw(a);a.fillStyle="rgba(255,255,255,.7)";a.fillRect(0,0,a.width,a.height);this.deathCount.text=""+this.prevScene.levelDeaths;this.drawAllGUI(a);this.debug&&drawGrid(a);drawTransitionOverlay(this.overlayColor,a)};
PauseScene.prototype.addPauseMenuGUI=function(){var a=rectDimFromCenter(.5,.4,.2,.08),b=new Label(a[0],a[1],a[2],a[3],0,"Paused","60px " + FONT,"black","center");this.gui.push(b);a=rectDimFromCenter(.96,.95,.05,.08);this.deathCount=new Label(a[0],a[1],a[2],a[3],0,"X","60px " + FONT,"black","left");this.gui.push(this.deathCount);a=rectDimFromCenter(.82,.96,.2,.08);b=new Label(a[0],a[1],a[2],a[3],0,"Fails:","30px noteworthy","black","right");this.gui.push(b);a=rectDimFromCenter(.5,.55,.2,.08);
b=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.unpause.bind(this),"Resume","30px noteworthy","black","transparent","black",5,.08);this.gui.push(b);a=rectDimFromCenter(.5,.635,.2,.08);var c=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToLevelSelect.bind(this),"Level Select","30px noteworthy","black","transparent","black",5,.08);this.gui.push(c);a=rectDimFromCenter(.5,.55+.17,.2,.08);var d=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.restartLevel.bind(this),"Restart","30px noteworthy","black",
"transparent","black",5,.08);this.gui.push(d);a=rectDimFromCenter(.5,.805,.2,.08);a=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToMainMenu.bind(this),"Main Menu","30px noteworthy","black","transparent","black",5,.08);this.gui.push(a);this.selectedButton=b;this.selectedButton.selected=!0;b.setNeighbors([void 0,void 0,c,void 0]);c.setNeighbors([b,void 0,d,void 0]);d.setNeighbors([c,void 0,a,void 0]);a.setNeighbors([d,void 0,void 0,void 0]);this.buttons=getButtons(this.gui)};
var ColorLerpBox=function(a,b,c,d,e,f,g,h,k){GUIElement.call(this,a,b,c,d,e);this.activeColor=f;this.inactiveColor=g;this.changeDuration=h;this.colorTimer=(this.activated=k)?this.changeDuration:0};$jscomp.inherits(ColorLerpBox,GUIElement);ColorLerpBox.prototype.update=function(a){this.activated?(this.colorTimer+=a,this.colorTimer>this.changeDuration&&(this.colorTimer=this.changeDuration)):(this.colorTimer-=a,0>this.colorTimer&&(this.colorTimer=0))};
ColorLerpBox.prototype.draw=function(a){var b=colorLerp(this.inactiveColor,this.activeColor,this.colorTimer/this.changeDuration);a.fillStyle=makeColorStr(b);a.fillRect(this.x*a.width,this.y*a.height,this.w*a.width,this.h*a.height)};ColorLerpBox.prototype.setOptions=function(a,b,c){GUIElement.prototype.setOptions.call(this,!1,!1,c)};
addLevel(function(a){return{name:"Bridge",worldType:0,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,0,0,0,0,19,19,19,19,19,19,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,18,18,2,19,3,0,0,0,19,19,19,19,19,19,19],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,18,19,19,1,0,0,0,19,19,18,18,19,19,19],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,18,
18,18,1,0,0,0,19,19,19,18,19,18,19],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,1,1,0,0,0,0,0,19,18,19,19,19],[0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,30,0,0,0,0,0,2,0,0,0,0,30,0,0,0,0,0,2,0,0,30,0,0,2,0,1,1,1,0,0,0,0,0,0,0,18,18,0],[0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,2,1,1,1,0,0,0,0,0,0,0,18,18,5],[0,0,0,30,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,2,2,1,1,27,27,23,23,23,27,27,1,1,1,1],[0,0,0,0,0,0,
0,0,0,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,27,23,18,18,18,23,27,27,1,1,1],[0,0,0,1,1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,27,18,18,18,18,18,27,27,1,1,1],[0,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,27,18,18,18,18,18,27,27,1,1,1],[2,1,1,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,18,18,18,18,18,27,27,1,1,1],[1,1,27,27,
18,18,18,18,18,27,18,18,18,18,18,18,18,18,27,18,18,18,18,18,27,18,18,18,18,18,18,27,18,18,18,18,18,18,18,27,18,18,27,18,18,18,18,18,27,27,1,1,1],[1,27,27,27,18,18,18,18,18,27,18,18,18,18,18,18,18,27,27,27,18,18,18,18,27,18,18,18,18,18,18,27,18,18,18,18,18,18,18,27,18,18,27,18,18,9,18,18,27,27,1,1,1],[27,27,18,18,18,18,18,18,18,27,18,27,27,27,18,18,27,0,0,0,27,18,18,27,27,27,18,18,18,18,27,27,27,18,18,18,18,18,27,27,27,18,27,18,9,0,9,18,27,27,1,1,1],[27,18,18,18,9,18,18,18,18,27,27,0,0,0,27,27,0,0,
8,0,0,27,27,0,0,0,27,18,18,27,0,0,0,27,18,18,18,27,0,0,0,27,27,18,0,15,0,18,27,27,1,1,1],[18,18,18,9,0,9,18,18,18,27,0,0,8,0,0,0,0,0,0,0,0,0,0,0,8,0,0,27,27,0,0,8,0,0,27,27,27,0,0,8,0,0,27,9,9,9,9,9,27,27,1,1,1],[18,18,18,0,8,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,1,1,1],[18,18,18,0,0,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,1,1,1],[18,18,18,0,4,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,27,27,1,1,1],[27,27,27,27,27,27,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,14,0,0,0,27,27,1,1,1],[23,23,27,27,23,23,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,27,27,1,1,1],[23,23,27,27,23,23,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,1,1,1],[9,9,27,27,9,9,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,27,27,1,1,1],[9,9,27,27,9,9,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,1,1,1],[9,9,27,27,9,9,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,1,1,1],[0,0,27,27,0,0,27,27,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,27,27,1,1,1],[0,0,27,27,0,0,27,27,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,27,27,1,1,1],[1,1,1,1,1,1,1,1,0,0,
0,0,0,2,0,0,0,2,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,27,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,2,0,0,2,0,0,0,2,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,2,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,2,0,0,2,0,0,0,2,0,2,0,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,2,2,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,0,0,2,0,0,2,0,0,0,2,0,2,0,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,0,2,0,0,0,0,2,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,
1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});addBlock(function(){return{id:BLOCKS.length,name:"End",hide:!0,ignoreCollisions:!0,redraws:!0,drawer:new Pig,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.pig=new Pig(b+d/2,c+e);a.addEntity(a.pig)}}});
var TheByrd,Byrd=function(a,b){Enemy.call(this,a,b);this.w=60;this.h=50;this.width=this.w;this.height=this.h;this.width=this.w;this.height=this.h;this.color="black";this.jumpPower=10;this.killPlayer=!1;this.startY=b;this.isByrd=!0;this.color1="#200089";this.color2="#000";this.color3="#ca87fd";this.eyeColor="#fff";this.beakColor="#f7ff8c";TheByrd=this};$jscomp.inherits(Byrd,Enemy);Byrd.prototype.playJumpSound=function(){};Byrd.prototype.die=function(){};
Byrd.prototype.getHitByEntity=function(a){a.bounceOffEntity(this);this.height/=4;this.width*=.8};Byrd.prototype.update=function(a,b){this.y>this.startY&&0<=this.vy&&(this.jumpCount=0,this.jump());Enemy.prototype.update.call(this,a,b);this._angle=-this.angle};
Byrd.prototype.drawShape=function(a,b,c){a.strokeStyle="#000";a.lineWidth=5;a.strokeRect(-b/2,-c,b,c);this.drawWings(a,b,c,1);a.fillStyle=this.color1;a.fillRect(-b/2,-c,b,c);a.fillStyle=this.color2;a.fillRect(-b/2,-c,b/4,c);a.fillStyle=this.color3;a.fillRect(-b/10,.9*-c,b/8,c/10);this.drawWings(a,b,c);this.drawFace(a,b,c)};
Byrd.prototype.drawFace=function(a,b,c){a.fillStyle=this.eyeColor;a.fillRect(25,.95*-c,7,5);a.fillStyle=this.beakColor;a.beginPath();a.moveTo(22,.9*-c);a.lineTo(52,.9*-c+7.5);a.lineTo(22,.9*-c+15);a.fill();a.fillStyle=this.eyeColor;a.fillRect(10,.95*-c,7,5)};Byrd.prototype.drawWings=function(a,b,c,d){var e=.6*b,f=c/4;a.fillStyle=this.color1;a.beginPath();var g=this.vy/15;c=.8*-c-10*g;this.pathWingAtAngle(a,-b/2-e/2,c,e,f,.8*e,f/2,g);this.pathWingAtAngle(a,.4*b,c,e,f,.2*e,f/2,-g);d?a.stroke():a.fill()};
Byrd.prototype.pathWingAtAngle=function(a,b,c,d,e,f,g,h){a.save();a.translate(b+f,c+g);a.rotate(h);a.rect(-f,-g-10,d,e);a.rect(.8*-f,-g,.8*d,e);a.rect(.5*-f,-g+5,.5*d,e);a.restore()};var WinScene=function(){Scene.call(this);this.gui=[];this.keyMap={32:{down:this.start.bind(this)}}};$jscomp.inherits(WinScene,Scene);WinScene.prototype.start=function(){this.driver.setScene(new GameScene)};
WinScene.prototype.draw=function(a){a.fillStyle="black";a.textAlign="center";a.fillText("You Win! Press Space To Restart",a.width/2,a.height/2)};var ColoredBox=function(a,b,c,d,e,f,g,h){GUIElement.call(this,a,b,c,d,e);this.fillColor=f||"transparent";this.outlineColor=g||"transparent";this.lineWidth=h};$jscomp.inherits(ColoredBox,GUIElement);ColoredBox.prototype.update=function(a){};
ColoredBox.prototype.draw=function(a){a.fillStyle=this.fillColor;a.strokeStyle=this.outlineColor;a.lineWidth=this.lineWidth;var b=this.getPixelDimensions(a);a.fillRect(b[0],b[1],b[2],b[3]);a.strokeRect(b[0],b[1],b[2],b[3])};ColoredBox.prototype.setOptions=function(a,b,c){GUIElement.prototype.setOptions.call(this,!1,!1,c)};
addLevel(function(a){return{name:"feather-adventure",worldType:1,grid:[[0,0,0,0,0,0,0,0,0,0,19,19,19,0,0,0,0,0,0,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,19,19,19,19,0,0,0,0,0,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],[0,0,0,0,0,0,0,0,19,19,19,18,19,19,0,0,0,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,0,0,0],[0,0,0,0,0,0,0,0,19,19,18,27,19,19,0,0,0,19,19,19,19,19,19,19,19,19,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,27,0,0,0],[0,0,0,0,0,0,0,0,19,19,18,27,19,19,0,0,0,0,19,19,19,19,18,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,19,18,27,19,19,0,8,0,8,19,19,18,18,18,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,19,19,0,8,0,19,19,18,2,18,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,19,19,0,0,0,19,19,18,2,18,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,19,0,18,27,18,0,0,0,0,0,0,0,0,0,0,27,1,1,0,0,0,0,1,1,1,1,1,1,1,1,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,0,0,18,27,18,14,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,2,2,2,2,27,18,0,0,0,0,0,0,8,18,27,18,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,19,18,18,18,27,18,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,19,19,19,18,27,18,8,0,0,0,0,2,2,2,27,18,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,19,18,18,27,18,0,0,0,0,0,0,0,0,0,0,27,3,3,3,3,3,3,3,3,3,0,8,0,3,3,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,2,2,2,0,0,0,0,0,18,27,18,0,0,0,0,19,19,0,19,19,19,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,19,19,0,0,0,0,0,18,27,2,2,2,0,0,19,19,19,19,19,19,27,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,19,19,0,0,0,0,8,18,27,18,18,19,0,19,19,18,19,19,19,19,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,19,19,0,0,0,0,0,0,18,27,18,0,0,0,19,19,18,18,19,18,19,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,2,2,27,18,0,0,0,0,0,2,2,2,27,18,0,0,0,19,19,19,18,19,18,19,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,19,18,27,18,8,0,0,0,0,19,0,18,27,18,0,0,0,0,19,18,18,18,19,19,27,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,27,27,27,0,0,0],[0,0,0,0,0,0,0,0,0,19,18,27,18,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,18,19,19,19,19,27,3,3,3,0,0,0,3,3,3,3,3,3,3,3,27,27,27,0,0,0],[0,0,0,8,0,0,0,0,0,19,18,27,2,2,2,0,0,0,0,0,18,27,18,0,0,0,0,0,18,18,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,23,27,0,0,0],[0,0,0,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,0,0,18,23,18,0,0,0,0,0,18,18,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,18,23,0,0,0],[4,0,0,0,0,0,0,0,0,0,18,27,18,0,0,0,0,0,0,0,18,23,18,0,0,0,0,18,18,18,18,0,0,27,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,23,18,23,0,5,0],[1,1,1,1,0,0,0,9,9,9,23,27,23,9,9,9,9,9,9,9,23,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,18,18,18,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,18,18,18,18,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,
1,1,1,1,1,18,18,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{id:BLOCKS.length,name:"Enemy",hide:!0,ignoreCollisions:!0,drawer:new Enemy,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new Enemy(b+d/2,c+e))}}});var Powerup=function(a,b){this.x=a;this.y=b;this.h=this.w=70;this.color="black";this.jumpPower=10;this.killPlayer=!1;this.power=this.my=this.mx=0;this.startY=this.y;this.reset=this.reset.bind(this);this.on=!0;this.offset=0};
Powerup.prototype.update=function(a,b){if(this.on){var c=this.getHitBox(),d=this.game.player,e=d.getHitBox();rectangleCollision(c,e)&&this.canBeCollected()&&(this.die(),this.onHitPlayer(d));this.offset=this.on?2*Math.cos(b*Math.PI/20):0}};Powerup.prototype.canBeCollected=function(){return!0};Powerup.prototype.draw=function(a){a.save();this.on||(a.globalAlpha=.5);a.translate(this.x,this.y);a.translate(0,this.offset);this.drawShape(a,this.w,this.h);a.restore()};
Powerup.prototype.drawShape=function(a,b,c){a.fillStyle=this.color;a.fillRect(-b/2,-c,b,c)};Powerup.prototype.onHitPlayer=function(a){PLAYER_ABILITIES[this.power](a);SOUNDMAP.powerup.play();a.game.screenShakeLevel=.4;a.game.frameStop=2;for(a=0;10>a;a++)this.game.addEntity(new FallingParticle(this.x,this.y,10,10,5*Math.random()-2,5*Math.random()-2-10,30,this.color1))};Powerup.prototype.getHitBox=function(){return{x:this.x-.5*this.w,y:this.y-this.h,w:this.w,h:this.h}};
Powerup.prototype.reset=function(){this.on=!0;this.color="black"};Powerup.prototype.die=function(){this.on=!1;this.color="rgba(150,150,150,.5)";this.game.driver.setTimeout(this.reset,60)};var LevelTesterScene=function(a,b){GameScene.call(this,a,void 0,!1);this.prevScene=b;this.keyMap[27]={down:this.back.bind(this)};this.transitionDuration=1;this.updateTransition()};$jscomp.inherits(LevelTesterScene,GameScene);LevelTesterScene.prototype.back=function(){this.driver.setScene(this.prevScene)};
LevelTesterScene.prototype.win=function(){this.back()};var ArrowSelector=function(a,b,c,d,e,f,g,h,k,l,m,n){Button.call(this,a,b,c,d,e,void 0);this.fillColor=k;this.outlineColor=l;this.lineWidth=m;this.moveSpeed=h;this.flipped=n;this.moveDistance=g;this.onRelease=function(){this.x=this.flipped?this.originalDimension[0]-this.moveDistance:this.originalDimension[0]+this.moveDistance;f()}.bind(this)};$jscomp.inherits(ArrowSelector,Button);
ArrowSelector.prototype.update=function(a){this.moveToPosition(a,this.originalDimension[0])};
ArrowSelector.prototype.draw=function(a){a.fillStyle=this.fillColor;a.strokeStyle=this.outlineColor;a.lineWidth=this.lineWidth;var b=[void 0,void 0,void 0];this.flipped?(b[0]=[this.x+this.w,this.y],b[1]=[this.x+this.w,this.y+this.h],b[2]=[this.x,this.y+this.h/2]):(b[0]=[this.x,this.y],b[1]=[this.x,this.y+this.h],b[2]=[this.x+this.w,this.y+this.h/2]);a.beginPath();a.moveTo(b[0][0]*a.width,b[0][1]*a.height);a.lineTo(b[1][0]*a.width,b[1][1]*a.height);a.lineTo(b[2][0]*a.width,b[2][1]*a.height);a.lineTo(b[0][0]*
a.width,b[0][1]*a.height);a.fill();a.stroke()};ArrowSelector.prototype.getBounds=function(a){for(var b=a[0][0],c=a[0][0],d=a[0][1],e=a[0][1],f=0;f<a.length;f++)b=Math.min(b,a[f][0]),c=Math.max(c,a[f][0]),d=Math.min(d,a[f][1]),e=Math.max(e,a[f][1]);return[c-b,e-d]};ArrowSelector.prototype.moveToPosition=function(a,b){this.x+=a*(b-this.x)*this.moveSpeed};ArrowSelector.prototype.displaceArrow=function(){this.x=this.flipped?this.originalDimension[0]-this.moveDistance:this.originalDimension[0]+this.moveDistance};
WORLDTYPE=1;addBlock(function(){return{id:BLOCKS.length,name:"WallJump",hide:!0,ignoreCollisions:!0,draw:drawEntity,drawer:new wallJump,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new wallJump(b+d/2,c))}}});var doubleJump=function(a,b){Powerup.call(this,a,b);this.h=this.w=40;this.color="black";this.jumpPower=0;this.killPlayer=!1;this.my=this.mx=0;this.power=2;this.color1="#000";this.angle=Math.PI/4};$jscomp.inherits(doubleJump,Powerup);
doubleJump.prototype.canBeCollected=function(){var a=this.game.player;return 1==a.maxJumps||1<a.jumpCount};doubleJump.prototype.drawShape=function(a,b,c){a.strokeStyle="#fff";a.lineWidth=7;b*=2;this.drawWings(a,b,c,1);this.drawWings(a,b,c)};doubleJump.prototype.pathWingAtAngle=function(a,b,c,d,e,f,g,h){var k=d/3;a.save();a.translate(b+f,c+g);a.rotate(h);a.rect(-f,-g-10,d,e);a.rect(.8*-f-k,-g,.8*d+k,e);a.rect(.5*-f,-g+5,.5*d,e);a.restore()};
doubleJump.prototype.drawWings=function(a,b,c,d){var e=.6*b,f=c/4;a.fillStyle=this.color1;a.beginPath();var g=this.angle;this.pathWingAtAngle(a,-b/2+e/2,.4*-c-10*g,e,f,.2*e,f/2,-g);d?a.stroke():a.fill()};
var LevelEditorScene=function(a){Scene.call(this,!1);this.editLevel=a;this.zoom=1;switch(this.editLevel){case -2:this.world=new WorldDefault(48,24);break;case -1:a=new PigFunScene;this.world=new WorldFromLevel(a.levels[0]);break;case 0:this.world=new WorldDefault(48,24);var b=this.load();this.world.h=b.length;this.world.w=b[0].length;break;default:a=createLevels(),this.world=new WorldFromLevel(a[this.editLevel-1])}b&&(this.world.world=b);this.grid=this.world.world;this.camera={x:0,y:0,offset:{x:0,
y:0}};this.keyMap={32:{down:this.startDragging.bind(this),held:this.drag.bind(this)},75:{down:this.runTest.bind(this)},80:{down:this.printLevel.bind(this)},83:{down:this.cycleBlockBackwards.bind(this)},87:{down:this.cycleBlock.bind(this)},69:{down:this.cycleAbility.bind(this)},84:{down:this.zoomIn.bind(this)},71:{down:this.zoomOut.bind(this)},73:{down:this.growi.bind(this)},74:{down:this.growj.bind(this)},66:{down:this.resetCameraPosition.bind(this)},65:{down:this.pickBlockFromLevel.bind(this)},82:{down:this.gridScrollUp.bind(this)},
70:{down:this.gridScrollDown.bind(this)},68:{down:this.selectAir.bind(this)},72:{down:this.toggleCommandList.bind(this)},90:{down:this.selectFromQuickSelect.bind(this,0)},88:{down:this.selectFromQuickSelect.bind(this,1)},67:{down:this.selectFromQuickSelect.bind(this,2)},86:{down:this.selectFromQuickSelect.bind(this,3)},49:{down:this.selectFromBar.bind(this,0)},50:{down:this.selectFromBar.bind(this,1)},51:{down:this.selectFromBar.bind(this,2)},52:{down:this.selectFromBar.bind(this,3)},53:{down:this.selectFromBar.bind(this,
4)},54:{down:this.selectFromBar.bind(this,5)},55:{down:this.selectFromBar.bind(this,6)}};this.bottomBarHeight=.2;this.showCommands=!1;this.dragPivot={x:0,y:0};this.clickDragPivot={x:0,y:0};this.mousePoint={x:0,y:0};this.currentBlock=1;this.playerAbility=[0,0];this.rowLength=7;this.rowCount=2;this.buttonGrid=Array(this.rowLength);this.quickSelect=[];this.resetCameraPosition();this.addLevelEditorGUI()};$jscomp.inherits(LevelEditorScene,Scene);
LevelEditorScene.prototype.resetCameraPosition=function(){this.camera.x=this.world.w*this.world.s/2*this.zoom;this.camera.y=this.world.h*this.world.s/2*this.zoom};LevelEditorScene.prototype.zoomIn=function(){this.zoom+=.1;2<this.zoom?this.zoom=2:(this.camera.x+=this.world.w*this.world.s*.1/2,this.camera.y+=this.world.h*this.world.s*.1/2)};
LevelEditorScene.prototype.zoomOut=function(){this.zoom-=.1;.1>this.zoom?this.zoom=.1:(this.camera.x-=this.world.w*this.world.s*.1/2,this.camera.y-=this.world.h*this.world.s*.1/2)};LevelEditorScene.prototype.growi=function(){if(this.keys[16])return this.extendLeft();for(var a=0;a<this.grid.length;a++)this.grid[a].push(0);this.world.w++};LevelEditorScene.prototype.growj=function(){if(this.keys[16])return this.extendTop();for(var a=[],b=0;b<this.grid[0].length;b++)a.push(0);this.grid.push(a);this.world.h++};
LevelEditorScene.prototype.extendTop=function(){for(var a=[],b=0;b<this.grid[0].length;b++)a.push(0);this.grid.unshift(a);this.world.h++;this.world.forceRedraw()};LevelEditorScene.prototype.extendLeft=function(){for(var a=0;a<this.grid.length;a++)this.grid[a].unshift(0);this.world.w++;this.world.forceRedraw()};LevelEditorScene.prototype.shrinkj=function(){this.grid.splice(this.grid.length-1,1);this.world.h--};LevelEditorScene.prototype.backToSelect=function(){var a=new LevelEditorSelectScene;this.driver.setScene(a)};
LevelEditorScene.prototype.cycleBlockBackwards=function(){var a=CELLMAP.length;this.currentBlock=(this.currentBlock-1+a)%a};LevelEditorScene.prototype.cycleBlock=function(){this.currentBlock=(this.currentBlock+1)%CELLMAP.length};LevelEditorScene.prototype.cycleAbility=function(){0==this.playerAbility[1]?this.playerAbility[1]=1:this.playerAbility=0==this.playerAbility[0]?[1,0]:[0,0]};
LevelEditorScene.prototype.getLevelString=function(){for(var a="[\n",b=0;b<this.grid.length;b++){a+="[";for(var c=0;c<this.grid[b].length;c++){var d=this.grid[b][c];10>d&&(d="0"+d);a+=d+","}a+="],\n"}return a+"]"};LevelEditorScene.prototype.save=function(){var a=this.getLevelString();localStorage&&localStorage.setItem&&localStorage.setItem("currentLevel",a)};
LevelEditorScene.prototype.load=function(){if(!localStorage||!localStorage.getItem)return null;var a=localStorage.getItem("currentLevel");if(!a)return!1;for(var b=[],c,d="",e=1;e<a.length-1;e++){var f=a[e];switch(f){case "[":c=[];break;case "]":b.push(c);break;case ",":""!=d&&(d=parseInt(d,10),CELLMAP[d]||(d=0),c.push(d),d="");break;default:d+=f}}return b};LevelEditorScene.prototype.printLevel=function(){var a=this.getLevelString();console.log(a)};
LevelEditorScene.prototype.getLevel=function(){return{name:"test1",abilities:this.playerAbility,modifyPlayer:function(a){for(var b=0;b<this.abilities.length;b++)if(1==this.abilities[b])PLAYER_ABILITIES[b+1](a)},grid:this.grid}};LevelEditorScene.prototype.runTest=function(){var a=new LevelTesterScene(this.getLevel(),this);this.driver.setScene(a)};LevelEditorScene.prototype.startDragging=function(){this.dragPivot.x=this.driver.mouse.x;this.dragPivot.y=this.driver.mouse.y};
LevelEditorScene.prototype.drag=function(){var a=this.driver.mouse.x-this.dragPivot.x,b=this.driver.mouse.y-this.dragPivot.y;this.camera.x-=a;this.camera.y-=b;this.dragPivot.x+=a;this.dragPivot.y+=b};
LevelEditorScene.prototype.mousedown=function(a,b){!pointContainsGUI(getPercentPoint(a),this.gui)&&canvas.height-b.y>this.bottomBarHeight*canvas.height?(this.clickDragPivot={x:0,y:0},this.clickDragPivot.x=b.x/this.zoom,this.clickDragPivot.y=b.y/this.zoom):this.clickDragPivot=void 0;Scene.prototype.mousedown.call(this,a,b)};
LevelEditorScene.prototype.mouseup=function(a,b){if(canvas.height-b.y>this.bottomBarHeight*canvas.height&&void 0!=this.clickDragPivot){var c=this.camera,d=b.x/this.zoom+(c.x-c.offset.x)/this.zoom,e=b.y/this.zoom+(c.y-c.offset.y)/this.zoom,f=Math.floor(d/this.world.s),g=Math.floor(e/this.world.s);d=this.clickDragPivot.x+(c.x-c.offset.x)/this.zoom;e=this.clickDragPivot.y+(c.y-c.offset.y)/this.zoom;c=Math.floor(d/this.world.s);e=Math.floor(e/this.world.s);d=1-2*(c<f);for(var h=1-2*(e<g);f!=c+d;f+=d)for(var k=
g;k!=e+h;k+=h)this.world.oob(f,k)||(this.grid[k][f]=this.currentBlock);this.save();this.world.forceRedraw()}Scene.prototype.mouseup.call(this,a,b)};LevelEditorScene.prototype.mousemove=function(a,b){Scene.prototype.mousemove.call(this,a);this.mousePoint.x=b.x;this.mousePoint.y=b.y};LevelEditorScene.prototype.update=function(a){Scene.prototype.update.call(this,a)};
LevelEditorScene.prototype.addLevelEditorGUI=function(){this.buildButtonGrid();this.buildQuickSelect();var a=rectDimFromCenter(.945,.75,.07,.08);a=new TextButton(a[0],a[1],a[2],a[3],0,this.save.bind(this),"Save","30px " + FONT,"black","rgba(255,255,255,0.75)","black",5);this.gui.push(a);this.buttons=getButtons(this.gui)};
LevelEditorScene.prototype.buildButtonGrid=function(){for(var a,b=[.05,.85],c=0;c<this.rowCount;c++){this.buttonGrid[c]=[];for(var d=0;d<this.rowLength;d++){a=rectDimFromCenter(b[0]+d/this.rowLength*.7,b[1]+c/this.rowCount*.2,1/this.rowLength*.7-.02,1/this.rowCount*.2-.02);var e=new BlockButton(a[0],a[1],a[2],a[3],0,void 0,c*this.rowLength+d);e.onRelease=this.selectBlock.bind(this,e);this.buttonGrid[c].push(e);this.gui.push(e);0==c&&d<this.rowLength&&(a=new Label(a[0]+.043,a[1]+.036,.05,.05,0,""+
(d+1),"20px " + FONT,"black","center"),this.gui.push(a))}}};
LevelEditorScene.prototype.buildQuickSelect=function(){var a=rectDimFromCenter(.78,.85,.08,.09);var b=new BlockButton(a[0],a[1],a[2],a[3],0,void 0,0);b.onRelease=this.quickSelectClick.bind(this,b);this.quickSelect.push(b);this.gui.push(b);a=new Label(a[0]+.043,a[1]+.045,.05,.05,0,"Z","20px " + FONT,"black","center");this.gui.push(a);a=rectDimFromCenter(.86,.85,.08,.09);b=new BlockButton(a[0],a[1],a[2],a[3],0,void 0,0);b.onRelease=this.quickSelectClick.bind(this,b);this.quickSelect.push(b);this.gui.push(b);
a=new Label(a[0]+.043,a[1]+.045,.05,.05,0,"X","20px " + FONT,"black","center");this.gui.push(a);a=rectDimFromCenter(.78,.94,.08,.09);b=new BlockButton(a[0],a[1],a[2],a[3],0,void 0,0);b.onRelease=this.quickSelectClick.bind(this,b);this.quickSelect.push(b);this.gui.push(b);a=new Label(a[0]+.043,a[1]+.045,.05,.05,0,"C","20px " + FONT,"black","center");this.gui.push(a);a=rectDimFromCenter(.86,.94,.08,.09);b=new BlockButton(a[0],a[1],a[2],a[3],0,void 0,0);b.onRelease=this.quickSelectClick.bind(this,
b);this.quickSelect.push(b);this.gui.push(b);a=new Label(a[0]+.043,a[1]+.045,.05,.05,0,"V","20px " + FONT,"black","center");this.gui.push(a);a=rectDimFromCenter(.945,.94,.06,.08);b=new ColoredBox(a[0],a[1],a[2],a[3],0,"white","black",5);this.gui.push(b);a=new TextButton(a[0],a[1],a[2],a[3],0,this.resetQuickSelect.bind(this),"X","30px " + FONT,"red","transparent","transparent","3");this.gui.push(a)};
LevelEditorScene.prototype.quickSelectClick=function(a){0==a.blockID?a.blockID=this.currentBlock:this.selectBlock(a)};LevelEditorScene.prototype.selectFromQuickSelect=function(a){this.currentBlock=this.quickSelect[a].blockID};LevelEditorScene.prototype.selectFromBar=function(a){this.currentBlock=this.buttonGrid[0][a].blockID};
LevelEditorScene.prototype.selectBlock=function(a){this.currentBlock=a.blockID;this.currentBlock>=CELLMAP.length-1&&(this.currentBlock=CELLMAP.length-1);0>this.currentBlock&&(this.currentBlock=0)};LevelEditorScene.prototype.resetQuickSelect=function(){for(var a=0;a<this.quickSelect.length;a++)this.quickSelect[a].blockID=0};
LevelEditorScene.prototype.gridScrollUp=function(){if(this.buttonGrid[0][0].blockID>=this.rowLength)for(var a=0;a<this.rowCount;a++)for(var b=0;b<this.rowLength;b++)this.buttonGrid[a][b].blockID-=this.rowLength};LevelEditorScene.prototype.gridScrollDown=function(){if(this.buttonGrid[0][0].blockID<=CELLMAP.length-7)for(var a=0;a<this.rowCount;a++)for(var b=0;b<this.rowLength;b++)this.buttonGrid[a][b].blockID+=this.rowLength};
LevelEditorScene.prototype.drawBlockAtCursor=function(a){var b={getCell:function(){return!0}};this.currentBlock<CELLMAP.length&&0<this.currentBlock&&CELLMAP[this.currentBlock].draw&&CELLMAP[this.currentBlock].draw(a,this.mousePoint.x+20,this.mousePoint.y+20,30,30,b,0,0);a.strokeStyle="black";a.lineWidth=3;a.strokeRect(this.mousePoint.x+20,this.mousePoint.y+20,30,30);if(this.driver.mouse.held&&this.clickDragPivot){b=Math.floor((this.clickDragPivot.x-this.driver.mouse.x)/this.zoom/this.world.s);var c=
Math.floor((this.clickDragPivot.y-this.driver.mouse.y)/this.zoom/this.world.s);b=Math.abs(b);c=Math.abs(c);a.fillText(b+","+c,this.mousePoint.x+60,this.mousePoint.y+60)}};LevelEditorScene.prototype.selectAir=function(){this.currentBlock=0};LevelEditorScene.prototype.toggleCommandList=function(){this.showCommands=!this.showCommands};
LevelEditorScene.prototype.pickBlockFromLevel=function(){var a=this.camera,b=Math.floor((this.mousePoint.x/this.zoom+(a.x-a.offset.x)/this.zoom)/this.world.s);a=Math.floor((this.mousePoint.y/this.zoom+(a.y-a.offset.y)/this.zoom)/this.world.s);b>this.world.w||0>b||a>this.world.h||0>a||(this.currentBlock=this.grid[a][b])};
LevelEditorScene.prototype.draw=function(a){var b=this.camera,c=this.world;b.offset={x:a.width/2,y:a.height/2};var d=-a.width/2+c.s*this.zoom,e=a.width/2+(c.w-1)*c.s*this.zoom,f=-a.height/2+c.s*this.zoom,g=a.height/2+(c.h-1)*c.s*this.zoom;b.x<d&&(b.x=d);b.x>e&&(b.x=e);b.y>g&&(b.y=g);b.y<f&&(b.y=f);b=this.camera;a.save();a.translate(a.width/2,a.height/2);a.translate(-Math.floor(b.x),-Math.floor(b.y));a.scale(this.zoom,this.zoom);a.strokeStyle="black";a.lineWidth=10;a.strokeRect(0,0,c.w*c.s,c.h*c.s);
this.world.draw(a,!0);a.restore();b=this.driver.mouse;a.fillStyle="rgba(255,255,255,0.85)";a.beginPath();a.rect(0,a.height-a.height/5,a.width,a.height/5);a.fill();a.stroke();a.fillStyle="#000";a.fillText("["+CELLMAP[this.currentBlock].name+"]",a.width/5,a.height/1.1-100);a.fillText("[Wall Jump: "+this.playerAbility[0]+"   Double Jump: "+this.playerAbility[1]+"]",a.width/1.5,a.height/1.1-100);a.font="20px " + FONT;a.textAlign="left";if(this.showCommands)for(c="[H] - Toggle Command List;[W] - Cycle block forward;[S] - Cycle block backward;[E] - Cycle abilities;[A] - Block Picker;[R] - Scroll Block Select Up;[F] - Scroll Black Select Down;[T] - Zoom In;[G] - Zoom Out;[D] - Select Erase (Air);[1/2/3/4] - Quick select;[K] - Test Level;[B] - Reset Camera;[I] - Grow I;[J] - Grow J;[P] - Print as String".split(";"),
d=0;d<c.length;d++)a.fillStyle="rgba(255,255,255,0.75)",a.fillRect(.02*a.width,(.1+.04*d-.02)*a.height,300,.04*a.height),a.fillStyle="black",a.fillText(c[d],.02*a.width,(.1+.04*d)*a.height,1600);else a.fillText("[H] - Help",.02*a.width,.1*a.height,1600);a.textAlign="center";this.drawAllGUI(a);this.drawBlockAtCursor(a);b.held&&void 0!=this.clickDragPivot&&(a.strokeStyle="rgba(0,100,0,1)",a.fillStyle="rgba(0,255,0,.5)",a.beginPath(),c=this.clickDragPivot.x*this.zoom,d=this.clickDragPivot.y*this.zoom,
a.rect(c,d,-c+b.x,-d+b.y),a.fill(),a.stroke())};var BlockButton=function(a,b,c,d,e,f,g){Button.call(this,a,b,c,d,e,f);this.blockID=g;this.world={getCell:function(){return!0}};this.j=this.i=0};$jscomp.inherits(BlockButton,Button);
BlockButton.prototype.draw=function(a){var b=this.getPixelDimensions(a);if(0<=this.blockID&&this.blockID<CELLMAP.length){var c=CELLMAP[this.blockID];c.draw&&c.draw(a,b[0],b[1],b[2],b[3],this.world,this.i,this.j)}a.strokeStyle="black";this.held&&(a.strokeStyle="gray");a.lineWidth=5;a.strokeRect(b[0],b[1],b[2],b[3])};
addLevel(function(a){return{name:"Woof Pen",worldType:1,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,18,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0],
[0,0,0,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,18,19,19,19,19,18,18,19,19,19,18,18,19,0,0,0,0,0,0,0,0],[0,0,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,18,19,18,18,19,19,19,18,18,19,18,18,19,19,0,0,0,0,0,0,0,0],[0,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,18,19,19,19,18,19,19,19,18,18,18,18,19,0,0,0,0,0,0,0,0,0],[19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,19,19,19,19,19,19,18,19,19,19,19,18,18,18,19,18,19,19,18,18,19,19,19,0,0,0,0,0,
0,0,0,0],[19,19,18,18,19,19,18,19,19,19,0,0,0,0,0,0,19,19,19,19,18,18,19,19,19,19,19,19,18,18,18,18,19,18,18,18,19,19,0,0,0,0,0,0,0,0,0,0],[19,19,19,18,18,19,18,18,18,19,0,0,0,0,0,0,19,19,19,19,19,18,19,19,18,19,19,19,18,18,18,19,19,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0],[19,19,19,19,18,18,18,18,19,19,0,0,0,0,0,0,19,19,18,18,18,18,19,18,19,19,19,18,18,18,19,19,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0],[0,19,18,19,18,18,18,19,19,0,0,0,0,0,0,0,0,19,19,19,18,18,18,19,19,19,19,19,18,18,18,0,0,18,18,18,0,0,0,0,
0,0,0,0,0,0,0,0],[0,19,19,18,18,18,19,19,0,0,0,0,0,0,0,0,0,0,19,19,18,18,19,19,18,19,18,18,27,18,18,0,0,18,18,18,18,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,19,18,18,19,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,19,18,19,19,19,27,18,18,0,18,18,18,18,18,16,0,1,1,0,0,0,0,0,0,0],[0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,19,19,0,19,27,23,23,9,1,1,1,1,1,1,1,1,1,1,0,0,5,0,0,0],[0,0,0,0,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,19,0,0,0,18,18,18,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,18,18,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,18,18,18,19,0,0,18,18,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[4,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,9,23,23,18,18,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,18,18,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,
1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,0,0,16,0,0,0,0,0,0,18,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});addBlock(function(){return{id:BLOCKS.length,name:"DoubleJump",hide:!0,ignoreCollisions:!0,drawer:new doubleJump,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new doubleJump(b+d/2,c+e))}}});
var wallJump=function(a,b){Powerup.call(this,a,b+30);this.h=this.w=30;this.color="black";this.jumpPower=0;this.killPlayer=!1;this.my=this.mx=0;this.power=1;this.color1="#741";this.color2="#520";this.color3="#411"};$jscomp.inherits(wallJump,Powerup);wallJump.prototype.drawShape=function(a,b,c){a.strokeStyle="#fff";a.lineWidth=7;this.drawAcorn(a,b,c,1);this.drawAcorn(a,b,c)};
wallJump.prototype.drawAcorn=function(a,b,c,d){c*=1;a.doRect=d?a.strokeRect:a.fillRect;a.fillStyle=this.color1;a.doRect(-b/2,-c,b,c);a.fillStyle=this.color2;a.doRect(-b/2,-c,b/2,c);a.fillStyle=this.color3;d=b/10;var e=c/3,f=b/8;a.doRect(-b/2-d,-c,b+2*d,e);a.doRect(-f,-c-e,2*f,e);a.fillStyle="#fff";a.doRect(.1*-b,.6*-c,.5*b,.15*c)};wallJump.prototype.die=function(){this.shouldDelete=!0};
var SELECTWORLD=0,SELECTLEVEL=1,LevelSelectScene=function(a){Scene.call(this,a);this.keyMap={32:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},13:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},27:{down:this.safeButtonCall(this,this.handleEscape)},87:{down:this.navigateLevelSelect.bind(this,0)},68:{down:this.navigateLevelSelect.bind(this,1)},83:{down:this.navigateLevelSelect.bind(this,2)},65:{down:this.navigateLevelSelect.bind(this,3)},38:{down:this.navigateLevelSelect.bind(this,
0)},39:{down:this.navigateLevelSelect.bind(this,1)},40:{down:this.navigateLevelSelect.bind(this,2)},37:{down:this.navigateLevelSelect.bind(this,3)}};this.levels=createLevels();this.levelsInWorld=[0,0,0];for(a=0;a<this.levels.length;a+=1)this.levelsInWorld[this.levels[a].worldType||0]+=1;this.menuState=SELECTWORLD;this.levelIndex=this.worldSelected=0;this.buttonsInRow=6;this.buttonRow=[];this.worldButtons=[];this.worldLabels=[];this.allowUIInput=!0;this.backWall=[];this.addLevelSelectGUI();this.backgroundList=
[[],[],[]];this.createBackgrounds()};$jscomp.inherits(LevelSelectScene,Scene);LevelSelectScene.prototype.update=function(a){Scene.prototype.update.call(this,a);this.updateBackgrounds(a);if(this.menuState==SELECTLEVEL){a=this.levelIndex=this.selectedButton.value;for(var b=0;b<this.worldSelected;b++)a+=this.levelsInWorld[b];this.levelName.text=this.levels[a]?""+this.levels[a].name:""}};
LevelSelectScene.prototype.draw=function(a){this.drawBackgrounds(a);a.strokeStyle="black";this.menuState==SELECTWORLD?a.lineWidth=3:this.menuState==SELECTLEVEL&&(a.lineWidth=10);a.strokeRect(0,this.worldSelected*a.height/3,a.width,a.height/3);this.drawGrayScale();this.drawAllGUI(a);drawTransitionOverlay(this.overlayColor,a);this.debug&&drawGrid(a)};
LevelSelectScene.prototype.drawGrayScale=function(){canvas.save();canvas.globalCompositeOperation="hue";canvas.fillStyle="white";for(var a=0;3>a;a+=1){var b=this.backgroundList[a][0];canvas.globalAlpha=b.colorTimer/b.colorChangeDuration;canvas.fillRect(0,a*canvas.height/3,canvas.width,canvas.height/3)}canvas.restore()};LevelSelectScene.prototype.updateBackgrounds=function(a){for(var b=0;b<this.backWall.length;b++)this.backWall[b].update(a);for(b=0;b<this.backgroundList.length;b++)for(var c=0;c<this.backgroundList[b].length;c++)this.backgroundList[b][c].update(a)};
LevelSelectScene.prototype.drawBackgrounds=function(a){for(var b=0;b<this.backWall.length;b++)this.backWall[b].draw(a);for(b=0;b<this.backgroundList.length;b++)for(var c=0;c<this.backgroundList[b].length;c++)this.backgroundList[b][c].draw(a)};
LevelSelectScene.prototype.createBackgrounds=function(){var a=.55,b=createHillBackground(6E3,"rgb(10,92,31)",!1),c=new ScrollingBackgroundObject(b,a,.35,3,0,-80,!1,!0);b=new ScrollingBackgroundObject(b,a,.35,3,b.width,-80,!0,!0);this.backgroundList[0].push(c);this.backgroundList[0].push(b);b=createHillBackground(6E3,"rgb(11,102,35)",!1);c=new ScrollingBackgroundObject(b,a,.2,5,0,37,!1,!0);b=new ScrollingBackgroundObject(b,a,.2,5,b.width,37,!0,!0);this.backgroundList[0].push(c);this.backgroundList[0].push(b);
a=.7;b=createForrestBackground(60,"0b6623",!1);c=new ScrollingBackgroundObject(b,a,.35,3,0,120,!1,!1);b=new ScrollingBackgroundObject(b,a,.35,3,b.width,120,!0,!1);this.backgroundList[1].push(c);this.backgroundList[1].push(b);b=createForrestBackground(100,"0b6623",!1);c=new ScrollingBackgroundObject(b,a,.2,5,0,237,!1,!1);b=new ScrollingBackgroundObject(b,a,.2,5,b.width,237,!0,!1);this.backgroundList[1].push(c);this.backgroundList[1].push(b);b=createSpikeBackground(60,"#222",!1);c=new ScrollingBackgroundObject(b,
a,.35,3,0,320,!1,!1);b=new ScrollingBackgroundObject(b,a,.35,3,b.width,320,!0,!1);this.backgroundList[2].push(c);this.backgroundList[2].push(b);b=createSpikeBackground(100,"#222",!1);c=new ScrollingBackgroundObject(b,a,.2,5,0,437,!1,!1);b=new ScrollingBackgroundObject(b,a,.2,5,b.width,437,!0,!1);this.backgroundList[2].push(c);this.backgroundList[2].push(b)};
LevelSelectScene.prototype.addLevelSelectGUI=function(){var a=rectDimFromCenter(.5,.06,.3,.1),b=new Label(a[0],a[1],a[2],a[3],3,"Select Level","50px " + FONT,"white","center");this.gui.push(b);b=new ColorLerpBox(0,0,1,.333,3,[135,206,235,255],[128,128,128,255],25,!0);this.backWall.push(b);b=new ColorLerpBox(0,.3333,1,.333,3,[135,206,235,255],[128,128,128,255],25,!1);this.backWall.push(b);b=new ColorLerpBox(0,.6666,1,.333,3,[130,56,48,255],[128,128,128,255],25,!1);this.backWall.push(b);a=rectDimFromCenter(.1,
.09,.2,.12);b=new Label(a[0],a[1],a[2],a[3],3,"World 1","40px " + FONT,"white","center");b.setVisibility(!0);this.gui.push(b);this.worldLabels.push(b);a=rectDimFromCenter(.1,.09+.333,.2,.12);b=new Label(a[0],a[1],a[2],a[3],3,"World 2","40px " + FONT,"white","center");b.setVisibility(!1);this.gui.push(b);this.worldLabels.push(b);a=rectDimFromCenter(.1,.756,.2,.12);b=new Label(a[0],a[1],a[2],a[3],3,"World 3","40px " + FONT,"white","center");b.setVisibility(!1);this.gui.push(b);this.worldLabels.push(b);
b=new Button(0,0,1,1/3,0,this.handleWorldClick.bind(this,0));this.gui.push(b);this.worldButtons.push(b);a=new Button(0,.333,1,1/3,1,this.handleWorldClick.bind(this,1));this.gui.push(a);this.worldButtons.push(a);var c=new Button(0,.666,1,1/3,2,this.handleWorldClick.bind(this,2));this.gui.push(c);this.worldButtons.push(c);b.setNeighbors([void 0,void 0,a,void 0]);a.setNeighbors([b,void 0,c,void 0]);c.setNeighbors([a,void 0,void 0,void 0]);this.buildButtonRow();a=rectDimFromCenter(.8,.532,.05,.08);this.rightArrow=
new ArrowSelector(a[0],a[1],a[2],a[3],5,this.incrementLevels.bind(this),.05,.4,"white","black",5,!1);this.rightArrow.selectable=!1;this.rightArrow.setVisibility(!1);this.gui.push(this.rightArrow);a=rectDimFromCenter(.2,.532,.05,.08);this.leftArrow=new ArrowSelector(a[0],a[1],a[2],a[3],5,this.decrementLevels.bind(this),.05,.4,"white","black",5,!0);this.leftArrow.selectable=!1;this.leftArrow.setVisibility(!1);this.gui.push(this.leftArrow);a=rectDimFromCenter(.5,.62,.4,.1);this.levelName=new Label(a[0],
a[1],a[2],a[3],5,"","30px " + FONT,"white","center");this.gui.push(this.levelName);this.buttons=getButtons(this.gui);this.selectedButton=b};
LevelSelectScene.prototype.buildButtonRow=function(){var a=[1,16/9],b=.05*a[0];a=.05*a[1];for(var c=.5/this.buttonsInRow,d=.5-c*(this.buttonsInRow-1)/2,e,f=0;f<this.buttonsInRow;f++)e=rectDimFromCenter(d+c*f,.535,b,a),e=new TextButton(e[0],e[1],e[2],e[3],4,this.loadGameLevel.bind(this,f+1),""+(f+1),"40px " + FONT,"white","transparent","white",5),e.setOptions(!1,!1,!1),e.value=f,this.gui.push(e),this.buttonRow.push(e);for(f=0;f<this.buttonRow.length;f++)this.buttonRow[f].setNeighbors([void 0,f==
this.buttonRow.length-1?void 0:this.buttonRow[f+1],void 0,0==f?void 0:this.buttonRow[f-1]])};LevelSelectScene.prototype.updateWorldSelection=function(a){this.worldSelected=a;for(var b=0;b<this.backWall.length;b++)this.backWall[b].activated=!1,this.worldLabels[b].setVisibility(!1);this.worldLabels[a].setVisibility(!0);this.backWall[a].activated=!0;for(b=0;b<this.backgroundList.length;b++)for(var c=0;c<this.backgroundList[b].length;c++)this.backgroundList[b][c].activated=b==a?!0:!1};
LevelSelectScene.prototype.handleWorldClick=function(a){this.menuState==SELECTWORLD?this.selectWorld(a):this.menuState==SELECTLEVEL&&a!=this.worldSelected&&(this.returnToWorldSelect(),this.updateWorldSelection(a))};
LevelSelectScene.prototype.selectWorld=function(a){this.worldSelected=a;this.menuState=SELECTLEVEL;this.selectedButton=this.buttonRow[0];this.selectedButton.selected=!0;for(a=0;a<this.buttonRow.length;a++)this.buttonRow[a].value=a;for(a=0;a<this.worldButtons.length;a++)this.worldButtons[a].setOptions(!0,!1,!1);var b=(this.worldSelected-1)/3,c=getGUIInGroup(4,this.gui);for(a=0;a<c.length;a++)c[a].setOptions(!0,!0,!0),c[a].y+=b;c=getGUIInGroup(5,this.gui);for(a=0;a<c.length;a++)c[a].setOptions(!0,!1,
!0),c[a].y+=b;this.leftArrow.setVisibility(!0);this.rightArrow.setVisibility(!0);this.levelIndex=0;if(this.menuState==SELECTLEVEL){b=this.levelIndex;for(a=0;a<this.worldSelected;a++)b+=this.levelsInWorld[a];this.levelName.text=this.levels[b]?""+this.levels[b].name:""}};
LevelSelectScene.prototype.returnToWorldSelect=function(){this.menuState=SELECTWORLD;this.selectedButton.selected=!1;this.selectedButton=getGUIInGroup(this.worldSelected,this.gui)[0];for(var a=0;a<this.worldButtons.length;a++)this.worldButtons[a].setOptions(!0,!0,!0);var b=getGUIInGroup(4,this.gui);for(a=0;a<b.length;a++)b[a].setOptions(!1,!1,!1),b[a].reset();b=getGUIInGroup(5,this.gui);for(a=0;a<b.length;a++)b[a].setOptions(!1,!1,!1),b[a].reset();for(a=this.levelIndex=0;a<this.buttonRow.length;a++)this.buttonRow[a].text=
""+(a+1)};LevelSelectScene.prototype.loadGameLevel=function(){this.allowUIInput=!1;for(var a=0,b=0;b<this.worldSelected;b++)a+=this.levelsInWorld[b];a+=this.levelIndex;this.startTransition(25,1,function(){var b=new GameScene;a<b.levels.length?(b.loadNewLevel(a),this.driver.setScene(new LevelIntroScene(b,!0))):this.allowUIInput=!0})};LevelSelectScene.prototype.handleEscape=function(){this.menuState==SELECTWORLD?this.driver.setScene(new MenuScene(!1)):this.menuState==SELECTLEVEL&&this.returnToWorldSelect()};
LevelSelectScene.prototype.goToMainMenu=function(){this.driver.setScene(new MenuScene(!1))};LevelSelectScene.prototype.mousemove=function(a,b){if(this.allowUIInput){if(this.menuState==SELECTWORLD){var c=getPercentPoint(a);c=Math.floor(3*c[1]);if(!c&&0!=c)return;c=3<=c?2:c;this.updateWorldSelection(0>c?0:c)}GUIMouseMove(this,a,this.buttons)}};
LevelSelectScene.prototype.navigateLevelSelect=function(a){if(this.allowUIInput)if(this.menuState==SELECTWORLD)this.navigateUI(a),this.updateWorldSelection(this.selectedButton.groupID);else if(this.menuState==SELECTLEVEL){switch(a){case 1:this.rightArrow.displaceArrow();break;case 3:this.leftArrow.displaceArrow()}1==a&&this.selectedButton==this.buttonRow[this.buttonsInRow-1]?this.incrementLevels():3==a&&this.selectedButton==this.buttonRow[0]&&this.decrementLevels();this.navigateUI(a);this.levelIndex=
this.selectedButton.value}};LevelSelectScene.prototype.incrementLevels=function(){if(this.buttonRow[this.buttonsInRow-1].value<this.levelsInWorld[this.worldSelected]-1){for(var a=0;a<this.buttonRow.length;a++)this.buttonRow[a].value+=1,this.buttonRow[a].text=""+(this.buttonRow[a].value+1);this.levelIndex=this.selectedButton.value;this.selectedButton!=this.buttonRow[0]&&(this.selectedButton.selected=!1,this.selectedButton=this.selectedButton.getNeighbor("left"),this.selectedButton.selected=!0)}};
LevelSelectScene.prototype.decrementLevels=function(){if(0<this.buttonRow[0].value){for(var a=0;a<this.buttonRow.length;a++)--this.buttonRow[a].value,this.buttonRow[a].text=""+(this.buttonRow[a].value+1);this.levelIndex=this.selectedButton.value;this.selectedButton!=this.buttonRow[this.buttonsInRow-1]&&(this.selectedButton.selected=!1,this.selectedButton=this.selectedButton.getNeighbor("right"),this.selectedButton.selected=!0)}};
var Slider=function(a,b,c,d,e,f,g,h,k,l,m,n,p){Button.call(this,a,b,c,d,e,f);this.barColor=k;this.handleWidth=g;this.handleColor=l;this.handleHeldColor=m;this.handleOutlineColor=n;this.handleOutlineWeight=p||0;this.value=h;this.requireMouseInRegionOnRelease=this.selectable=!1};$jscomp.inherits(Slider,Button);Slider.prototype.update=function(a,b){this.held&&this.setValue((b.x-this.x)/this.w)};
Slider.prototype.draw=function(a){a.fillStyle=this.handleBarColor;var b=this.getPixelDimensions(a);b[1]+=b[3]/3;b[3]/=3;a.fillRect(b[0],b[1],b[2],b[3]);a.fillStyle=this.held?this.handleHeldColor:this.handleColor;a.strokeStyle=this.handleOutlineColor;a.lineWidth=this.handleOutlineWeight;b={x:0,y:0,w:0,h:0};b.x=(this.value*this.w+this.x-this.handleWidth/2)*a.width;b.y=this.y*a.height;b.w=this.handleWidth*a.width;b.h=this.h*a.height;a.lineWidth=10*this.handleOutlineWeight;this.selected&&(a.lineWidth=
8);a.fillRect(b.x,b.y,b.w,b.h);a.strokeRect(b.x,b.y,b.w,b.h)};Slider.prototype.setValue=function(a){this.value=a;this.value=1<this.value?1:this.value;this.value=0>this.value?0:this.value;if(this.onHold)this.onHold(this.value)};Slider.prototype.contains=function(a,b){return a>=this.x+this.value*this.w-this.handleWidth/2&&a<=this.x+this.value*this.w+this.handleWidth/2&&b>=this.y&&b<=this.y+this.h};
addLevel(function(a){return{name:"Let The Dogs Out",worldType:0,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,5,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[4,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,
0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,9,9,9,9,9,9,1,1,1,9,9,9,9,9,9,1,1,1,0,0,0,0,9,9,9,9,1,1,1,9,9,9,9,1,0,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,9,9,2,0,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,2,1,1,2,1,16,0,9,9,1,1,2,1,1,1,1,1,1,1],[1,1,1,1,0,0,0,16,0,0,0,0,1,0,0,0,16,0,0,0,0,1,2,2,0,0,0,2,1,1,2,1,1,1,1,2,1,1,2,2,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{name:"Platform",solid:!0,groundBlock:!1,safe:!0,platform:!0,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){a.save();e*=.5;a.fillStyle="#754";a.fillRect(b,c,d,e);a.strokeStyle="#000";a.lineWidth=2;a.fillStyle="#532";a.fillRect(b,c+e/2,d,e/2);a.strokeRect(b,c,d,0);a.strokeRect(b,c+e,d,0);f&&(f.getCell(g+1,h).platform||a.strokeRect(b+d,c,0,e),f.getCell(g-1,h).platform||a.strokeRect(b,c,0,e),a.restore())},isColliding:function(a,b,c,d,e){return a.apple?!1:0<d&&a.y<=e.y?!0:!1}}});
var DoinkPad=function(a,b){this.x=a;this.y=b;this.h=this.w=30;this.r=15;this.bounceAnimation2=0;this.behind=!0};DoinkPad.prototype.update=function(){var a=this.getHitBox(),b=this.game.player.getHitBox();1==rectangleCollision(a,b)?this.isColliding||1!=this.playerCollision(this.game.player)||(this.getHitByEntity(this.game.player),this.isColliding=!0):this.isColliding=!1;0<this.bounceAnimation2&&--this.bounceAnimation2};
DoinkPad.prototype.draw=function(a){a.fillStyle="#ffee5e";var b=Math.cos(this.bounceAnimation2*Math.PI/10),c=this.w/10;c+=3*b;a.beginPath();a.moveTo(this.x-this.w+c,this.y-this.h-5*b);a.quadraticCurveTo(this.x,this.y-this.h-20*b,this.x+this.w-c,this.y-this.h-5*b);a.lineTo(this.x+this.w,this.y);a.lineTo(this.x-this.w,this.y);a.fill();a.fillStyle="#d1be55";a.beginPath();a.moveTo(this.x-this.w+c,this.y-this.h-5*b);a.quadraticCurveTo(this.x-this.w,this.y,this.x+this.w,this.y);a.lineTo(this.x-this.w,this.y);
a.fill()};DoinkPad.prototype.getHitByEntity=function(a){this.bounceAnimation2=20;a.bounceOffEntity(this)};DoinkPad.prototype.playerCollision=function(a){return 0<a.vy?!0:!1};DoinkPad.prototype.getHitBox=function(){return{x:this.x-.5*this.w,y:this.y-this.h,w:this.w,h:this.h}};
var CreditsScene=function(a){Scene.call(this,a);this.keyMap={32:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},13:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},27:{down:this.safeButtonCall(this,this.goToMainMenu)}};this.memberNames="Brian Dizon;Christian Gramling;Kyle Wong;Kristen Campbell;Taylor Poppoff;TJ Hanson;Muhammad Albayati".split(";");this.memberRoles="js wizardry;Programming and Design;Programming;Music & Audio;Art;Programming;Programming".split(";");
this.addCreditsGUI();this.nameLabels=getGUIInGroup(2,this.gui);this.roleLabels=getGUIInGroup(3,this.gui);moveAllGUI(-.7,0,this.nameLabels);moveAllGUI(.7,0,this.roleLabels);this.creditsTimer=0;this.initialDelay=15;this.delayBetween=8;this.labelVelocity=.08;this.endDistanceFromCenter=.03};$jscomp.inherits(CreditsScene,Scene);CreditsScene.prototype.update=function(a){Scene.prototype.update.call(this,a);this.updateCreditsLabels(a)};
CreditsScene.prototype.draw=function(a){a.fillStyle="black";a.fillRect(0,0,a.width,a.height);this.drawAllGUI(a)};CreditsScene.prototype.updateCreditsLabels=function(a){this.creditsTimer+=a;if(this.creditsTimer>this.initialDelay)for(var b=0;b<this.memberNames.length;b++)this.creditsTimer>this.initialDelay+b*this.delayBetween&&(this.moveCreditsEntry(this.nameLabels[b],"right",a),this.moveCreditsEntry(this.roleLabels[b],"left",a))};
CreditsScene.prototype.moveCreditsEntry=function(a,b,c){switch(b){case "left":b=a.x-(.5+this.endDistanceFromCenter);a.x=a.x+c*-this.labelVelocity*b<.5+this.endDistanceFromCenter?.5+this.endDistanceFromCenter:a.x-c*this.labelVelocity*b;break;case "right":b=.5-this.endDistanceFromCenter-(a.x+a.w),a.x=a.x+a.w+c*this.labelVelocity*b>.5-this.endDistanceFromCenter?.5-a.w-this.endDistanceFromCenter:a.x+c*this.labelVelocity*b}};
CreditsScene.prototype.addCreditsGUI=function(){this.leftRefObject=new GUIElement(-.5,.5,0,0,0);this.rightRefObject=new GUIElement(1.5,.5,0,0,0);var a=rectDimFromCenter(.5,.1,.4,.2),b=new Label(a[0],a[1],a[2],a[3],1,"Credits","60px " + FONT,"white","center");this.gui.push(b);a=rectDimFromCenter(.6,.9,.1,.1);b=new TextButton(a[0],a[1],a[2],a[3],4,this.goToMainMenu.bind(this),"Back","30px " + FONT,"white","transparent","white",3);this.gui.push(b);for(var c=.6/this.memberNames.length,d=c-.05,e=
[.5,.25],f=0;f<this.memberNames.length;f++)a=rectDimFromCenter(e[0]-.05,e[1]+f*c,.3,d),a=new Label(a[0],a[1],a[2],a[3],2,this.memberNames[f],"30px " + FONT,"white","right"),this.gui.push(a),a=rectDimFromCenter(e[0]+.05,e[1]+f*c,.3,d),a=new Label(a[0],a[1],a[2],a[3],3,this.memberRoles[f],"30px " + FONT,"white","left"),this.gui.push(a);this.selectedButton=b;b.selected=!0;this.buttons=getButtons(this.gui)};CreditsScene.prototype.goToMainMenu=function(){this.driver.setScene(new MenuScene(!1))};
addLevel(function(a){return{name:"RUN!",worldType:1,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,19,19,19,0,0,0,0,0,0,0,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,0,0,0,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0],[0,0,0,19,19,19,19,0,19,19,19,
19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,0,0,0],[0,0,0,19,19,19,19,19,19,19,19,18,19,19,19,19,19,19,19,19,19,18,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,0],[0,0,0,19,19,19,19,19,19,19,19,19,18,18,19,19,19,19,19,19,19,18,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,19,19,18,19,19,18,19,19,19,19,0],[0,0,0,19,18,18,18,19,19,19,18,19,19,18,18,18,19,19,19,19,18,19,19,19,27,19,19,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,18,19,19,19,0],[0,0,0,
19,19,19,18,18,18,18,18,19,19,19,19,18,18,18,18,18,19,19,16,19,27,19,19,0,0,0,0,0,0,0,0,0,19,19,19,19,18,18,19,18,19,19,19,19],[16,0,19,19,19,19,19,19,19,19,18,19,19,19,19,18,18,23,23,23,23,23,23,23,27,19,19,0,0,0,0,0,0,0,0,0,0,19,19,19,19,18,19,19,18,19,18,18],[9,0,19,19,19,18,18,19,19,18,18,18,18,18,18,18,19,19,18,18,18,18,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,18,18,18,18,18,19],[0,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,0,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,
19,19,18,18,18,18,19,19],[16,2,19,18,19,19,19,0,0,0,18,18,18,18,18,18,18,18,18,18,18,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,18,18,18,19,19,0],[9,0,19,19,19,0,0,0,0,0,0,0,18,18,18,18,18,18,18,18,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,0,0,0],[4,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,0,0,16],[1,1,1,1,1,1,9,9,9,16,3,3,0,0,18,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,27,18,18,18,0],[1,1,1,1,1,1,1,1,1,1,
1,1,9,9,23,23,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,27,23,23,9,9],[1,1,1,1,1,1,1,1,1,1,1,1,16,18,18,18,18,23,23,23,23,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,27,18,16,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,18,16,18,18,18,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,27,23,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,0,0,0,23,23,23,23,23,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,
1,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,5,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{name:"Platform2",solid:!0,groundBlock:!1,safe:!0,platform:!0,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){e*=.4;a.fillStyle="#642";a.fillRect(b,c,d,e);a.strokeStyle="#000";a.fillStyle="#532";a.fillRect(b,c+e/2,d,e/2);a.strokeRect(b,c,d,0);a.strokeRect(b,c+e,d,0);f&&(f.getCell(g+1,h).platform||a.strokeRect(b+d,c,0,e),f.getCell(g-1,h).platform||a.strokeRect(b,c,0,e))},isColliding:function(a,b,c,d,e){return a.apple?!1:0<d&&a.y<=e.y&&!a.crouching?!0:!1}}});
var Woof=function(a,b){Enemy.call(this,a,b);this.w=50;this.h=40;this.width=this.w;this.height=this.h;this.jumpPower=7;this.killPlayer=!0;this.startY=b;this.mx=.5;this.transition=0;this.fsm=[];this.populateFsm();this.state=0;this.ysight=this.xsight=300;this.color1="#aaa";this.color2="#888";this.color3="#555";this.jumpSoundType=SOUNDMAP.woof};$jscomp.inherits(Woof,Enemy);
Woof.prototype.populateFsm=function(){this.fsm.push({name:"Wandering",index:0,run:function(a){var b=a.game.player.x-a.x,c=a.game.player.y-a.y;return b>-a.xsight&&b<a.xsight&&c<a.ysight-100&&c>-a.ysight-100?a.toOne():this.index}});this.fsm.push({name:"Noticing",index:1,run:function(a){if(0>=a.transition&&0==a.vy)return a.toTwo();a.transition--;return this.index}});this.fsm.push({name:"Charging",index:2,run:function(a){if(1==a.transition&&0==a.vy)return a.toThree();a.wallcolliding&&0==a.transition&&
(a.speed=-5,a.transition=20,a.vx=-10*a.mx,a.mx*=-1,a.vy=-10,a.killPlayer=!1);if(1<a.transition)a.transition--;else{var b=a.game.player.x-a.x;b>-a.xsight/2&&b<a.xsight/2&&0==a.transition&&(a.jump(),a.killPlayer=!0)}return this.index}});this.fsm.push({name:"Confused",index:3,run:function(a){a._angle=Math.cos(a.transition*Math.PI/10)*Math.PI/20;if(0>=a.transition)return a.toZero();0==a.transition%7&&(a.flipped=!a.flipped);a.transition--;return this.index}})};
Woof.prototype.onHitPlayer=function(a){this.killPlayer&&(this.y-=5,a.vx=20*(2*(0<=this.mx)-1),Enemy.prototype.onHitPlayer.call(this,a))};Woof.prototype.getHitByEntity=function(a){a.bounceOffEntity(this);this.width+=20;this.height-=10;this.movementStun+=10;this.toThree()};Woof.prototype.toZero=function(){this.transition=0;0==this.mx&&(this.mx=1-2*this.flipped);this.mx=.5*Math.sign(this.mx);this.speed=3;return this._angle=0};
Woof.prototype.toOne=function(){this.transition=10;this.mx=0>this.game.player.x-this.x?-1:1;this.speed=0;this.jump();this.game.addEntity(new SleepText(this.x,this.y-this.h-70,80,0,-1,"!","45",FONT,[255,255,255,1],[250,40,40,0],10,10,!0));return 1};Woof.prototype.toTwo=function(){this.transition=0;this.mx=0>this.game.player.x-this.x?-1:1;this.speed=10;return 2};Woof.prototype.toThree=function(){this.transition=21;this.mx=0;this.speed=1;return 3};
Woof.prototype.update=function(a,b){this.state=this.fsm[this.state].run(this);Enemy.prototype.update.call(this,a,b)};
Woof.prototype.drawShape=function(a,b,c){var d=.2*c;a.translate(0,-d);c-=d;a.fillStyle=this.color1;a.strokeStyle="#000";a.lineWidth=5;a.strokeRect(-b/2,-c,b,c);this.pathEars(a,b,c);a.stroke();this.pathTail(a,b,c);a.stroke();this.pathFeet(a,b,c,d);a.stroke();a.fillStyle=this.color1;a.fillRect(-b/2,-c,b,c);this.pathEars(a,b,c);a.fill();this.pathFeet(a,b,c,d);a.fill();this.pathTail(a,b,c);a.fill();a.fillStyle=this.color2;a.fillRect(-b/2,-c,b/3,c);a.translate(b/4,.6*-c);this.drawFace(a,b/2,.6*c)};
Woof.prototype.pathFeet=function(a,b,c,d){d-=2;a.beginPath();a.fillStyle=this.color3;c=b/10;var e=10*this.angle;a.rect(.4*-b+e,-e/2,c,d);a.rect(.3*b-c-e,-e/2,c,d)};Woof.prototype.pathEars=function(a,b,c){a.beginPath();a.rect(.35*b,-c-4,4,4);a.rect(0,-c-4,4,4);a.fillStyle=this.color2};Woof.prototype.pathTail=function(a,b,c){a.beginPath();var d=8,e=8;a.fillStyle=this.color3;a.rect(-b/2-.8*d,-c-.3*e,d,e);d*=.8;e*=.8;a.rect(-b/2-1.5*d,-c-e,d,e)};
Woof.prototype.drawFace=function(a,b,c){a.lineWidth=3;a.lineCap="round";a.beginPath();a.moveTo(-b/4-2,-c/4);a.lineTo(-b/4,-c/4+2);a.moveTo(b/4+2,-c/4);a.lineTo(b/4,-c/4+2);a.stroke();a.lineWidth=3;a.beginPath();a.moveTo(1,0);a.lineTo(0,0);a.stroke();a.translate(0,4);a.lineWidth=1;var d=Math.abs(this.vy);a.translate(0,-d/4);this.drawMouth(a,.6*b,.8*c);a.translate(0,d);this.drawMouth(a,.6*b,.8*c)};
Woof.prototype.drawMouth=function(a,b,c){a.beginPath();a.moveTo(-b/2,2);a.lineTo(-b/2,c/4);a.lineTo(-b/7,2);a.lineTo(0,c/4);a.lineTo(b/7,2);a.lineTo(b/2,c/4);a.lineTo(b/2,2);a.stroke()};var LevelEditorSelectScene=function(a){LevelSelectScene.call(this,a);this.keyMap["78"]={down:this.loadNewLevel.bind(this)};this.keyMap["69"]={down:this.loadLocalLevel.bind(this)};this.keyMap["82"]={down:this.loadPigLevel.bind(this)};this.addExtraGUI()};$jscomp.inherits(LevelEditorSelectScene,LevelSelectScene);
LevelEditorSelectScene.prototype.update=function(a,b){LevelSelectScene.prototype.update.call(this,a,b)};LevelEditorSelectScene.prototype.draw=function(a){LevelSelectScene.prototype.draw.call(this,a)};LevelEditorSelectScene.prototype.loadNewLevel=function(){this.loadGameLevel(-2)};LevelEditorSelectScene.prototype.loadLocalLevel=function(){this.loadGameLevel(0)};LevelEditorSelectScene.prototype.loadPigLevel=function(){this.loadGameLevel(-1)};
LevelEditorSelectScene.prototype.addExtraGUI=function(){var a=rectDimFromCenter(.5,.33,.7,.1);a=new Label(a[0],a[1],a[2],a[3],7,"Level Editor    [N] - New Level    [E] - Local Level    [R] - PigFunScene","30px " + FONT,"white","center");this.gui.push(a)};LevelEditorSelectScene.prototype.loadGameLevel=function(a){if(void 0==a)LevelSelectScene.prototype.loadGameLevel.call(this);else{for(var b=0;b<this.worldSelected;b++)a+=this.levelsInWorld[b];a=new LevelEditorScene(a);this.driver.setScene(a)}};
addLevel(function(a){return{name:"Escape from the Den",worldType:1,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,18,18,19],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,18,19,19,19,19,19,18],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,18,19,19,19,19,18,19,19,19,
0,5,19,19],[0,0,0,0,19,19,19,0,0,0,0,0,0,19,19,19,19,0,0,0,0,19,19,19,0,0,0,0,0,0,0,0,0,0,19,19,19,18,19,19,18,19,19,19,9,23,23,23],[0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,19,19,19,19,19,19,0,19,19,19,18,18,18,18,19,19,19,19,19,19,19],[0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,19,19,19,19,18,18,18,18,18,19,19,18,19],[0,0,0,19,19,18,18,19,19,19,19,19,19,19,19,19,19,18,19,19,19,19,19,19,19,19,19,19,19,19,
18,27,19,19,19,18,0,0,19,18,18,18,18,18,18,19,18,19],[0,0,0,19,19,19,18,18,19,18,19,19,19,19,19,18,18,19,19,19,19,19,18,18,19,19,19,19,19,19,18,27,16,23,23,23,27,18,18,18,18,18,18,18,18,18,18,27],[0,0,0,0,0,19,19,18,18,19,19,19,19,19,18,18,19,19,19,19,19,19,19,18,18,18,18,19,18,18,18,27,27,27,27,27,27,27,27,27,27,18,18,27,23,23,23,27],[19,19,19,19,19,0,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,19,19,19,19,19,0,0,18,18,23,23,27,18,19,19,19],[19,19,18,19,19,0,18,
18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,18,18,18,18,18,19,19,19,0,0,0,0,0,0,18,18,18,18,27,18,18,0,0],[19,19,18,18,19,19,0,18,18,19,18,18,18,18,18,18,18,18,19,19,0,19,0,18,18,18,18,18,18,19,19,0,0,0,0,0,0,27,27,27,27,27,27,27,18,18,18,18],[0,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,18,18,18,18,18,18,18,18,18,18,0,0,0,0,0,9,23,27,18,18,18,18,18,18,18,18,18,18],[0,19,19,18,18,18,18,18,18,18,18,18,18,18,19,19,19,0,0,0,19,18,18,18,18,18,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,
18,18,18,18,18,0,0],[16,9,23,23,27,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,0,18,18,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,18,0,0],[9,9,9,23,23,23,23,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,18,18,0,0,0,0,0,0,18,18,18,18,18,18,0,0,0,0],[0,16,0,18,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,18,18,18,18,18,18,18,18,0,0,0,0,0,18,18,18,18,18,18,0,16,0,0],[1,1,9,23,23,23,23,27,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,18,18,18,18,18,18,18,18,0,0,18,18,18,18,18,18,18,18,0,0,0],[1,0,0,0,
18,18,18,27,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,18,18,27,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[4,0,0,0,0,18,18,27,0,0,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,27,23,23,23,18,16,1,1,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1]]}});addBlock(function(){return{name:"Boost",solid:!1,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="black";a.fillRect(b,c,d,e);a.strokeStyle="#fff";a.beginPath();a.moveTo(b,c+e/2);a.lineTo(b+d,c+e/2);a.lineTo(b+d/2,c+e/4);a.lineTo(b,c+e/2);a.lineTo(b+d/2,c+3*e/4);a.lineTo(b+d,c+e/2);a.stroke()},entityCollision:function(a,b,c,d,e){0<a.vy&&(a.vy=-10,--a.y,a.vx=20*(1-2*a.flipped));return!1}}});
var Butcher=function(a,b){Mover.call(this,a,b);this.w=35;this.h=50;this.width=this.w;this.height=this.h;this.eyeMovement={x:0,y:0,blink:0,blinkTime:10,tx:0,ty:0,px:8,py:15,dx:20,w:8,w2:7};this.eyeColor="#fff";this.outlineColor="#000";this.color1="#aaa";this.color2="#888";this.mx=-1;this.speed=4;this.knifeAngle=this.state=0};$jscomp.inherits(Butcher,Mover);
Butcher.prototype.update=function(a,b){Mover.prototype.update.call(this,a,b);switch(this.state){case 0:this.moveToPig();break;case 1:this.waitForJump();break;case 2:this.waitForFall();break;case 3:this.moveOffScreen()}};Butcher.prototype.attachPig=function(){this.game.pig.x=this.x-this.w/4*(1-2*this.flipped);this.game.pig.y=this.y-this.h/4;this.game.pig.flipped=!this.flipped;this.game.pig.vy=0;this.game.pig._angle=this.angle;this.game.pig.animationState=0;this.game.pig.bounceFrq=Math.PI/10};
Butcher.prototype.waitForJump=function(){this.mx=0;0==this.grounded&&(this.state=2);this.attachPig()};Butcher.prototype.waitForFall=function(){this.mx=0;this.grounded&&(this.state=3);this.attachPig()};Butcher.prototype.moveToPig=function(){this.mx=-1;this.x<this.game.pig.x&&(this.state=1,this.jump(7),this.mx=0)};Butcher.prototype.moveOffScreen=function(){this.mx=1;this.attachPig()};
Butcher.prototype.drawShape=function(a,b,c){a.save();a.strokeStyle=this.outlineColor;a.lineWidth=5;a.strokeRect(-b/2-1,-c-1,b+2,c+2);a.fillStyle=this.color1;a.fillRect(-b/2,-c,b,c);a.fillStyle=this.color2;var d=.2*b+this.eyeMovement.x/2;this.dead&&(d-=5);a.fillRect(-b/2,-c,d,c);d=.4*c;a.fillStyle="#fff";var e=b/4,f=c/10;a.fillRect(-b/2+e,-d,b-e,d);a.fillRect(-b/2,-d,e,f);a.fillStyle="#a88";a.fillRect(-b/2+e+7,-d+5,b-e-10,7);a.fillStyle=this.eyeColor;f=1-.6*Math.abs(this.vy)/this.terminalVelocity;
b=-c+this.eyeMovement.py+this.eyeMovement.y;d=this.eyeMovement.px+this.eyeMovement.x;e=this.eyeMovement.dx-this.eyeMovement.x/3;var g=0;0<this.eyeMovement.blink&&(g=(1+Math.cos((this.eyeMovement.blinkTime-this.eyeMovement.blink+1)*Math.PI/20))/2);b+=4*g;f=8*f*(1-g);this.crouching&&(d+=2);this.drawEye(a,d-e,b,this.eyeMovement.w,f,0,Math.PI/20,2*this.eyeMovement.w,6,"#000");this.drawEye(a,d,b,this.eyeMovement.w2,f,3,-Math.PI/20,2*this.eyeMovement.w,6,"#000");b=this.w;a.translate(0,-c);d=Math.abs(this.angle);
d>Math.PI/4&&(d=Math.PI/4);a.rotate(-d);this.drawHat(a,b);a.translate(0,c);a.restore()};Butcher.prototype.drawEye=function(a,b,c,d,e,f,g,h,k,l){a.fillRect(b,c,d,e);a.save();a.fillStyle=l;a.translate(b+d/2+f,c-k/4);a.rotate(g);a.fillRect(-h/2,-k/2,h,k);a.restore()};Butcher.prototype.drawHat=function(a,b){a.fillStyle="#fff";a.beginPath();a.rect(-b/2-1,-6,b,12);a.stroke();a.fill();a.fillStyle="#ddd";a.beginPath();a.rect(-b/2-1,-6,b/4,12);a.fill()};
Butcher.prototype.drawKnife=function(a,b,c){a.save();a.translate(b/2-10*this.knifeAngle,-c/3-10*this.knifeAngle);a.scale(-1,1);a.rotate(-Math.PI/5+this.knifeAngle);a.lineWidth=3;a.beginPath();a.fillStyle="#a33";a.rect(-5,0,5,10);a.stroke();a.fill();a.fillStyle="#822";a.fillRect(-5,0,2.5,10);a.fillStyle="#eee";a.beginPath();a.rect(-18,-23,18,23);a.stroke();a.fill();a.fillStyle="#fff";a.fillRect(-18,-23,4.5,23);a.beginPath();a.fillStyle="#000";a.arc(-4.5,-18.5,3,0,2*Math.PI);a.fill();a.restore()};
var OptionScene=function(a){Scene.call(this,a);this.keyMap={27:{down:this.safeButtonCall(this,this.goToMainMenu)},32:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},13:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},87:{down:this.navigateUI.bind(this,0)},68:{down:this.navigateUI.bind(this,1)},83:{down:this.navigateUI.bind(this,2)},65:{down:this.navigateUI.bind(this,3)},38:{down:this.navigateUI.bind(this,0)},39:{down:this.navigateUI.bind(this,1)},40:{down:this.navigateUI.bind(this,
2)},37:{down:this.navigateUI.bind(this,3)}};this.background=new InfiniteBackground;this.camera={x:0,y:0,dx:0,dy:0};this.loadOptionGUI();this.FREE=0;this.VOLUME=1;this.state=0};$jscomp.inherits(OptionScene,Scene);OptionScene.prototype.update=function(a){this.camera.x+=3;Scene.prototype.update.call(this,a);this.volumeLabel.text="Volume: "+Math.floor(100*this.volumeSlider.value)};OptionScene.prototype.draw=function(a){this.background.drawLayers(a,this.camera);this.drawAllGUI(a)};
OptionScene.prototype.changeVolumeBy=function(a){this.volumeSlider.setValue(this.volumeSlider.value+a);this.volumeSlider.setValue(Math.round(100*this.volumeSlider.value)/100);this.volumeSlider.onRelease()};
OptionScene.prototype.loadOptionGUI=function(){var a=rectDimFromCenter(.5,.5,.2,.1);this.volumeSlider=new Slider(a[0],a[1],a[2],a[3],0,void 0,.03,DESTINATION.gain.value,"white","white","gray","black");this.volumeSlider.onRelease=this.playSliderSound.bind(this,this.volumeSlider);this.volumeSlider.onHold=this.setVolume.bind(this,this.volumeSlider);this.volumeSlider.selectable=!0;this.gui.push(this.volumeSlider);a=rectDimFromCenter(0,.4,.25,.1);this.volumeLabel=new Label(.4,a[1],a[2],a[3],0,this.volumeSlider.value,
"35px " + FONT,"white","left");this.gui.push(this.volumeLabel);a=rectDimFromCenter(.8,.9,.2,.1);var b=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToMainMenu.bind(this),"Main Menu","30px " + FONT,"white","transparent","white",5,.05);this.gui.push(b);this.selectedButton=b;b.selected=!0;a=rectDimFromCenter(.5,.7,.2,.1);var c=new GrowthTextButton(a[0],a[1],a[2],a[3],0,function(){MAIN.gamepadOn=!MAIN.gamepadOn;c.text="Gamepad "+(MAIN.gamepadOn?"On":"Off")},"Gamepad On","30px " + FONT,"white",
"transparent","white",5,.05);this.gui.push(c);a=rectDimFromCenter(.5,.15,.4,.2);a=new Label(a[0],a[1],a[2],a[3],0,"Options","60px " + FONT,"white","center");this.gui.push(a);this.volumeSlider.setNeighbors([void 0,void 0,c,void 0]);b.setNeighbors([c,void 0,void 0,c]);c.setNeighbors([this.volumeSlider,b,b,void 0]);this.buttons=getButtons(this.gui)};OptionScene.prototype.goToMainMenu=function(){this.driver.setScene(new MenuScene(!1))};OptionScene.prototype.setVolume=function(a){setVolume(a.value)};
OptionScene.prototype.playSliderSound=function(a){SOUNDMAP.bounce.play()};OptionScene.prototype.navigateUI=function(a){switch(this.state){case this.FREE:Scene.prototype.navigateUI.call(this,a);break;case this.VOLUME:1==a?this.changeVolumeBy(.05):2==a?(this.selectedButton=this.selectedButton.buttonLinks[2],this.selectedButton.selected=!0,this.volumeSlider.selected=!1,this.state=this.FREE):3==a&&this.changeVolumeBy(-.05)}this.selectedButton==this.volumeSlider&&(this.state=this.VOLUME)};
addLevel(function(a){return{name:"The Acorn",worldType:1,grid:[[0,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],[0,19,19,19,19,19,19,19,19,19,27,19,19,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,19,19,19,19,19,19,19,18],[19,19,18,19,19,19,19,18,19,19,27,19,19,19,0,0,0,0,0,0,0,0,0,19,19,18,18,18,19,19,18,18,19,19,19,19,19,18,27,19,19,18,19,18,19,19,18,18],[4,18,19,19,18,19,19,18,19,19,27,
19,19,19,0,0,0,0,0,0,0,0,0,0,19,19,19,18,18,19,18,19,19,19,19,18,18,18,27,18,19,19,18,18,18,18,27,23],[23,23,18,19,18,19,19,18,19,18,27,19,19,0,0,0,0,0,0,0,0,0,0,0,0,19,18,18,18,18,18,19,19,19,18,19,19,19,27,18,18,18,19,18,18,19,27,18],[0,18,18,18,18,19,18,18,19,18,27,19,19,0,0,0,0,0,0,0,0,0,0,0,9,9,23,23,23,23,27,18,19,19,18,23,23,23,27,18,18,18,27,18,19,19,27,19],[0,0,18,18,18,18,18,18,18,18,18,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,18,18,18,27,18,19,18,19,19,19,19,27,18,18,18,27,18,18,18,27,19],[0,
0,0,19,23,23,27,18,18,18,19,19,0,0,0,0,0,19,19,19,19,19,19,19,0,0,19,19,18,18,2,18,18,19,19,19,19,19,19,19,18,18,27,18,18,19,27,0],[0,19,19,19,19,18,27,18,18,18,19,19,0,0,0,19,19,19,19,19,19,19,19,19,19,19,0,19,22,18,2,18,18,19,19,19,19,19,19,19,19,18,27,18,18,0,27,0],[0,19,19,19,19,18,27,18,18,19,19,19,0,0,0,19,19,19,19,19,19,19,19,19,19,19,0,0,0,18,27,18,18,19,19,19,0,0,0,0,19,18,27,18,18,27,18,0],[0,19,19,18,19,18,27,18,19,18,19,19,0,0,0,19,19,19,19,18,18,19,19,19,18,19,19,0,0,18,27,18,18,19,19,
23,23,23,23,9,19,18,27,18,18,27,18,0],[0,19,19,18,19,18,18,18,18,18,19,0,0,0,0,19,18,19,18,19,18,18,18,19,18,19,19,0,0,18,27,18,18,18,18,18,18,19,19,0,19,18,27,18,18,27,0,0],[0,0,19,18,18,18,19,19,19,19,19,0,0,0,0,19,18,18,18,19,18,18,18,18,18,18,0,0,0,18,27,18,18,18,2,19,19,19,0,0,0,18,27,18,18,27,0,0],[0,0,19,19,19,18,19,18,19,19,0,0,0,0,19,19,19,19,18,18,18,18,19,19,18,19,19,0,0,18,2,18,18,19,27,19,19,0,0,0,0,18,27,18,18,27,0,0],[0,0,0,0,19,18,18,18,19,19,0,0,0,0,0,0,0,19,19,18,18,18,19,19,19,
19,19,0,0,18,2,18,19,19,27,0,0,0,0,0,23,23,27,18,18,27,0,0],[0,0,0,0,0,18,18,18,19,0,0,0,0,0,0,0,0,9,23,23,27,18,18,18,19,19,19,0,18,18,27,18,0,0,27,0,0,0,0,0,0,18,27,18,18,27,0,0],[0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,18,27,18,18,19,19,19,19,0,18,18,27,18,0,0,27,18,18,0,0,0,0,18,27,18,18,27,0,0],[0,0,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,27,18,19,19,0,0,19,0,18,18,27,18,0,0,2,18,18,0,0,0,0,18,27,18,18,27,0,0],[1,1,1,1,1,1,1,18,0,0,0,0,0,0,0,0,0,0,0,2,27,18,0,0,0,0,19,0,18,18,27,18,0,0,2,18,
18,0,0,0,0,18,27,18,18,18,0,0],[1,1,1,1,1,1,1,18,18,0,15,0,0,0,0,0,0,0,0,18,27,18,0,0,0,0,7,0,18,18,18,18,0,0,27,18,18,0,0,0,0,2,27,18,18,18,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,2,18,27,18,18,0,0,0,0,0,18,18,18,18,0,0,27,18,18,18,0,0,0,18,27,18,18,18,5,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,2,18,27,18,18,18,0,0,0,18,18,18,18,18,0,0,27,18,18,18,0,0,2,18,27,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,18,18,27,18,18,18,18,0,18,18,18,18,18,18,18,0,2,18,18,18,18,0,18,18,1,1,1,1,1,1],[1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],init:function(a){var b=new WorldText(1030,820,620,"ACORNS allow Jimothy to WALL JUMP","30px " + FONT,[255,255,255,0],[255,255,255,1],25,!1,"center"),d=new TriggerZone(830,720,420,200,a.player,b.appear.bind(b),void 0,b.disappear.bind(b),!1);a.entities.push(b);a.entities.push(d)}}});
addBlock(function(){return{name:"Bounce",solid:!1,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="#900";a.fillRect(b,c,d,e);a.strokeStyle="#fff";a.beginPath();a.moveTo(b+d/4,c+e/2);a.lineTo(b+3*d/4,c+e/2);a.lineTo(b+d/2,c);a.lineTo(b+d/4,c+e/2);a.lineTo(b+d/2,c+e);a.lineTo(b+3*d/4,c+e/2);a.stroke()},entityCollision:function(a,b,c,d,e){a.x<e.x+e.w/2&&0<=a.vx&&(a.vy=-10,a.vx=-20,--a.y);a.x>e.x+e.w/2&&0>=a.vx&&(a.vy=-10,a.vx=20,--a.y);a.spinning=!0;a.angle+=Math.PI}}});
var PigBeginning=function(a,b){Pig.call(this,a,b);this.apples=0;this.fsm=[];this.populateFsm();this.state=0;this.xsight=100;this.ysight=200;this.transition=1;this.animationState=2;this.speed=5;this.groundAccel=1;this.isBeginning=!0;this.appleDict=[]};$jscomp.inherits(PigBeginning,Pig);PigBeginning.prototype.update=function(a,b){4<=this.apples&&this.game.win();this.state=this.fsm[this.state].run(this);Pig.prototype.update.call(this,a,b)};
PigBeginning.prototype.playerCollision=function(){this.game.player.y<this.y&&0<this.game.player.vy&&this.game.player.bounceOffEntity(this,22)};
PigBeginning.prototype.populateFsm=function(){this.fsm.push({name:"Following",index:0,run:function(a){1==a.transition?a.toZero():1<a.transition&&(a.speed=0);var b=a.game.player.x-a.x,c=a.game.player.y-a.y;if(b>-a.xsight&&b<a.xsight&&c<a.ysight&&c>-a.ysight)return a.toOne();a.wallcolliding&&(a.transition=10);return this.index}});this.fsm.push({name:"Waiting",index:1,run:function(a){a.mx=0>a.game.player.x-a.x?-1:1;0<a.transition&&a.transition--;0==a.vy&&(a.speed=0);var b=a.game.player.x-a.x,c=a.game.player.y-
a.y;b>4*-a.xsight&&b<4*a.xsight&&-15>c&&0==a.transition&&(a.speed=3,a.jump(),a.transition=10);return b<-a.xsight||b>a.xsight?a.toZero():this.index}});this.fsm.push({name:"Afraid",index:2,run:function(a){return 0<a.appleDict.length?a.toThree:this.index}});this.fsm.push({name:"HuntingApple",index:3,run:function(a){a.mx=0>a.appleDict[a.appleDict.length-1]-a.x?-1:1;return this.index}})};
PigBeginning.prototype.toZero=function(){this.transition=0;this.mx=0>this.game.player.x-this.x?-1:1;this.speed=this.game.player.speed;return 0};PigBeginning.prototype.toOne=function(){this.transition=10;this.speed=0;return 1};PigBeginning.prototype.toTwo=function(){if(3==this.state)return this.toThree();this.speed=this.animationState=this.transition=0;return 2};PigBeginning.prototype.toThree=function(){this.transition=0;this.animationState=2;return this.speed=3};
PigBeginning.prototype.eatApple=function(a){this.appleDict.push(a);this.state=this.toThree()};PigBeginning.prototype.ateApple=function(a){for(var b=this.appleDict.length-1;0<=b;b--)this.appleDict[b]==a&&this.appleDict.splice(b,1);0==this.appleDict.length&&(this.state=this.toOne())};
var LevelIntroScene=function(a,b){Scene.call(this,b);this.nextScene=a;this.player=this.nextScene.player;this.originalPlayer={x:this.player.x,y:this.player.y};this.player.x=-50;this.player.uncrouch();this.player.width=this.player.w;this.player.height=this.player.h;this.player.y=this.originalPlayer.y;this.player.vx=this.player.speed/3;this.player.mx=1;this.postMoveDuration=15;this.postMoveTimer=0;this.nextScene.behinds=[]};$jscomp.inherits(LevelIntroScene,Scene);
LevelIntroScene.prototype.update=function(a,b){Scene.prototype.update.call(this,a);this.nextScene.updateTransition(a);this.player.updateEye(a,b);this.player.y=this.originalPlayer.y;this.player.vx=this.player.speed/3;this.player.x<this.originalPlayer.x?(this.player.x+=a*this.player.vx,this.player.angle=-Math.PI/40*this.player.vx/this.player.speed+Math.cos(b*Math.PI/7)*Math.PI/20):(this.player.angle=0,this.player.vx=0,this.player.x=this.originalPlayer.x,this.postMoveTimer<this.postMoveDuration?this.postMoveTimer+=
a:this.loadNextScene())};LevelIntroScene.prototype.draw=function(a){Scene.prototype.draw.call(this,a);this.nextScene.draw(a);drawTransitionOverlay(this.overlayColor,a)};LevelIntroScene.prototype.loadNextScene=function(){this.player.angle=0;this.player.vx=0;this.player.x=this.originalPlayer.x;this.player.grounded=!0;this.driver.setScene(this.nextScene)};
addLevel(function(a){return{name:"Jungle Gym",worldType:0,grid:[[0,0,0,0,0,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,27,19,18,19,19,18,18,18,18,18,18,18,27,18,19,19,19,19,19,0,0,0],[0,0,0,19,19,19,19,19,19,19,19,19,18,18,19,18,19,19,18,19,19,19,19,19,18,18,27,19,19,19,19,18,18,18,19,19,18,18,27,19,19,19,19,19,19,19,19,19],[0,0,19,19,19,19,19,19,19,19,19,19,18,18,27,18,18,18,19,19,19,0,0,19,18,18,27,19,19,18,19,19,18,18,18,18,18,19,27,19,19,19,19,19,19,19,19,19],[0,0,19,19,19,
19,19,19,19,19,19,19,19,18,27,18,18,19,27,23,23,23,23,27,19,18,27,18,18,19,22,18,18,18,18,19,19,19,27,19,19,19,18,19,19,19,18,19],[0,0,19,19,19,19,19,19,19,19,19,19,19,19,27,23,23,23,27,18,18,18,18,27,19,18,27,23,23,23,23,23,23,27,18,18,19,18,27,19,19,19,18,19,19,19,19,18],[0,19,19,19,19,19,19,19,19,19,19,19,19,19,2,18,18,18,27,18,18,18,27,27,19,23,27,2,18,18,18,18,2,27,18,19,19,18,27,19,19,18,18,19,19,0,19,19],[0,19,19,19,19,19,19,19,19,19,19,19,19,19,27,18,18,18,27,18,18,18,27,19,19,18,27,2,18,
18,18,18,2,27,19,19,19,18,27,18,19,23,23,23,9,0,0,5],[0,19,19,19,19,19,19,18,19,19,19,19,19,19,27,18,18,18,2,18,18,27,27,19,0,18,27,2,18,19,18,18,2,27,0,19,19,18,27,18,18,18,19,19,19,0,9,23],[0,0,19,19,19,19,18,18,18,19,19,19,19,18,27,18,18,18,2,18,18,27,19,19,0,2,27,2,18,19,18,18,2,27,0,19,19,18,18,19,18,27,19,19,0,0,19,19],[0,0,19,0,19,19,18,18,19,19,19,19,19,18,27,18,18,18,2,18,27,27,19,0,2,18,18,18,18,19,19,18,18,27,19,19,19,18,18,19,18,27,19,19,19,19,19,0],[0,0,7,0,0,19,18,18,18,18,19,19,18,
18,2,18,18,18,2,18,27,19,19,2,19,18,18,18,18,19,19,18,18,27,19,18,18,18,27,19,18,27,19,19,19,19,19,0],[0,0,0,0,0,0,18,18,18,0,0,19,19,18,27,18,18,18,2,27,27,19,0,2,19,18,18,18,18,18,18,18,18,27,19,19,18,18,27,18,18,18,18,18,18,18,19,19],[0,0,0,0,0,0,18,18,18,0,0,0,19,18,27,18,18,18,2,27,19,19,2,19,19,18,18,18,18,18,19,18,18,27,19,19,19,19,27,18,18,18,18,18,19,19,19,19],[0,0,9,23,23,23,23,18,18,0,0,0,0,19,27,18,18,18,2,27,0,0,2,19,18,18,18,18,18,19,19,18,18,27,19,19,18,19,18,18,18,27,18,19,19,0,0,
0],[0,0,0,19,19,18,18,18,18,0,0,0,0,0,27,18,18,18,2,27,0,2,19,19,19,18,18,18,18,19,18,18,18,18,19,19,19,18,18,18,18,27,19,19,0,0,0,0],[0,0,0,0,19,19,18,18,18,0,0,0,0,0,27,18,18,18,2,27,0,19,19,23,23,23,27,18,18,0,18,18,18,18,19,0,19,19,18,18,18,18,0,0,0,0,0,0],[0,0,0,0,0,0,18,18,23,23,23,9,0,0,2,18,18,18,27,27,0,0,19,19,18,18,27,18,18,0,18,2,18,18,19,0,0,0,18,18,18,18,0,0,0,0,0,0],[0,0,0,0,0,0,18,18,18,18,0,0,0,0,2,18,18,18,27,27,0,0,0,19,19,18,27,18,18,0,18,27,18,19,19,0,9,23,23,27,18,18,0,0,0,0,
0,0],[0,0,0,0,0,0,18,18,18,0,0,0,0,0,0,18,18,18,27,27,0,0,0,0,0,18,27,18,18,0,18,27,18,19,0,0,0,0,18,27,18,18,0,0,0,0,0,0],[0,0,0,0,23,23,23,18,18,0,0,0,0,0,18,18,18,18,2,27,2,0,0,0,0,18,27,18,18,0,18,27,18,0,0,0,0,0,18,27,18,18,18,0,0,0,0,0],[0,4,0,18,18,18,18,18,18,18,18,0,0,18,18,18,18,18,2,27,2,2,2,0,0,18,27,18,18,0,18,27,18,0,0,0,0,0,18,27,18,18,18,18,18,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,18,18,27,18,18,18,18,27,2,0,0,0,0,2,2,27,18,18,18,18,18,0,0,0],[1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,18,18,27,18,2,2,2,2,18,18,1,1,1,1,1,18,18,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{name:"Kaizo",solid:!1,id:BLOCKS.length,hide:!0,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="rgba(50,50,0,.5)";a.fillRect(b,c,d,e)},entityCollision:function(a,b,c,d,e){0>d&&(a.game.world.world[e.y/e.h][e.x/e.w]=1,a.game.world.forceRedraw())}}});var Apple=function(a,b){Mover.call(this,a,b);this.x=a;this.startY=this.y=b;this.h=this.w=25;this.r=15;this.grav=this.mx=0;this.color1="red";this.color2="#a00";this.color3="#fff";this.color4="#640";this.hit=!1;this.apple=!0};
$jscomp.inherits(Apple,Mover);
Apple.prototype.update=function(a,b){var c=this,d=this.getHitBox(),e=this.game.player.getHitBox();!this.hit&&rectangleCollision(d,e)&&0<this.game.player.vy&&this.playerCollision(this.game.player)&&(this.getHitByEntity(this.game.player),this.game.pig&&this.game.pig.isBeginning||setTimeout(function(){c.y=c.startY;c.hit=!1;c.grav=0},1E3));this.game.pig&&this.game.pig.isBeginning&&rectangleCollision(d,this.game.pig.getHitBox())&&(this.grav=0,this.y-=5E3,this.game.pig.apples++,this.game.pig.ateApple(this.x));
Mover.prototype.update.call(this,a,b)};Apple.prototype.getHitByEntity=function(a){var b=this;a.bounceOffEntity(this,15);this.grav=1;this.hit=!0;this.game.pig&&this.game.pig.isBeginning&&(500>Math.abs(this.x-this.game.pig.x)?this.game.pig.eatApple(this.x):setTimeout(function(){b.y=b.startY;b.hit=!1;b.grav=0},1E3))};Apple.prototype.playerCollision=function(a){return!0};Apple.prototype.getHitBox=function(){return{x:this.x-.5*this.w,y:this.y-this.h,w:this.w,h:this.h}};
Apple.prototype.drawShape=function(a,b,c){a.fillStyle=this.color1;a.fillRect(-b/2,-c,b,c);a.fillStyle=this.color2;a.fillRect(-b/2,-c,b/2,c);a.fillStyle=this.color3;a.fillRect(.1*-b,.9*-c,.5*b,.2*c);a.fillStyle=this.color4;a.fillRect(.1*-b,1.3*-c,.2*b,.3*c)};
var LevelCompleteScene=function(a,b,c){Scene.call(this,!1);this.prevScene=a;this.callback=b;this.win=c;this.player=a.player;this.pig=a.pig;this.prevLevelAlpha=1;this.camera=this.prevScene.camera;this.entities=[this.player,this.pig];this.time=0;this.maxTime=100;this.midPoint={x:(this.player.x+this.pig.x)/2,y:(this.player.y+this.pig.y)/2};this.pig.animationState=2;b=this.player;b.angle=0;b.uncrouch();this.r=20;this.update=this.update0;a.screenShakeLevel=0;this.keyMap={27:{down:this.startExitTransition.bind(this)},
78:{down:function(){this.keys[67]&&DEBUG&&this.loadNextScene()}.bind(this)}};this.butcher=new Butcher(0,0);this.butcher.ghostOn=!0;this.butcher.state=-1;SOUNDMAP.levelComplete.play();this.addAllGUI()};$jscomp.inherits(LevelCompleteScene,Scene);LevelCompleteScene.prototype.update0=function(a,b){Scene.prototype.update.call(this,a,b);this.update=this.update1;this.player.ghostOn=!0;this.pig.ghostOn=!0;this.time=0};
LevelCompleteScene.prototype.update1=function(a,b){Scene.prototype.update.call(this,a,b);var c=this.time/this.maxTime;this.prevLevelAlpha=1-c;if(this.time>=this.maxTime)this.time=this.prevLevelAlpha=0,this.update=this.update2;else{this.entities.forEach(function(c){c.vy=0;c.update(a,b)});this.time+=1;this.midPoint.x+=(this.camera.x-this.midPoint.x)*c*c;this.midPoint.y+=(this.camera.y-this.midPoint.y)*c*c;var d=c*c*Math.PI*4+Math.PI,e=this.r=.75>c?this.r+(100-this.r)/10:this.r+(10-this.r)/10,f=e/2;
this.player.angle=Math.cos(d)*Math.PI/20;this.player.x=this.midPoint.x+Math.cos(d)*e;this.player.y=this.midPoint.y+Math.sin(d)*f;d+=Math.PI;this.pig.x=this.midPoint.x+Math.cos(d)*e;this.pig.y=this.midPoint.y+Math.sin(d)*f;this.player.flipped=this.player.x>this.pig.x;this.pig.flipped=!this.player.flipped;.75<c&&(this.player.eyeMovement.blink=7*c*c)}};
LevelCompleteScene.prototype.update2=function(a,b){Scene.prototype.update.call(this,a,b);this.time+=1;this.maxTime=40;var c=this.time/this.maxTime;this.player.y+=1*Math.sin(c*c*Math.PI*2);this.pig.y+=1*Math.sin(c*c*Math.PI*2);if(this.time>this.maxTime){if(this.win)return this.startExitTransition();this.prevScene.screenShakeLevel=1;SOUNDMAP.pigrip.play();this.player.maxJumps=1;this.player.wallJumps=!1;this.time=0;this.maxTime=100;this.update=this.update3;this.entities.splice(1,0,this.butcher)}else this.player.eyeMovement.blink=
7};
LevelCompleteScene.prototype.update3=function(a,b){Scene.prototype.update.call(this,a,b);this.prevScene.musicFadeOnPig();this.time+=1;var c=this.time/this.maxTime,d=this.player,e=this.pig;e.animationState=0;this.prevScene.updateScreenShakeLevel();e.x+=c*c*20;this.time>=this.maxTime&&this.startExitTransition();d.eyeMovement.blink=-2+2*c;d.angle=c*Math.PI/5-Math.PI/5;d.eyeMovement.x=5*c;d.eyeMovement.y=-3;e.angle=c*c*Math.PI*2;this.butcher.x=e.x+40;this.butcher.y=e.y-20;this.butcher.flipped=!0;this.butcher.mx=-1;
this.butcher.update(a,b)};LevelCompleteScene.prototype.draw=function(a){a.save();a.globalAlpha=this.prevLevelAlpha;this.prevScene.draw(a);a.restore();this.drawWithCamera(a);this.drawAllGUI(a);drawTransitionOverlay(this.overlayColor,a)};LevelCompleteScene.prototype.drawWithCamera=function(a){var b=this.prevScene.camera;a.save();a.translate(a.width/2,a.height/2);a.rotate(b.r);a.translate(-Math.floor(b.x),-Math.floor(b.y));for(b=0;b<this.entities.length;b+=1)this.entities[b].draw(a);a.restore()};
LevelCompleteScene.prototype.startExitTransition=function(){var a=this;this.update=Scene.prototype.update;setTimeout(function(){a.startTransition(20,1,a.loadNextScene)},300)};LevelCompleteScene.prototype.loadNextScene=function(){this.player.ghostOn=!1;this.pig.ghostOn=!1;this.player.flipped=!1;this.driver.setScene(this.prevScene);this.callback()};
LevelCompleteScene.prototype.addAllGUI=function(){var a=rectDimFromCenter(.96,.95,.05,.08);0<this.prevScene.levelDeaths?(this.deathCount=new Label(a[0],a[1],a[2],a[3],0,""+this.prevScene.levelDeaths,"60px " + FONT,"black","left"),this.gui.push(this.deathCount),a=rectDimFromCenter(.82,.96,.2,.08),this.deathLabel=new Label(a[0],a[1],a[2],a[3],0,"Fails in level:","30px noteworthy","black","right"),this.gui.push(this.deathLabel)):(a=rectDimFromCenter(.82,.96,.2,.08),this.perfectLabel=new Label(a[0],
a[1],a[2],a[3],0,"Perfect Clear!","30px noteworthy","black","right"),this.gui.push(this.perfectLabel))};
addLevel(function(a){return{name:"Woof-bouncing",worldType:1,grid:[[1,1,0,0,0,0,0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,5,0,0,18,18,18,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,9,9,9,9,9,9,9,9,23,23,23,23,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,18,
18,18,18,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[1,1,1,0,0,14,0,0,0,0,14,18,18,18,18,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1],[1,1,1,0,0,0,0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,1],[1,1,1,0,0,0,0,
0,0,0,0,18,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,1,0,0,0,0,1,1,1,1],[1,1,1,1,1,0,0,0,18,18,18,1,1,1,23,23,23,23,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,9,9,9,9,9,9,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,2,23,23,23,23,0,0,0,0,0,0,0,0,16,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,9,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,1,1,14,0,0,0,0,0,0,0,0,0,0,0,14,1,1],[1,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[1,1,1,1,1,1,1,1,1,
1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,16,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,16,0,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,3,3,3,3,3,0,0,0,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,1,1,1,3,0,0,0,0,0,0,16,0,0,1,1,1,1,1,1,1,1,3,3,3,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});addBlock(function(){return{id:BLOCKS.length,name:"Byrd",hide:!0,ignoreCollisions:!0,redraws:!0,drawer:new Byrd,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new Byrd(b+d/2,c+e))}}});var Collectable=function(a,b){this.h=this.w=30;this.x=a-this.w/2;this.y=b-this.h/2;this.color="gainsboro";this.color1="red";this.color2="#a00";this.color3="#fff";this.color4="#640"};Collectable.prototype.getHitBox=function(){return this};
Collectable.prototype.update=function(a,b){if(this.game.collidesWithPlayer(this)){this.shouldDelete=!0;var c=this.game.player;SOUNDMAP.pickup.play(c);c.game.screenShakeLevel=.4;c.game.frameStop=2;for(c=0;10>c;c++)this.game.addEntity(new FallingParticle(this.x,this.y,10,10,5*Math.random()-2,5*Math.random()-2-10,30,this.color1))}};Collectable.prototype.draw=function(a){a.save();a.translate(this.x+this.w/2,this.y+this.h/2);this.drawShape(a,this.w,this.h);a.restore()};
Collectable.prototype.drawShape=function(a,b,c){a.fillStyle=this.color1;a.fillRect(-b/2,-c,b,c);a.fillStyle=this.color2;a.fillRect(-b/2,-c,b/2,c);a.fillStyle=this.color3;a.fillRect(.1*-b,.9*-c,.5*b,.2*c);a.fillStyle=this.color4;a.fillRect(.1*-b,1.3*-c,.2*b,.3*c)};
var PostWinScene=function(a){Scene.call(this);this.prevScene=a;this.keyMap={32:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},13:{down:this.pressButton.bind(this),up:this.unpressButton.bind(this)},87:{down:this.navigateUI.bind(this,0)},65:{down:this.navigateUI.bind(this,1)},83:{down:this.navigateUI.bind(this,2)},68:{down:this.navigateUI.bind(this,3)},38:{down:this.navigateUI.bind(this,0)},39:{down:this.navigateUI.bind(this,1)},40:{down:this.navigateUI.bind(this,2)},37:{down:this.navigateUI.bind(this,
3)}};this.allowUIInput=!0;this.selectedButton=void 0;this.addAllGUI()};$jscomp.inherits(PostWinScene,Scene);PostWinScene.prototype.update=function(a){Scene.prototype.update.call(this,a)};PostWinScene.prototype.draw=function(a){this.prevScene.draw(a);a.fillStyle="rgba(255,255,255,.7)";a.fillRect(0,0,a.width,a.height);this.deathCount.text=""+this.prevScene.totalDeaths;this.drawAllGUI(a);this.debug&&drawGrid(a);drawTransitionOverlay(this.overlayColor,a)};
PostWinScene.prototype.addAllGUI=function(){var a=rectDimFromCenter(.5,.4,.2,.08);a=new Label(a[0],a[1],a[2],a[3],0,"You Win!","60px " + FONT,"black","center");this.gui.push(a);a=rectDimFromCenter(.5,.55,.05,.08);this.deathCount=new Label(a[0],a[1],a[2],a[3],0,"X","60px " + FONT,"black","center");this.gui.push(this.deathCount);a=rectDimFromCenter(.48,.56,.3,.08);a=new Label(a[0],a[1],a[2],a[3],0,"You died          times","30px noteworthy","black","center");this.gui.push(a);a=rectDimFromCenter(.5,
.7,.15,.08);a=new GrowthTextButton(a[0],a[1],a[2],a[3],0,this.goToMainMenu.bind(this),"Main Menu","30px noteworthy","black","transparent","black",5,.08);this.gui.push(a);this.selectedButton=a;this.selectedButton.selected=!0;this.buttons=getButtons(this.gui)};PostWinScene.prototype.goToMainMenu=function(){this.allowUIInput=!1;this.startTransition(25,1,sceneTransition(this,MenuScene,!0))};
addLevel(function(a){return{name:"Tree Tops",worldType:1,grid:[[0,0,0,0,0,19,19,19,19,19,19,18,18,18,18,18,19,19,19,19,2,19,18,18,18,18,19,19,18,19,19,18,18,18,18,18,18,18,19,18,19,19,19,19,19,0,0,0],[0,0,0,19,19,19,19,19,19,19,19,19,18,18,19,18,19,19,19,2,19,19,19,19,18,18,19,19,19,19,19,18,18,18,19,19,18,18,19,19,2,19,19,19,19,19,19,19],[0,0,19,19,19,19,19,19,19,19,19,19,18,18,19,18,19,19,19,27,19,19,0,19,18,18,19,19,19,18,19,19,18,18,18,18,18,19,19,2,19,19,19,19,19,19,19,19],[0,0,19,19,19,19,19,
19,19,19,19,19,19,23,27,2,2,19,18,27,23,23,23,18,18,18,19,18,18,19,19,18,18,27,23,23,18,19,19,27,2,19,18,19,19,19,18,19],[0,0,19,19,7,19,19,19,19,19,2,19,19,19,27,27,18,18,18,27,18,19,18,18,19,18,27,23,23,23,23,23,23,27,18,18,19,19,19,27,19,19,18,19,19,19,19,18],[0,19,19,19,19,19,19,19,19,19,2,19,19,19,2,27,18,18,18,27,19,19,18,18,19,18,27,2,18,18,18,18,2,27,18,19,19,19,19,27,19,18,18,19,19,19,19,19],[4,19,19,19,19,19,19,19,19,19,2,19,19,19,27,27,18,18,18,27,18,18,18,19,19,18,27,2,18,18,18,18,2,27,
18,19,2,19,19,27,19,23,23,23,9,19,19,0],[23,23,23,23,19,18,19,19,19,19,19,19,19,19,27,27,18,18,18,27,23,23,23,23,23,23,23,19,19,19,19,19,19,27,19,19,27,2,2,27,18,18,27,19,19,19,19,0],[0,0,18,18,18,18,18,18,18,19,19,19,19,18,2,27,18,18,2,27,18,18,27,19,19,18,18,19,19,19,18,18,2,27,19,2,27,18,18,27,18,18,27,18,19,19,19,19],[0,0,0,18,18,18,18,18,19,19,19,19,19,18,27,27,18,18,18,18,18,18,27,19,18,18,18,18,18,19,19,18,18,27,19,19,18,18,19,2,18,18,27,18,18,19,19,5],[0,0,0,0,0,18,18,2,18,18,19,19,18,18,
27,27,18,18,18,18,18,18,27,19,19,18,18,18,18,19,19,18,18,27,19,0,18,18,19,2,18,18,27,23,23,23,23,23],[0,0,0,0,0,18,18,27,18,0,0,19,19,18,2,27,18,18,18,23,23,23,27,19,19,18,18,18,18,22,18,18,18,27,19,0,18,18,19,2,18,18,27,18,18,18,19,19],[0,0,0,0,0,18,18,27,18,0,0,0,19,18,0,27,18,18,18,18,18,19,19,19,19,18,18,18,23,23,23,18,18,27,0,19,2,18,19,2,18,18,27,18,19,19,19,19],[0,0,0,0,0,18,18,27,18,0,0,0,0,19,0,27,18,18,18,18,19,19,0,19,18,18,18,18,18,19,19,18,18,27,19,19,27,18,19,19,18,18,27,19,19,0,0,0],
[0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,18,2,18,18,18,0,0,0,19,19,18,18,18,18,19,18,18,18,27,19,2,27,18,19,19,18,18,19,19,19,19,0,0],[0,0,0,0,0,18,18,18,18,0,0,0,0,0,0,18,18,18,18,18,0,19,19,23,23,23,27,18,18,0,18,18,18,27,2,19,27,18,19,0,18,18,2,0,19,0,0,0],[0,0,0,0,18,18,18,18,18,18,0,0,0,0,0,18,18,18,18,18,0,0,19,19,18,18,27,18,18,0,18,2,18,27,0,18,27,18,0,27,23,23,0,0,0,0,0,0],[0,0,0,0,18,18,18,18,18,18,18,0,0,0,0,18,18,18,18,18,0,0,0,19,19,18,27,18,18,0,18,27,2,27,0,18,27,18,0,27,18,18,0,0,0,0,0,
0],[0,0,0,0,18,18,18,18,18,18,18,18,0,0,0,18,18,18,18,18,0,0,0,0,0,18,27,18,18,0,18,27,18,19,0,18,18,18,2,27,18,18,0,0,0,0,0,0],[0,0,0,18,2,18,18,18,18,18,18,18,2,18,18,18,2,18,18,18,18,0,0,0,0,18,27,18,18,0,18,27,18,0,0,18,18,18,18,27,18,18,18,0,0,0,0,0],[0,2,18,18,18,18,18,18,18,2,18,18,18,18,2,18,18,18,2,18,2,2,2,0,2,18,27,18,18,0,18,27,18,0,18,18,2,18,18,27,18,18,18,18,18,0,0,0],[2,18,18,2,18,2,18,2,18,18,18,0,18,18,18,3,1,18,1,18,18,1,1,0,18,18,2,18,18,18,2,27,2,0,18,18,18,2,2,27,18,18,18,18,
18,0,0,0],[1,1,18,1,18,1,3,1,3,18,3,3,1,18,1,1,1,1,1,3,18,1,1,3,1,1,1,18,3,18,18,27,18,2,2,2,2,18,18,1,1,1,1,1,18,18,0,0],[1,18,1,18,1,1,1,1,1,18,18,1,1,1,18,18,1,1,1,1,1,1,1,1,1,1,18,3,1,3,18,1,1,18,18,18,18,1,1,1,1,1,1,1,1,1,3,3],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{id:BLOCKS.length,name:"DoinkPad",hide:!0,ignoreCollisions:!0,redraws:!0,drawer:new DoinkPad,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new DoinkPad(b+d/2,c+e))}}});var WorldText=function(a,b,c,d,e,f,g,h,k,l){this.x=a;this.y=b;this.w=c;this.text=d;this.font=e;this.inactiveColor=f;this.activeColor=g;this.changeDuration=h;this.colorTimer=k?this.changeDuration:0;this.visible=k||!1;this.textAlign=l||"center"};
WorldText.prototype.update=function(a){this.visible?(this.colorTimer+=a,this.colorTimer>this.changeDuration&&(this.colorTimer=this.changeDuration)):(this.colorTimer-=a,0>this.colorTimer&&(this.colorTimer=0))};WorldText.prototype.setVisible=function(a){this.visible=a};WorldText.prototype.appear=function(){this.visible=!0};WorldText.prototype.disappear=function(){this.visible=!1};
WorldText.prototype.draw=function(a){a.save();var b=colorLerp(this.inactiveColor,this.activeColor,1*this.colorTimer/this.changeDuration);a.globalAlpha=1*this.colorTimer/this.changeDuration;b[3]=1;a.fillStyle=makeColorStr(b);a.font=this.font;a.textAlign=this.textAlign;a.textBaseline="middle";b=rectDimFromCenter(this.x,this.y,this.w,0);switch(this.textAlign){case "left":a.fillText(this.text,b[0],b[1]+b[3]/2,this.w);break;case "right":a.fillText(this.text,b[0]+b[2],b[1]+b[3]/2,this.w);break;case "center":a.fillText(this.text,
b[0]+b[2]/2,b[1]+b[3]/2,this.w)}a.restore()};WORLDTYPE=2;addBlock(function(){return{id:BLOCKS.length,name:"Woof",hide:!0,ignoreCollisions:!0,redraws:!0,drawer:new Woof,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new Woof(b+d/2,c+e))}}});var TriggerZone=function(a,b,c,d,e,f,g,h,k){this.x=a;this.y=b;this.w=c;this.h=d;this.drawDebug=k||!1;this.player=e;this.outputState=this.previousOutputState=0;this.onEnter=f;this.onStay=g;this.onExit=h};
TriggerZone.prototype.update=function(a){pointInRect(this.player.x,this.player.y,{x:this.x,y:this.y,w:this.w,h:this.h})?this.outputState=1:this.outputState=0;if(0==this.previousOutputState&&1==this.outputState){if(this.onEnter)this.onEnter()}else if(1==this.previousOutputState&&0==this.outputState){if(this.onExit)this.onExit()}else if(1==this.previousOutputState&&1==this.outputState&&this.onStay)this.onStay();this.previousOutputState=this.outputState};
TriggerZone.prototype.draw=function(a){this.drawDebug&&(a.fillStyle=1==this.outputState?"rgba(0,255,0,0.4)":"rgba(255,0,0,.4)",a.fillRect(this.x,this.y,this.w,this.h))};
addLevel(function(a){return{name:"spiketops",worldType:2,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,3,0,0,0,0,0,1,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0],[0,0,0,0,7,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,4,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,1,0,0,0,0,0,0,0,0,0,5,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,3,3,3,3,3,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});addBlock(function(){return{name:"ByrdWall",solid:!0,id:BLOCKS.length,hide:!0,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="rgba(50,50,0,.5)";a.fillRect(b,c,d,e)},isColliding:function(a,b,c,d,e){if(a.isByrd||a.isPig||a.isBigSaw)return!0}}});
var Knife=function(a,b,c,d){this.x=a;this.y=b;this.vx=c;this.vy=d;this.h=this.w=30;this.angle=0;this.killPlayer=!0;this.da=-Math.PI/20;this.bouncable=!1;this.flipped=0<this.vx};Knife.prototype.die=function(){this.shouldDelete=!0};
Knife.prototype.update=function(a,b){var c=this;a/=.8;this.x+=this.vx*a;this.y+=this.vy*a;this.angle+=this.da*a;var d=this.game.world,e=this.getHitBox();d.rectCollides(e.x,e.y,e.w,e.h,this,0,0)&&(this.killPlayer=!1,this.da=this.vy=this.vx=0,setTimeout(function(){return c.die()},1E3));if(this.game.collidesWithPlayer(this))this.onCollision(this.game.player)};Knife.prototype.onCollision=function(a){this.bouncable&&(a.y<this.y||0<a.vy)?(this.die(),a.bounceOffEntity(this)):this.game.player.getHitByEntity(this)};
Knife.prototype.draw=function(a){a.save();a.translate(this.x,this.y);this.flipped&&a.scale(-1,1);a.rotate(this.angle);this.drawKnife(a,this.w,this.h);a.restore()};Knife.prototype.getHitBox=function(){return{x:this.x-this.w/2,y:this.y-this.h/2,w:this.w,h:this.h}};
Knife.prototype.drawKnife=function(a,b,c){a.strokeStyle="#000";a.lineWidth=7;a.save();a.translate(b/8,c/8);a.lineWidth=3;a.beginPath();a.fillStyle="#a33";a.rect(-5,0,5,10);a.stroke();a.fill();a.fillStyle="#822";a.fillRect(-5,0,2.5,10);a.fillStyle="#eee";a.beginPath();a.rect(-18,-23,18,23);a.stroke();a.fill();a.fillStyle="#fff";a.fillRect(-18,-23,4.5,23);a.beginPath();a.fillStyle="#000";a.arc(-4.5,-18.5,3,0,2*Math.PI);a.fill();a.restore()};
addLevel(function(a){return{name:"Deadly Byrds",worldType:2,grid:[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,17,0,0,0,0,14,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,17,0,0,14,0,0,0,0,0,17,0,0,14,0,0,0,0,17,0,0,0,
0,0,0,0,0,0,0,0,0,1,0,0,0],[1,0,0,0,0,0,0,0,0,0,17,0,14,0,0,14,0,17,0,17,14,0,0,0,0,0,0,17,0,0,14,0,0,0,0,14,0,0,0,0,1,0,0,0],[1,10,10,10,10,3,10,10,10,3,3,10,10,10,10,10,10,3,3,3,10,10,10,3,3,10,10,10,10,10,3,10,3,10,10,3,3,3,10,10,1,0,0,0],[1,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0],[1,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0],[1,1,0,15,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,15,0,1,2,2,0,0,0,0,0,0,0,2,1,1,0,0,
0,0,1,1,0,0],[1,1,1,1,1,0,0,0,0,2,1,1,1,1,0,0,0,0,0,0,1,1,1,1,2,2,0,0,0,0,0,15,0,2,1,1,0,0,0,0,1,1,1,1],[0,0,0,0,0,0,0,0,0,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,0,22,0,0,2,1,2,1,1,1,0,0,0,0,0,0,0,0],[0,4,0,0,0,0,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,2,2,2,1,1,1,1,1,0,0,0,0,0,5,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{name:"treeTrunk",solid:!1,groundBlock:!1,ignoreCollisions:!0,id:BLOCKS.length,trunk:!0,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="#6a5545";a.fillRect(b,c,d,e);a.strokeStyle="#000";f=Math.max(d,e);a.fillStyle="#4a3525";a.fillRect(b+d/2,c,d/2,e);f/=3;for(g=0;3>g;g++){h=psuedoRandom(b,c,g,1);var k=psuedoRandom(b,c,g,2);a.fillRect(10*Math.floor(h*(d-f)/10)+b,10*Math.floor(k*(e-f)/10)+c,f,f)}},isColliding:function(a,b,c,d,e){return 0<d&&a.y<=e.y?!0:!1}}});
var ButcherTurret=function(a,b){Butcher.call(this,a,b);this.shootSpeed=60;this.shootTimer=0;this.projectileSpeed=6;this.inRange=this.restrictDirection=!1;this.range=300;this.targetX=a;this.targetY=b;this.butcher=this;this.speed=9;this.moveTimer=0;this.min=null};$jscomp.inherits(ButcherTurret,Butcher);
ButcherTurret.prototype.update=function(a,b){a/=.8;if(-20<this.shootTimer&&30>this.shootTimer){var c=this.targetX-this.x,d=this.targetY-this.y;this.x+=c/10*a;this.y+=d/10*a;if(30<Math.abs(c)+Math.abs(d)){0>this.shootTimer&&(this.shootTimer+=a);return}}d=this.game.player;c=d.x-this.x;d=d.y-this.y-d.h/2;this.dx=c;this.dy=d;0<=this.shootTimer&&(this.butcher.flipped=0>c);var e=Math.sqrt(c*c+d*d);this.restrictDirection&&(Math.abs(c)>Math.abs(d)?d=0:c=0,this.angle=Math.atan2(d,c));this.shootTimer+=a;this.shootTimer>
this.shootSpeed&&(200<e||-30<d?(this.shootTimer=0,this.shoot()):this.shootTimer=this.shootSpeed);c=this.shootTimer/this.shootSpeed;c=.5>c?2*c*c:-1+(4-2*c)*c;this.butcher.knifeAngle=c*Math.PI/2;this.butcher.angle=-(Math.PI/20*c);0<=this.shootTimer&&this.game.collidesWithPlayer(this)&&(d=this.game.player,0<d.vy&&d.y<this.y&&(this.shootTimer=-100,d.bounceOffEntity(this)))};
ButcherTurret.prototype.processPoint=function(a){var b=a.x,c=a.y,d=this.game.player,e=d.x-b;d=d.y-c-d.h/2;e=Math.sqrt(e*e+d*d);a.r=e;if(!this.min||e<this.min.r-30)this.setTarget(b,c),this.min=a};ButcherTurret.prototype.setTarget=function(a,b){this.targetX=a;this.targetY=b+30};ButcherTurret.prototype.draw=function(a){Butcher.prototype.draw.call(this,a)};
ButcherTurret.prototype.shoot=function(){SOUNDMAP["throw"].play();var a=this.dx,b=this.dy;if(this.restrictDirection){Math.abs(a)>Math.abs(b)?b=0:a=0;var c=Math.abs(a+b)}else c=Math.sqrt(a*a+b*b);var d=this.projectileSpeed;a=new Knife(this.x,this.y-this.h/2,a/c*d,b/c*d);this.game.addEntity(a)};
addLevel(function(a){return{name:"Saws",worldType:2,grid:[[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,27,2,2,2,2,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,27,27,27,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,1],[0,9,9,9,23,9,9,9,9,23,9,9,9,23,9,9,9,23,9,9,9,23,9,9,23,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,1],[0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,30,0,2,0,0,0,0,0,0,30,0,0,0,0,2,0,0,0,0,0,0,5,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
addBlock(function(){return{name:"treeLeaves",solid:!1,groundBlock:!1,ignoreCollisions:!0,leaves:!0,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){var k=Math.max(d,e)/3;a.fillStyle="#181";var l=d,m=e,n=b,p=c;if(f)for(f.getCell(g,h-1).leaves||f.getCell(g,h-1).trunk||(m/=2,p+=m),f.getCell(g,h+1).leaves||(m/=2),f.getCell(g-1,h).leaves||f.getCell(g-1,h).trunk||(l/=2,n+=l),f.getCell(g+1,h).leaves||f.getCell(g+1,h).trunk||(l/=2),a.fillRect(n,p,l,m),"treeTrunk"==f.getCell(g,h+1).name&&f.getCell(g,h+1).draw(a,
b,c+e-m,d,m,f,g,h),a.fillStyle="#292",f=0;10>f;f++)g=psuedoRandom(b,c,f,1),h=psuedoRandom(b,c,f,2),a.fillRect(3*Math.floor(g*(d-k)/3)+b,3*Math.floor(h*(e-k)/3)+c,k,k)},isColliding:function(a,b,c,d,e){return 0<d&&a.y<=e.y?!0:!1}}});var ButcherTurretPoint=function(a,b){this.x=a;this.y=b;this.h=this.w=20;this.update=this.update1;this.range=300};
ButcherTurretPoint.prototype.update1=function(){var a=this.game.butcher;a||(a=new ButcherTurret(this.x,this.y),this.game.addEntity(a),this.game.butcher=a);this.butcher=a;this.update=this.update2};ButcherTurretPoint.prototype.update2=function(a,b){return this.butcher.processPoint(this)};ButcherTurretPoint.prototype.draw=function(a){a.fillStyle="#000";a.fillRect(this.x-this.w/2,this.y-this.h/2,this.w,this.h)};
addLevel(function(a){return{name:"The Woof of Saw Street",worldType:2,grid:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,3,0,18,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,27,23,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[4,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,27,27,27,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,1,9,16,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,1,0],[9,9,9,9,23,9,9,9,9,23,9,9,9,23,9,1,0,0,0,0,0,1,9,9,9,9,23,9,9,9,9,9,9,9,9,9,23,9,9,9,9,9,9,23,9,9,9,1,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0]]}});addBlock(function(){return{id:BLOCKS.length,name:"Pig",hide:!0,ignoreCollisions:!0,redraws:!0,drawer:new PigBeginning,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.pig=new PigBeginning(b+d/2,c+e);a.addEntity(a.pig)}}});
var KnifeTurret=function(a,b){this.x=a;this.y=b;this.shootTimer=this.shootSpeed=50;this.projectileSpeed=6;this.restrictDirection=!1;this.butcher=new ButcherTurret(a,b+30);this.dx=1;this.dy=0};
KnifeTurret.prototype.update=function(a,b){var c=this.game.player,d=c.x-this.x;c=c.y-this.y-c.h/2;var e=Math.sqrt(d*d+c*c);this.shootTimer>this.shootSpeed/10&&this.shootTimer<this.shootSpeed/5&&(this.butcher.flipped=0>d,this.restrictDirection&&(Math.abs(d)>Math.abs(c)?c=0:d=0,this.angle=Math.atan2(c,d)),this.dx=d/e,this.dy=c/e);700<e?this.shootTimer=this.shootSpeed:(this.shootTimer+=1,this.shootTimer>this.shootSpeed&&(this.shootTimer=0,this.shoot()),d=this.shootTimer/this.shootSpeed,d=.5>d?2*d*d:
-1+(4-2*d)*d,this.butcher.knifeAngle=d*Math.PI/2,this.butcher.angle=-(Math.PI/10*d),this.butcher.flipped&&(this.butcher.angle*=-1))};KnifeTurret.prototype.draw=function(a){this.butcher.draw(a)};KnifeTurret.prototype.shoot=function(){SOUNDMAP["throw"].play();var a=this.projectileSpeed;a=new Knife(this.x,this.y,this.dx*a,this.dy*a);this.game.addEntity(a)};
addLevel(function(a){return{name:"double jump and wall jump",worldType:2,grid:[[1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,8,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,2,2,2,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,1,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1],[1,0,0,2,2,1,2,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1],[1,0,0,2,2,1,2,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,1,1,0,0,1],[1,7,0,2,2,1,2,0,0,0,0,1,
1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,0,0,0,0,8,0,0,0,0,2,1,1,0,0,1],[1,0,0,0,2,1,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,1,1,0,0,0],[0,0,0,0,2,1,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,1,1,0,0,0],[0,4,0,0,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,2,1,1,0,5,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1]]}});addBlock(function(){return{name:"treeApple",solid:!1,groundBlock:!1,ignoreCollisions:!0,leaves:!0,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){CELLMAP[19].draw(a,b,c,d,e,f,g,h);a.fillStyle="#640";f=.44*d;g=.6*e;a.fillRect(b+f,c+g,d-2*f,e-g)},isColliding:function(a,b,c,d,e){return 0<d&&a.y<=e.y?!0:!1},onload:function(a,b,c,d,e,f,g,h){a.addEntity(new Apple(b+d/2,c+1.5*e))}}});
var MovingWorldText=function(a,b,c,d,e,f,g,h,k,l,m,n){WorldText.call(this,a,b,c,f,g,h,k,l,n);this.dx=d;this.dy=e;this.initialDelay=m;this.lifeTime=this.initialDelay+l};$jscomp.inherits(MovingWorldText,WorldText);MovingWorldText.prototype.update=function(a){this.lifeTime-=a;0>this.lifeTime&&this.die();this.x+=this.dx*a;this.y+=this.dy*a;0<this.initialDelay?this.initialDelay-=a:(this.disappear(),WorldText.prototype.update.call(this,a))};
MovingWorldText.prototype.draw=function(a){WorldText.prototype.draw.call(this,a)};MovingWorldText.prototype.die=function(){this.shouldDelete=!0};addBlock(function(){return{id:BLOCKS.length,name:"collectable",hide:!0,ignoreCollisions:!0,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="rgba(50,0,50,.5)";a.fillRect(b,c,d,e)},onload:function(a,b,c,d,e,f,g,h){a.addEntity(new Collectable(b+d/2,c+e/2))}}});
addLevel(function(a){return{name:"Final Battle",worldType:2,song:0,grid:[[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,5,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,27,27,27,27,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,16,9,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,9,9,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,30,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[9,9,9,9,9,23,9,9,9,9,9,23,9,9,9,9,9,23,9,9,9,9,9,23,9,9,9,9,9,23,9,9,9,9,9,23,9,9,9,9,9,23,9,9,9,9,23,1],[0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,19,1],[0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,29,0,0,0,0,0,0,0,0,0,0,29,0,0,0,0,0,0,0,0,0,29,0,0,0,0,0,0,0,0,29,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,
0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,1],[0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,30,0,2,0,0,0,0,0,0,30,0,0,0,0,2,0,0,0,0,0,0,15,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]}});
var SleepText=function(a,b,c,d,e,f,g,h,k,l,m,n,p){MovingWorldText.call(this,a,b,c,d,e,f,""+g+"px "+h,k,l,m,n,p);this.fontSize=g;this.fontType=h;this.fontTimer=this.changeDuration};$jscomp.inherits(SleepText,MovingWorldText);SleepText.prototype.update=function(a){MovingWorldText.prototype.update.call(this,a);0<this.initialDelay||(this.fontTimer-=a)};
SleepText.prototype.draw=function(a){a.save();a.textAlign="center";var b=colorLerp(this.inactiveColor,this.activeColor,1*this.colorTimer/this.changeDuration);a.globalAlpha=1*this.colorTimer/this.changeDuration;b[3]=1;a.fillStyle=makeColorStr(b);b=constrain(1*this.fontTimer/this.changeDuration*this.fontSize,0,this.fontSize);a.font=""+b+"px "+this.fontType;a.fillText(this.text,this.x,this.y,this.w);a.restore()};
addBlock(function(){return{name:"Platform",solid:!0,groundBlock:!1,trunk:!0,platform:!0,safe:!0,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){CELLMAP[18].draw(a,b,c+e/2,d,e/2,f,g,h);CELLMAP[9].draw(a,b,c,d,e,f,g,h)},isColliding:function(a,b,c,d,e){return a.apple?!1:0<d&&a.y<=e.y?!0:!1}}});var KingByrd=function(a,b){Byrd.call(this,a,b);this.shootSpeed=50;this.shootTimer=0;this.projectileSpeed=6;this.inRange=this.restrictDirection=!1;this.range=300;this.targetX=a;this.targetY=b;this.kingByrd=this};
$jscomp.inherits(KingByrd,Byrd);
KingByrd.prototype.update=function(a,b){this.speed=this.game.player.speed;-5<this.shootTimer&&(this.x=linearMove(this.x,this.targetX,this.speed),this.y=linearMove(this.y,this.targetY,this.speed));var c=this.game.player,d=c.x-this.x;c=c.y-this.y-c.h/2;0<=this.shootTimer&&(this.kingByrd.flipped=0>d);this.restrictDirection&&(Math.abs(d)>Math.abs(c)?c=0:d=0,this.angle=Math.atan2(c,d));this.shootTimer+=1;this.shootTimer>this.shootSpeed&&(this.shootTimer=0,this.shoot());0<=this.shootTimer&&this.game.collidesWithPlayer(this)&&
(c=this.game.player,0<c.vy&&c.y<this.y&&c.bounceOffEntity(this))};KingByrd.prototype.draw=function(a){Byrd.prototype.draw.call(this,a)};KingByrd.prototype.shoot=function(){};addBlock(function(){return{name:"PigFear",solid:!0,id:BLOCKS.length,hide:!0,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="rgba(50,50,0,.5)";a.fillRect(b,c,d,e)},isColliding:function(a,b,c,d,e){if(a.isPig)return a.state=a.toTwo(),!1}}});
var KingByrdPoint=function(a,b){this.x=a;this.y=b;this.h=this.w=20;this.update=this.update1;this.range=200};KingByrdPoint.prototype.update1=function(){var a=this.game.kingByrd;a||(a=new KingByrd(this.x,this.y),this.game.addEntity(a),this.game.kingByrd=a);this.kingByrd=a;this.update=this.update2};
KingByrdPoint.prototype.update2=function(a,b){var c=this.game.kingByrd;c||(c=new KingByrd(this.x,this.y),this.game.addEntity(c),this.game.kingByrd=c);this.kingByrd=c;var d=this.game.player;c=d.x-this.x;d=d.y-this.y-d.h/2;Math.sqrt(c*c+d*d)<this.range&&(this.inRange=!0,this.kingByrd.targetX=this.x,this.kingByrd.targetY=this.y+30)};KingByrdPoint.prototype.draw=function(a){a.fillStyle="#000";a.fillRect(this.x-this.w/2,this.y-this.h/2,this.w,this.h)};
addBlock(function(){return{name:"PigEnd",solid:!0,id:BLOCKS.length,hide:!0,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="rgba(50,50,0,.5)";a.fillRect(b,c,d,e)},isColliding:function(a,b,c,d,e){if(a.isPig)return a.animationState=1,a.game.driver.setScene(new IntroScene),!1}}});var BigSaw=function(a,b){Mover.call(this,a,b);this.nonSolidCollisions=["Byrd"];this.h=this.w=70;this.rotAngle=0;this.rotSpeed=.25;this.mx=1;this.killPlayer=!0;this.grav=0;this.speed=6;this.isBigSaw=!0};$jscomp.inherits(BigSaw,Mover);
BigSaw.prototype.getHitByEntity=function(a){};BigSaw.prototype.update=function(a,b){this.rotAngle=b*this.rotSpeed%(2*Math.PI);1==this.wallcolliding&&(this.mx*=-1);Mover.prototype.update.call(this,a,b);var c=this.getHitBox(),d=this.game.player.getHitBox();1==rectangleCollision(c,d)&&this.game.player.getHitByEntity(this)};
BigSaw.prototype.draw=function(a){var b=this.w,c=this.h;a.save();a.translate(this.x,this.y);a.rotate(this.rotAngle);a.lineWidth=2;b*=.9;c*=.9;a.fillStyle="white";a.strokeStyle="#000";for(var d=0;3>d;d++)a.rotate(Math.PI/8),a.fillRect(-b/2,-c/2,b,c),a.strokeRect(-b/2,-c/2,b,c);b*=.8;c*=.8;a.rotate(-3*Math.PI/8);a.fillStyle="grey";a.fillRect(-b/2,-c/2,b,c);a.fillStyle="black";a.fillRect(-b/8,-c/8,b/4,c/4);a.restore()};
BigSaw.prototype.interactWithBlock=function(a,b){if(0>this.x||this.x>=this.game.world.w*this.game.world.s||0>a||a>CELLMAP.length)return!0;var c=CELLMAP[this.game.world.world[b][a]];if(c.solid)return!0;for(var d=0;d<this.nonSolidCollisions.length;d++)if(c.name===this.nonSolidCollisions[d])return!0;return!1};BigSaw.prototype.getHitBox=function(){return{x:this.x-.5*this.w,y:this.y-.5*this.h,w:this.w,h:this.h}};
addBlock(function(){return{id:BLOCKS.length,name:"KnifeTurret",hide:!0,ignoreCollisions:!0,drawer:new KnifeTurret,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new KnifeTurret(b+d/2,c+e/2))}}});
addBlock(function(){return{name:"TrunkWall",solid:!0,groundBlock:!1,trunk:!0,platform:!0,safe:!0,treeWall:!0,id:BLOCKS.length,draw:function(a,b,c,d,e,f,g,h){a.lineWidth=4;b+=.05*d;d*=.9;a.fillStyle="#532";a.fillRect(b,c,d/2,e);a.strokeStyle="#000";a.fillStyle="#754";a.fillRect(b+d/4,c,d/4,e);a.fillStyle="#754";a.fillRect(b+d/2,c,d/2,e);a.strokeStyle="#000";a.fillStyle="#532";a.fillRect(b+3*d/4,c,d/4,e);f&&(a.strokeRect(b+d,c,0,e),a.strokeRect(b,c,0,e),f.getCell(g,h+1).treeWall||a.strokeRect(b,c+.95*
e,d,0),f.getCell(g,h-1).treeWall||a.strokeRect(b,c,d,0),a.lineWidth=1)},isColliding:function(a,b,c,d,e){return a.apple?!1:!0}}});addBlock(function(){return{id:BLOCKS.length,name:"KingByrd",hide:!0,ignoreCollisions:!0,drawer:new Enemy,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new KingByrdPoint(b+d/2,c+e/2))}}});
addBlock(function(){return{id:BLOCKS.length,name:"ButcherTurret",hide:!0,ignoreCollisions:!0,drawer:new ButcherTurretPoint,draw:drawEntity,onload:function(a,b,c,d,e,f,g,h){a.addEntity(new ButcherTurretPoint(b+d/2,c+e/2))}}});addBlock(function(){return{id:BLOCKS.length,name:"BigSawSpawner",solid:!1,angle:0,redraws:!1,hide:!0,drawer:new BigSaw,draw:function(a,b,c,d,e,f,g,h){a.fillStyle="green";a.fillRect(b,c,d,e)},onload:function(a,b,c,d,e,f,g,h){a.addEntity(new BigSaw(b,c))}}});